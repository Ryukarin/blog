import{_ as n,a as s}from"./app.893f8b81.js";var a="/blog/assets/172-1.c292147d.png",e="/blog/assets/173-1.3bd18a5f.png",p="/blog/assets/174-1.77412e08.png",t="/blog/assets/180-1.a0e6688d.png";const o={},l=s(`<h2 id="_170\u3001\u5BFC\u5165\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_170\u3001\u5BFC\u5165\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 170\u3001\u5BFC\u5165\u6587\u672C\u6587\u4EF6</h2><p>\u5728\u5B9E\u9645\u5E94\u7528\u4E2D\uFF0C\u6211\u4EEC\u7ECF\u5E38\u4ECE\u8F6F\u4EF6\u4E2D\u5C06\u6570\u636E\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6\uFF0C\u5728\u9700\u8981\u5C06\u8FD9\u4E9B\u6587\u672C\u6587\u4EF6\u5BFC\u5165\u5230 Excel \u4E2D\u65F6\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u7684\u65B9\u6CD5\u3002</p><h3 id="_1-\u4F7F\u7528\u67E5\u8BE2\u8868\u5BFC\u5165" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528\u67E5\u8BE2\u8868\u5BFC\u5165" aria-hidden="true">#</a> 1\uFF09\u4F7F\u7528\u67E5\u8BE2\u8868\u5BFC\u5165</h3><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddQuery<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>ClearContents
	<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>QueryTables<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> <span class="token operator">_</span>
		Connection<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;TEXT;&quot;</span> <span class="token operator">&amp;</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\\u5DE5\u8D44\u8868.txt&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
		Destination<span class="token punctuation">:</span><span class="token operator">=</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>TextFilePlatform <span class="token operator">=</span> <span class="token number">936</span>
		<span class="token punctuation">.</span>TextFileCommaDelimiter <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>Refresh
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>AddQuery \u8FC7\u7A0B\u4F7F\u7528 QueryTable \u5BF9\u8C61\u7684 Add \u65B9\u6CD5\u65B0\u5EFA\u67E5\u8BE2\u8868\u540E\u5C06\u6587\u672C\u6587\u4EF6\u201C\u5DE5\u8D44\u8868.txt\u201D\u7684\u5185\u5BB9\u5BFC\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u5E94\u7528\u4E8E QueryTable \u5BF9\u8C61\u7684 Add \u65B9\u6CD5\u65B0\u5EFA\u4E00\u4E2A\u67E5\u8BE2\u8868\uFF0C\u8FD4\u56DE QueryTable \u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u4EE3\u8868\u65B0\u5EFA\u7684\u67E5\u8BE2\u8868\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Connection<span class="token punctuation">,</span> Destination<span class="token punctuation">,</span> Sql<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2AQueryTables\u5BF9\u8C61\u3002
\u53C2\u6570Connection\u662F\u5FC5\u9700\u7684\uFF0C\u67E5\u8BE2\u8868\u7684\u6570\u636E\u6E90\u3002\u5982\u679C\u6570\u636E\u6E90\u662F\u6587\u672C\u6587\u4EF6\uFF0C\u662F<span class="token string">\u201CTEXT;&lt;\u6587\u672C\u6587\u4EF6\u8DEF\u5F84\u548C\u540D\u79F0&gt;\u201D</span>\u5F62\u5F0F\u7684\u5B57\u7B26\u4E32\uFF0C\u5176\u4ED6\u6570\u636E\u6E90\u8BF7\u53C2\u9605\u5E2E\u52A9\u3002
\u53C2\u6570Destination\u662F\u5FC5\u9700\u7684\uFF0CRange\u7C7B\u578B\uFF0C\u67E5\u8BE2\u8868\u76EE\u6807\u533A\u57DF\u5DE6\u4E0A\u89D2\u5355\u5143\u683C\u7528\u4E8E\u653E\u7F6E\u751F\u6210\u7684\u67E5\u8BE2\u8868\u7684\u533A\u57DF\u3002\u76EE\u6807\u533A\u57DF\u5FC5\u987B\u5728\u5305\u542Bexpression \u6307\u5B9A\u7684QueryTables\u5BF9\u8C61\u7684\u5DE5\u4F5C\u8868\u4E0A\u3002
\u53C2\u6570Sql\u662F\u53EF\u9009\u7684\uFF0C\u5728ODBC\u6570\u636E\u6E90\u4E0A\u8FD0\u884C\u7684SQL\u67E5\u8BE2\u5B57\u7B26\u4E32\uFF0C\u5F53\u5C06QueryTable\u5BF9\u8C61\u3001\u6587\u672C\u6587\u4EF6\u3001\u6216\u662FADO\u6216DAO Recordset\u5BF9\u8C61\u6307\u5B9A\u4E3A\u6570\u636E\u6E90\u65F6\u4E0D\u80FD\u4F7F\u7528\u8BE5\u53C2\u6570\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u7B2C 3 \u884C\u5230\u7B2C 5 \u884C\u4EE3\u7801\u5728\u5DE5\u4F5C\u8868\u4E2D\u5EFA\u7ACB\u5BF9\u4F4D\u4E8E\u540C\u4E00\u76EE\u5F55\u4E2D\u7684\u201C\u5DE5\u8D44\u8868.txt\u201D\u6587\u672C\u6587\u4EF6\u7684\u67E5\u8BE2\uFF0C\u5E76\u5C06\u67E5\u8BE2\u7ED3\u679C\u653E\u7F6E\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u8BBE\u7F6E\u5BFC\u5165\u7684\u6587\u672C\u6587\u4EF6\u7684\u539F\u59CB\u683C\u5F0F\uFF0CQueryTables \u5BF9\u8C61\u7684 TextFilePlatform \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u6B63\u5411\u67E5\u8BE2\u8868\u4E2D\u5BFC\u5165\u7684\u6587\u672C\u6587\u4EF6\u7684\u539F\u59CB\u683C\u5F0F\uFF0C\u9ED8\u8BA4\u503C\u662F\u5728\u201C\u6587\u672C\u5BFC\u5165\u5411\u5BFC\u201D\u7684\u201C\u6587\u4EF6\u539F\u59CB\u683C\u5F0F\u201D\u9009\u9879\u4E2D\u7684\u5F53\u524D\u8BBE\u7F6E\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u8BBE\u7F6E\u6587\u672C\u6587\u4EF6\u5BFC\u5165\u67E5\u8BE2\u8868\u4E2D\u65F6\uFF0C\u662F\u4EE5\u9017\u53F7\u4F5C\u4E3A\u5206\u9694\u7B26\u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u4F7F\u7528 Refresh \u65B9\u6CD5\u66F4\u65B0\u5916\u90E8\u6570\u636E\u533A\u57DF\uFF0C\u5E94\u7528\u4E8E QueryTable \u5BF9\u8C61\u7684 Refresh \u65B9\u6CD5\u66F4\u65B0\u5916\u90E8\u6570\u636E\u533A\u57DF\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Refresh<span class="token punctuation">(</span>BackgroundQuery<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2AQueryTable\u5BF9\u8C61\u3002
\u53C2\u6570BackgroundQuery\u662F\u53EF\u9009\u7684\u7684\uFF0C\u53EA\u7528\u4E8E\u57FA\u4E8ESQL\u67E5\u8BE2\u7ED3\u679C\u7684QueryTable\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-\u4F7F\u7528-open-\u8BED\u53E5\u5BFC\u5165" tabindex="-1"><a class="header-anchor" href="#_2-\u4F7F\u7528-open-\u8BED\u53E5\u5BFC\u5165" aria-hidden="true">#</a> 2\uFF09\u4F7F\u7528 Open \u8BED\u53E5\u5BFC\u5165</h3><p>\u4F7F\u7528 Open \u8BED\u53E5\u8F93\u5165\u6587\u672C\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> OpenText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Filename <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> myText <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> mArr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	Filename <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\\u5DE5\u8D44\u8868.txt&quot;</span>
	j <span class="token operator">=</span> <span class="token number">1</span>
	Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>ClearContents
	Open Filename <span class="token keyword">For</span> Input <span class="token keyword">As</span> <span class="token number">1</span>
	<span class="token keyword">Do</span> <span class="token keyword">While</span> <span class="token keyword">Not</span> EOF<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		Line Input <span class="token number">1</span><span class="token punctuation">,</span> myText
		mArr <span class="token operator">=</span> Split<span class="token punctuation">(</span>myText<span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>mArr<span class="token punctuation">)</span>
			Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>j<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> mArr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">Next</span>
		j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>
	<span class="token keyword">Loop</span>
	Close <span class="token number">1</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>OpenText \u8FC7\u7A0B\u4F7F\u7528 Open \u8BED\u53E5\u5C06\u6587\u672C\u201C\u5DE5\u8D44\u8868.txt\u201D\u7684\u5185\u5BB9\u8F93\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u4F7F\u7528 Open \u8BED\u53E5\u6253\u5F00\u6587\u672C\u6587\u4EF6\u4EE5\u5B8C\u6210\u5BF9\u6587\u672C\u6587\u4EF6\u7684\u8F93\u5165\u3002Open \u8BED\u53E5\u80FD\u591F\u5BF9\u6587\u4EF6\u8F93\u5165/\u8F93\u51FA\uFF08I/O\uFF09\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Open pathname For mode [Access access] [lock] As [#]filenumber [Len=reclength]

Pathname\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u6587\u4EF6\u540D\uFF0C\u8BE5\u6587\u4EF6\u540D\u53EF\u80FD\u8FD8\u5305\u62EC\u76EE\u5F55\u3001\u6587\u4EF6\u5939\u53CA\u9A71\u52A8\u5668\u3002
mode\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u6587\u4EF6\u65B9\u5F0F\uFF0C\u6709Append\u3001Binary\u3001Input\u3001Output\u3001\u6216Random\u65B9\u5F0F\u3002\u5982\u679C\u672A\u6307\u5B9A\u65B9\u5F0F\uFF0C\u5219\u4EE5Random\u8BBF\u95EE\u65B9\u5F0F\u6253\u5F00\u6587\u4EF6\u3002
Access\u662F\u53EF\u9009\u7684\uFF0C\u8BF4\u660E\u6253\u5F00\u7684\u6587\u4EF6\u53EF\u4EE5\u8FDB\u884C\u7684\u64CD\u4F5C\uFF0C\u6709Read\u3001Write\u3001\u6216Read Write\u64CD\u4F5C\u3002
lock\u662F\u53EF\u9009\u7684\uFF0C\u8BF4\u660E\u9650\u5B9A\u4E8E\u5176\u5B83\u8FDB\u7A0B\u6253\u5F00\u7684\u6587\u4EF6\u7684\u64CD\u4F5C\uFF0C\u6709Shared\u3001Lock Read\u3001Lock Write\u3001\u548CLock Read Write\u64CD\u4F5C\u3002
filenumber\u662F\u5FC5\u9700\u7684\uFF0C\u4E00\u4E2A\u6709\u6548\u7684\u6587\u4EF6\u53F7\uFF0C\u8303\u56F4\u5728 1 \u5230 511 \u4E4B\u95F4\u3002\u4F7F\u7528FreeFile\u51FD\u6570\u53EF\u5F97\u5230\u4E0B\u4E00\u4E2A\u53EF\u7528\u7684\u6587\u4EF6\u53F7\u3002
reclength\u662F\u53EF\u9009\u7684\uFF0C\u5C0F\u4E8E\u6216\u7B49\u4E8E 32\uFF0C767\uFF08\u5B57\u8282\uFF09\u7684\u4E00\u4E2A\u6570\u3002\u5BF9\u4E8E\u7528\u968F\u673A\u8BBF\u95EE\u65B9\u5F0F\u6253\u5F00\u7684\u6587\u4EF6\uFF0C\u8BE5\u503C\u5C31\u662F\u8BB0\u5F55\u957F\u5EA6\u3002\u5BF9\u4E8E\u987A\u5E8F\u6587\u4EF6\uFF0C\u8BE5\u503C\u5C31\u662F\u7F13\u51B2\u5B57\u7B26\u6570\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u7B2C 11 \u884C\u4EE3\u7801\u4F7F\u7528 Do...Loop \u8BED\u53E5\u91CD\u590D\u6267\u884C\u7B2C 12 \u884C\u5230\u7B2C 17 \u884C\u4EE3\u7801\uFF0C\u76F4\u5230\u6587\u672C\u6587\u4EF6\u7684\u7ED3\u5C3E\u3002EOF \u51FD\u6570\u8FD4\u56DE\u4E00\u4E2A Integer\uFF0C\u5B83\u8FD4\u56DE Boolean \u503C True\uFF0C\u8868\u660E\u5DF2\u7ECF\u5230\u8FBE\u4E3A Random \u6216\u987A\u5E8F Input \u6253\u5F00\u7684\u6587\u4EF6\u7ED3\u5C3E\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>EOF<span class="token punctuation">(</span>filenumber<span class="token punctuation">)</span>

\u53C2\u6570filenumber\u662F\u5FC5\u9700\u7684\uFF0C\u662F\u4E00\u4E2A<span class="token keyword">Integer</span>\uFF0C\u5305\u542B\u4EFB\u4F55\u6709\u6548\u7684\u6587\u4EF6\u53F7\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 12 \u884C\u4EE3\u7801\u4F7F\u7528 Line Input # \u8BED\u53E5\u8BFB\u5165\u4E00\u884C\u6570\u636E\u5E76\u5C06\u5176\u8D4B\u4E88\u53D8\u91CF myText\u3002Line Input # \u8BED\u53E5\u4ECE\u5DF2\u6253\u5F00\u7684\u987A\u5E8F\u6587\u4EF6\u4E2D\u8BFB\u51FA\u4E00\u884C\u5E76\u5C06\u5B83\u5206\u914D\u7ED9 String \u53D8\u91CF\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Line Input <span class="token operator">#</span>filenumber<span class="token punctuation">,</span> varname

Filenumber\u662F\u5FC5\u9700\u7684\uFF0C\u4EFB\u4F55\u6709\u6548\u7684\u6587\u4EF6\u53F7\u3002
varnamer\u662F\u5FC5\u9700\u7684\uFF0C\u6709\u6548\u7684<span class="token keyword">Variant</span>\u6216<span class="token keyword">String</span>\u53D8\u91CF\u540D\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 13 \u884C\u4EE3\u7801\u4F7F\u7528 Split \u51FD\u6570\u6309\u9017\u53F7\u4F5C\u4E3A\u5206\u9694\u7B26\u5206\u5F00\u8FD9\u884C\u5B57\u7B26\uFF0C\u8D4B\u503C\u6570\u7EC4 mArr\u3002\u5173\u4E8E Split \u51FD\u6570\u8BF7\u53C2\u9605 169-2\u3002</p><p>\u7B2C 14 \u884C\u5230\u7B2C 16 \u884C\u4EE3\u7801\u5C06\u6570\u7EC4 mArr \u5FAA\u73AF\u8D4B\u503C\u7ED9\u5355\u5143\u683C\uFF0C\u8BF7\u53C2\u9605 169-1\u3002</p><p>\u7B2C 19 \u884C\u4EE3\u7801\u5173\u95ED\u6587\u672C\u6587\u4EF6\u3002Close \u8BED\u53E5\u5173\u95ED Open \u8BED\u53E5\u6240\u6253\u5F00\u7684\u8F93\u5165/\u8F93\u51FA (I/O) \u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Close [filenumberlist]

\u53C2\u6570filenumberlist\u662F\u53EF\u9009\u7684\uFF0C\u4E3A\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u53F7\uFF0C\u5982\u7701\u7565\u5219\u5C06\u5173\u95ED\u6240\u6709\u7531Open\u8BED\u53E5\u6253\u5F00\u7684\u6D3B\u52A8\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-\u4F7F\u7528-opentext-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-\u4F7F\u7528-opentext-\u65B9\u6CD5" aria-hidden="true">#</a> 3\uFF09\u4F7F\u7528 OpenText \u65B9\u6CD5</h3><p>\u4F7F\u7528 OpenText \u65B9\u6CD5\u8F7D\u5165\u4E00\u4E2A\u6587\u672C\u6587\u4EF6\u5E76\u5C06\u5176\u4F5C\u4E3A\u5305\u542B\u5355\u4E2A\u5DE5\u4F5C\u8868\u7684\u5DE5\u4F5C\u7C3F\u5904\u7406\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> OpenText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myFileName <span class="token keyword">As</span> <span class="token keyword">String</span>
	myFileName <span class="token operator">=</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span>
	Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>ClearContents
	Workbooks<span class="token punctuation">.</span>OpenText <span class="token operator">_</span>
		Filename<span class="token punctuation">:</span><span class="token operator">=</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> myFileName<span class="token punctuation">,</span> <span class="token operator">_</span>
		StartRow<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> DataType<span class="token punctuation">:</span><span class="token operator">=</span>xlDelimited<span class="token punctuation">,</span> Comma<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span>
	<span class="token keyword">With</span> ActiveWorkbook
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;\u5DE5\u8D44\u8868&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CurrentRegion
			ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token punctuation">.</span>Value
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token punctuation">.</span>Close <span class="token boolean">False</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>OpenText \u8FC7\u7A0B\u4F7F\u7528 OpenText \u65B9\u6CD5\u8F7D\u5165\u201C\u5DE5\u8D44\u8868.txt\u201D\u6587\u672C\u6587\u4EF6\u5E76\u5C06\u5176\u6570\u636E\u5199\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u7B2C 5 \u884C\u5230\u7B2C 7 \u884C\u4EE3\u7801\u4F7F\u7528 OpenText \u65B9\u6CD5\u8F7D\u5165\u201C\u5DE5\u8D44\u8868.txt\u201D\u6587\u672C\u6587\u4EF6\u3002OpenText \u65B9\u6CD5\u8F7D\u5165\u4E00\u4E2A\u6587\u672C\u6587\u4EF6\uFF0C\u5E76\u5C06\u5176\u4F5C\u4E3A\u5305\u542B\u5355\u4E2A\u5DE5\u4F5C\u8868\u7684\u5DE5\u4F5C\u7C3F\u8FDB\u884C\u5206\u5217\u5904\u7406\uFF0C\u7136\u540E\u5728\u6B64\u5DE5\u4F5C\u8868\u4E2D\u653E\u5165\u7ECF\u8FC7\u5206\u5217\u5904\u7406\u7684\u6587\u672C\u6587\u4EF6\u6570\u636E\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>OpenText<span class="token punctuation">(</span>FileName<span class="token punctuation">,</span> Origin<span class="token punctuation">,</span> StartRow<span class="token punctuation">,</span> DataType<span class="token punctuation">,</span> TextQualifier<span class="token punctuation">,</span> ConsecutiveDelimiter<span class="token punctuation">,</span> Tab<span class="token punctuation">,</span> Semicolon<span class="token punctuation">,</span> Comma<span class="token punctuation">,</span> Space<span class="token punctuation">,</span> Other<span class="token punctuation">,</span> OtherChar<span class="token punctuation">,</span> FieldInfo<span class="token punctuation">,</span> TextVisualLayout<span class="token punctuation">,</span> DecimalSeparator<span class="token punctuation">,</span> ThousandsSeparator<span class="token punctuation">,</span> TrailingMinusNumbers<span class="token punctuation">,</span> Local<span class="token punctuation">)</span>

\u5176\u4E2D\u53C2\u6570FileName\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u8981\u8F7D\u5165\u5E76\u4F5C\u5206\u5217\u5904\u7406\u7684\u6587\u4EF6\u540D\u79F0\u3002
\u53C2\u6570StartRow\u662F\u53EF\u9009\u7684\uFF0C\u4F5C\u5206\u5217\u5904\u7406\u7684\u8D77\u59CB\u884C\u53F7\uFF0C\u9ED8\u8BA4\u503C\u4E3A <span class="token number">1</span>\u3002
\u53C2\u6570DataType\u662F\u53EF\u9009\u7684\uFF0C\u5728\u6587\u4EF6\u4E2D\u6307\u5B9A\u6570\u636E\u7684\u5217\u683C\u5F0F\u3002
\u53C2\u6570Comma\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u8BE5\u503C\u4E3A<span class="token boolean">True</span>\uFF0C\u5219\u5C06\u5206\u9694\u7B26\u8BBE\u4E3A\u9017\u53F7\u3002
\u5176\u4ED6\u53C2\u6570\u8BF7\u53C2\u9605VBA\u4E2D\u7684\u5E2E\u52A9\u6587\u6863\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u7B2C 9 \u884C\u5230\u7B2C 11 \u884C\u4EE3\u7801\u5C06\u4F5C\u4E3A\u5DE5\u4F5C\u8868\u6253\u5F00\u7684\u6587\u672C\u6587\u4EF6\u4E2D\u7684\u6570\u636E\u5199\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u7B2C 13 \u884C\u4EE3\u7801\u4F7F\u7528 Close \u65B9\u6CD5\u5173\u95ED\u6253\u5F00\u7684\u6587\u672C\u6587\u4EF6\u3002</p><h2 id="_171\u3001\u5C06\u6570\u636E\u5199\u5165\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_171\u3001\u5C06\u6570\u636E\u5199\u5165\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 171\u3001\u5C06\u6570\u636E\u5199\u5165\u6587\u672C\u6587\u4EF6</h2><p>\u5728\u9700\u8981\u65F6\u53EF\u4EE5\u5C06 Excel \u4E2D\u7684\u6570\u636E\u5199\u5165\u5230\u6587\u672C\u6587\u4EF6\u4E2D\uFF0C\u6709\u4EE5\u4E0B\u65B9\u6CD5\u53EF\u4EE5\u5B9E\u73B0\u3002</p><h3 id="_1-\u4F7F\u7528-print-\u8BED\u53E5" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528-print-\u8BED\u53E5" aria-hidden="true">#</a> 1\uFF09\u4F7F\u7528 Print # \u8BED\u53E5</h3><p>\u4F7F\u7528 Print # \u8BED\u53E5\u5C06\u6570\u636E\u5199\u5165\u6587\u672C\u6587\u4EF6\u4E2D\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> PrintText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myFileName <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> myDataAr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> myStr <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> myRow <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> myCol <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	myFileName <span class="token operator">=</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span>
	Kill ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> myFileName
	<span class="token keyword">With</span> Sheet1
		myRow <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
		myCol <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;IV1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlToLeft<span class="token punctuation">)</span><span class="token punctuation">.</span>Column
		<span class="token keyword">ReDim</span> myDataAr<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> myRow<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">To</span> myCol<span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> myRow
			<span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> myCol
				myDataAr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
			<span class="token keyword">Next</span>
		<span class="token keyword">Next</span>
		Open ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> myFileName <span class="token keyword">For</span> Output <span class="token keyword">As</span> <span class="token number">1</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myDataAr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
			myStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
			<span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myDataAr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
				myStr <span class="token operator">=</span> myStr <span class="token operator">&amp;</span> <span class="token keyword">CStr</span><span class="token punctuation">(</span>myDataAr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,&quot;</span>
			<span class="token keyword">Next</span>
			myStr <span class="token operator">=</span> Left<span class="token punctuation">(</span>myStr<span class="token punctuation">,</span> <span class="token punctuation">(</span>Len<span class="token punctuation">(</span>myStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			Print <span class="token number">1</span><span class="token punctuation">,</span> myStr
		<span class="token keyword">Next</span>
		Close <span class="token number">1</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	MsgBox <span class="token string">&quot;\u6587\u4EF6\u4FDD\u5B58\u6210\u529F!&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>PrintText \u8FC7\u7A0B\u5C06\u5DE5\u4F5C\u8868\u4E2D\u6570\u636E\u5199\u5165\u5230\u6587\u672C\u6587\u4EF6\u201C\u5DE5\u8D44\u8868.txt\u201D\u4E2D\u3002</p><p>\u7B2C 11 \u884C\u4EE3\u7801\u4F7F\u7528 Kill \u65B9\u6CD5\u5220\u9664\u540C\u4E00\u76EE\u5F55\u4E2D\u53EF\u80FD\u5B58\u5728\u7684\u540C\u540D\u6587\u672C\u6587\u4EF6\u3002</p><p>\u7B2C 13\u300114 \u884C\u4F7F\u7528\u5355\u5143\u683C\u7684 End \u5C5E\u6027\u53D6\u5F97\u5DE5\u4F5C\u8868\u4E2D\u5DF2\u4F7F\u7528\u6570\u636E\u7684\u884C\u3001\u5217\u53F7\uFF0C\u5173\u4E8E End \u5C5E\u6027\u8BF7\u53C2\u9605 3 \u3002</p><p>\u7B2C 15 \u884C\u4EE3\u7801\u91CD\u65B0\u5B9A\u4E49\u52A8\u6001\u6570\u7EC4 myDataAr \u7684\u5927\u5C0F\u3002\u5173\u4E8E\u52A8\u6001\u6570\u7EC4\u8BF7\u53C2\u9605\u6280\u5DE7169-3\u3002</p><p>\u7B2C 16 \u884C\u5230\u7B2C 20 \u884C\u4EE3\u7801\u5C06\u5DE5\u4F5C\u8868\u6570\u636E\u8D4B\u7ED9\u6570\u7EC4 myDataAr\u3002</p><p>\u7B2C 21 \u884C\u4EE3\u7801\u4F7F\u7528 Open \u8BED\u53E5\u6253\u5F00\u6587\u672C\u6587\u4EF6\u4EE5\u5B8C\u6210\u5BF9\u6587\u672C\u6587\u4EF6\u7684\u8F93\u5165\u3002\u5173\u4E8E Open \u8BED\u53E5\u8BF7\u53C2\u9605 170-2\u3002</p><p>\u7B2C 22 \u884C\u5230\u7B2C 29 \u884C\u4EE3\u7801\u4F7F\u7528 Print # \u8BED\u53E5\u5C06\u6570\u7EC4 myDataAr\u4E2D\u7684\u6240\u6709\u5143\u7D20\u5199\u5165\u5230\u6587\u672C\u6587\u4EF6\u4E2D\u3002Print # \u8BED\u53E5\u5C06\u683C\u5F0F\u5316\u663E\u793A\u7684\u6570\u636E\u5199\u5165\u987A\u5E8F\u6587\u4EF6\u4E2D\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Print <span class="token operator">#</span>filenumber<span class="token punctuation">,</span> [outputlist]

Filenumber\u662F\u5FC5\u9700\u7684\uFF0C\u4EFB\u4F55\u6709\u6548\u7684\u6587\u4EF6\u53F7\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 30 \u884C\u4EE3\u7801 Close \u8BED\u53E5\u5173\u95ED\u6587\u672C\u6587\u4EF6\u3002</p><h3 id="_2-\u53E6\u5B58\u4E3A\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-\u53E6\u5B58\u4E3A\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 2\uFF09\u53E6\u5B58\u4E3A\u6587\u672C\u6587\u4EF6</h3><p>\u4F7F\u7528 SaveAs \u65B9\u6CD5\u5C06\u5DE5\u4F5C\u8868\u53E6\u5B58\u4E3A\u6587\u672C\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> SaveText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myFileName <span class="token keyword">As</span> <span class="token keyword">String</span>
	myFileName <span class="token operator">=</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Kill ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> myFileName
	Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">False</span>
	Worksheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Copy
	ActiveWorkbook<span class="token punctuation">.</span>SaveAs Filename<span class="token punctuation">:</span><span class="token operator">=</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">_</span>
		<span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> myFileName<span class="token punctuation">,</span> <span class="token operator">_</span>
		FileFormat<span class="token punctuation">:</span><span class="token operator">=</span>xlCSV
	MsgBox <span class="token string">&quot;\u6587\u4EF6\u4FDD\u5B58\u6210\u529F!&quot;</span>
	ActiveWorkbook<span class="token punctuation">.</span>Close SaveChanges<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>
	Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>SaveText \u8FC7\u7A0B\u5C06\u5DE5\u4F5C\u8868\u201CSheet1\u201D\u4FDD\u5B58\u4E3A\u6587\u672C\u6587\u4EF6\u3002</p><p>\u7B2C 4\u30015 \u884C\u4EE3\u7801\u4F7F\u7528 Kill \u65B9\u6CD5\u5220\u9664\u540C\u4E00\u76EE\u5F55\u4E2D\u53EF\u80FD\u5B58\u5728\u7684\u540C\u540D\u6587\u672C\u6587\u4EF6\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u4F7F\u7528 Copy \u65B9\u6CD5\u590D\u5236\u5DE5\u4F5C\u8868\u201CSheet1\u201D\u3002</p><p>\u7B2C 8 \u884C\u5230\u7B2C 10 \u884C\u4EE3\u7801\u4F7F\u7528 SaveAs \u65B9\u6CD5\u5C06\u6587\u4EF6\u4FDD\u5B58\u4E3A\u6587\u672C\u6587\u4EF6\u3002\u5E94\u7528\u4E8E Workbook \u5BF9\u8C61\u7684 SaveAs \u65B9\u6CD5\u4FDD\u5B58\u5BF9\u4E0D\u540C\u6587\u4EF6\u4E2D\u7684\u5DE5\u4F5C\u8868\u7684\u66F4\u6539\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>FileName<span class="token punctuation">,</span> FileFormat<span class="token punctuation">,</span> Password<span class="token punctuation">,</span> WriteResPassword<span class="token punctuation">,</span> ReadOnlyRecommended<span class="token punctuation">,</span> CreateBackup<span class="token punctuation">,</span> AccessMode<span class="token punctuation">,</span> ConflictResolution<span class="token punctuation">,</span> AddToMru<span class="token punctuation">,</span> TextCodepage<span class="token punctuation">,</span> TextVisualLayout<span class="token punctuation">,</span> Local<span class="token punctuation">)</span>

\u5176\u4E2D\u53C2\u6570Filename\u8868\u793A\u8981\u4FDD\u5B58\u7684\u6587\u4EF6\u540D\u3002\u53EF\u5305\u542B\u5B8C\u6574\u8DEF\u5F84\u3002\u5982\u679C\u4E0D\u6307\u5B9A\u8DEF\u5F84\uFF0CMicrosoft Excel \u5C06\u6587\u4EF6\u4FDD\u5B58\u5230\u5F53\u524D\u6587\u4EF6\u5939\u4E2D\u3002
\u5176\u4E2D\u53C2\u6570FileFormat\u6307\u5B9A\u4FDD\u5B58\u6587\u4EF6\u65F6\u4F7F\u7528\u7684\u6587\u4EF6\u683C\u5F0F\uFF0C\u5728\u672C\u4F8B\u4E2D\u6307\u5B9A\u4E3AxlCSV\u5373\u4FDD\u5B58\u4E3A\u6587\u672C\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 12 \u884C\u4EE3\u7801\u4F7F\u7528 Close \u65B9\u6CD5\u5173\u95ED\u6D3B\u52A8\u5DE5\u4F5C\u7C3F\u3002</p><h2 id="_172\u3001\u6587\u4EF6\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#_172\u3001\u6587\u4EF6\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4" aria-hidden="true">#</a> 172\u3001\u6587\u4EF6\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4</h2><p>\u5728 VBA \u8FC7\u7A0B\u4E2D\u5982\u679C\u9700\u8981\u83B7\u5F97\u6587\u4EF6\u6700\u540E\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4\uFF0C\u53EF\u4EE5\u4F7F\u7528 FileDateTime \u51FD\u6570\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> myDateTime<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Stmp <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> myDateTime <span class="token keyword">As</span> <span class="token keyword">Date</span>
	Stmp <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> ThisWorkbook<span class="token punctuation">.</span>Name
	myDateTime <span class="token operator">=</span> FileDateTime<span class="token punctuation">(</span>Stmp<span class="token punctuation">)</span>
	MsgBox Stmp <span class="token operator">&amp;</span> <span class="token string">&quot;\u6700\u540E\u4FEE\u6539\u65F6\u95F4\u662F\uFF1A&quot;</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> myDateTime
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>myDateTime \u8FC7\u7A0B\u4F7F\u7528\u6D88\u606F\u6846\u663E\u793A\u6587\u4EF6\u6700\u540E\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4\u3002</p><p>FileDateTime \u51FD\u6570\u8FD4\u56DE\u4E00\u4E2A\u6587\u4EF6\u88AB\u521B\u5EFA\u6216\u6700\u540E\u4FEE\u6539\u540E\u7684\u65E5\u671F\u548C\u65F6\u95F4\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>FileDateTime<span class="token punctuation">(</span>pathname<span class="token punctuation">)</span>

pathname \u53C2\u6570\u662F\u5FC5\u9700\u7684\uFF0C\u7528\u6765\u6307\u5B9A\u6587\u4EF6\u540D\u7684\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\u3002pathname \u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528\u53D8\u91CF Stmp \u4FDD\u5B58\u4EE3\u7801\u6240\u5728\u5DE5\u4F5C\u7C3F\u7684\u8DEF\u5F84\u548C\u540D\u79F0\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528\u53D8\u91CF myDateTime \u4FDD\u5B58 FileDateTime \u51FD\u6570\u8FD4\u56DE\u7684\u65E5\u671F\u548C\u65F6\u95F4\u3002</p><p>\u8FD0\u884C myDateTime \u8FC7\u7A0B\u7ED3\u679C\u5982\u56FE 172-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+a+`" alt="" loading="lazy"></p><p><u>\u56FE 172-1</u> \u6587\u4EF6\u6700\u540E\u4FEE\u6539\u7684\u65E5\u671F\u548C\u65F6\u95F4</p></div><h2 id="_173\u3001\u67E5\u627E\u6587\u4EF6\u6216\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_173\u3001\u67E5\u627E\u6587\u4EF6\u6216\u6587\u4EF6\u5939" aria-hidden="true">#</a> 173\u3001\u67E5\u627E\u6587\u4EF6\u6216\u6587\u4EF6\u5939</h2><p>\u5728\u78C1\u76D8\u4E2D\u67E5\u627E\u6587\u4EF6\u6216\u6587\u4EF6\u5939\uFF0C\u53EF\u4EE5\u4F7F\u7528 Dir \u51FD\u6570\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> mydir<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> mydir <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> b <span class="token keyword">As</span> <span class="token keyword">Byte</span>
	b <span class="token operator">=</span> <span class="token number">1</span>
	Range<span class="token punctuation">(</span><span class="token string">&quot;A:A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ClearContents
	mydir <span class="token operator">=</span> Dir<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\*.xls&quot;</span><span class="token punctuation">,</span> vbNormal<span class="token punctuation">)</span>
	<span class="token keyword">Do</span> <span class="token keyword">While</span> mydir <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span>
		Cells<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> mydir
		mydir <span class="token operator">=</span> Dir
		b <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token number">1</span>
	<span class="token keyword">Loop</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Mydir \u8FC7\u7A0B\u4F7F\u7528 Dir \u51FD\u6570\u5728\u4EE3\u7801\u6240\u5728\u5DE5\u4F5C\u7C3F\u7684\u6587\u4EF6\u5939\u4E2D\u67E5\u627E\u6240\u6709\u7684 Excel \u6587\u4EF6\uFF0C\u627E\u5230\u540E\u5199\u5165\u5230\u5DE5\u4F5C\u8868\u7684 A \u5217\u5355\u5143\u683C\u4E2D\u3002</p><p>\u7B2C 2 \u884C\u4EE3\u7801\u58F0\u660E\u53D8\u91CF mydir \u4FDD\u5B58\u8FD4\u56DE\u7684\u6587\u4EF6\u540D\u79F0\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u58F0\u660E\u53D8\u91CF b \u4FDD\u5B58\u8FD4\u56DE\u7684\u6587\u4EF6\u6570\u76EE\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u8BBE\u7F6E\u53D8\u91CF b \u7684\u521D\u59CB\u503C\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u6E05\u9664 A \u5217\u6240\u6709\u6570\u636E\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u4F7F\u7528 Dir \u51FD\u6570\u5728\u4EE3\u7801\u6240\u5728\u5DE5\u4F5C\u7C3F\u7684\u6587\u4EF6\u5939\u4E2D\u67E5\u627E Excel \u6587\u4EF6\u3002Dir \u51FD\u6570\u8FD4\u56DE\u4E00\u4E2A String\uFF0C\u7528\u4EE5\u8868\u793A\u4E00\u4E2A\u6587\u4EF6\u540D\u3001\u76EE\u5F55\u540D\u6216\u6587\u4EF6\u5939\u540D\u79F0\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Dir[<span class="token punctuation">(</span>pathname[<span class="token punctuation">,</span> attributes]<span class="token punctuation">)</span>]

\u53C2\u6570pathname\u662F\u53EF\u9009\u7684\uFF0C\u7528\u6765\u6307\u5B9A\u6587\u4EF6\u540D\u7684\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u53EF\u80FD\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002\u5982\u679C\u6CA1\u6709\u627E\u5230pathname\uFF0C\u5219\u4F1A\u8FD4\u56DE\u96F6\u957F\u5EA6\u5B57\u7B26\u4E32 <span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>\u3002
\u53C2\u6570attributes\u662F\u53EF\u9009\u7684\uFF0C\u5E38\u6570\u6216\u6570\u503C\u8868\u8FBE\u5F0F\uFF0C\u5176\u603B\u548C\u7528\u6765\u6307\u5B9A\u6587\u4EF6\u5C5E\u6027\uFF0C\u5982\u8868\u683C <span class="token number">173</span><span class="token number">1</span>\u6240\u793A\u3002\u5982\u679C\u7701\u7565\uFF0C\u5219\u4F1A\u8FD4\u56DE\u4E0D\u5305\u542B\u5C5E\u6027\u7684\u5339\u914D\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><u>\u8868\u683C 173-1</u> attributes\u8BBE\u7F6E\u503C</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>vbNormal</td><td>0</td><td>(\u7F3A\u7701) \u6307\u5B9A\u6CA1\u6709\u5C5E\u6027\u7684\u6587\u4EF6\u3002</td></tr><tr><td>vbReadOnly</td><td>1</td><td>\u6307\u5B9A\u65E0\u5C5E\u6027\u7684\u53EA\u8BFB\u6587\u4EF6\u3002</td></tr><tr><td>vbHidden</td><td>2</td><td>\u6307\u5B9A\u65E0\u5C5E\u6027\u7684\u9690\u85CF\u6587\u4EF6\u3002</td></tr><tr><td>VbSystem</td><td>4</td><td>\u6307\u5B9A\u65E0\u5C5E\u6027\u7684\u7CFB\u7EDF\u6587\u4EF6\uFF0C\u5728Macintosh\u4E2D\u4E0D\u53EF\u7528\u3002</td></tr><tr><td>vbVolume</td><td>8</td><td>\u6307\u5B9A\u5377\u6807\u6587\u4EF6\uFF1B\u5982\u679C\u6307\u5B9A\u4E86\u5176\u5B83\u5C5E\u6027\uFF0C\u5219\u5FFD\u7565\u3002vbVolume \u5728Macintosh\u4E2D\u4E0D\u53EF\u7528\u3002</td></tr><tr><td>vbDirectory</td><td>16</td><td>\u6307\u5B9A\u65E0\u5C5E\u6027\u6587\u4EF6\u53CA\u5176\u8DEF\u5F84\u548C\u6587\u4EF6\u5939\u3002</td></tr><tr><td>vbAlias</td><td>64</td><td>\u6307\u5B9A\u7684\u6587\u4EF6\u540D\u662F\u522B\u540D\uFF0C\u53EA\u5728Macintosh\u4E0A\u53EF\u7528\u3002</td></tr></tbody></table><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u5728\u7B2C\u4E00\u6B21\u8C03\u7528 Dir \u51FD\u6570\u65F6\uFF0C\u5FC5\u987B\u6307\u5B9A pathname\uFF0C\u5426\u5219\u4F1A\u4EA7\u751F\u9519\u8BEF\u3002</p></div><p>\u7B2C 7 \u884C\u5230\u7B2C 11 \u884C\u4EE3\u7801\u5C06\u8FD4\u56DE\u7684\u6587\u4EF6\u540D\u79F0\u5199\u5165\u5230 A \u5217\u5355\u5143\u683C\u4E2D\u3002Dir \u51FD\u6570\u4F1A\u8FD4\u56DE\u5339\u914D pathname \u53C2\u6570\u7684\u7B2C\u4E00\u4E2A\u6587\u4EF6\u540D\uFF0C\u82E5\u60F3\u5F97\u5230\u5176\u4ED6\u5339\u914D pathname \u53C2\u6570\u7684\u6587\u4EF6\u540D\uFF0C\u9700\u518D\u4E00\u6B21\u8C03\u7528 Dir \u51FD\u6570\uFF0C\u4E14\u4E0D\u8981\u4F7F\u7528\u53C2\u6570\u3002\u5982\u679C\u5DF2\u6CA1\u6709\u5408\u4E4E\u6761\u4EF6\u7684\u6587\u4EF6\uFF0C\u5219 Dir \u51FD\u6570\u4F1A\u8FD4\u56DE\u4E00\u4E2A\u96F6\u957F\u5EA6\u5B57\u7B26\u4E32 (&quot;&quot;)\u3002</p><p>\u8FD0\u884C Mydir \u8FC7\u7A0B\u5DE5\u4F5C\u8868\u4E2D\u5982\u56FE 173-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+e+`" alt="" loading="lazy"></p><p><u>\u56FE 173-1</u> \u4F7F\u7528 Dir \u51FD\u6570\u8FD4\u56DE\u6587\u4EF6\u540D\u79F0</p></div><h2 id="_174\u3001\u83B7\u5F97\u5F53\u524D\u6587\u4EF6\u5939\u7684\u540D\u79F0" tabindex="-1"><a class="header-anchor" href="#_174\u3001\u83B7\u5F97\u5F53\u524D\u6587\u4EF6\u5939\u7684\u540D\u79F0" aria-hidden="true">#</a> 174\u3001\u83B7\u5F97\u5F53\u524D\u6587\u4EF6\u5939\u7684\u540D\u79F0</h2><p>\u5728\u5904\u7406\u6587\u4EF6\u65F6\u7ECF\u5E38\u9700\u8981\u83B7\u5F97\u5F53\u524D\u6587\u4EF6\u5939\u7684\u540D\u79F0\uFF0C\u6B64\u65F6\u53EF\u4EE5\u4F7F\u7528 CurDir \u51FD\u6570\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CurFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	MsgBox CurDir<span class="token punctuation">(</span><span class="token string">&quot;F&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>CurFolder \u8FC7\u7A0B\u4F7F\u7528\u6D88\u606F\u6846\u663E\u793AF\u76D8\u4E2D\u7684\u5F53\u524D\u6587\u4EF6\u5939\u540D\u79F0\u3002</p><p>CurDir \u51FD\u6570\u8FD4\u56DE\u4E00\u4E2A Variant \u7C7B\u578B\u7684\u6587\u4EF6\u8DEF\u5F84\u3002\u5982\u679C\u9700\u8981\u8FD4\u56DE\u5B57\u7B26\u4E32\u7C7B\u578B\u7684\u6587\u4EF6\u8DEF\u5F84\u5219\u4F7F\u7528 CurDir$\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>CurDir[<span class="token punctuation">(</span>drive<span class="token punctuation">)</span>]

\u53C2\u6570drive\u662F\u53EF\u9009\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u6307\u5B9A\u4E00\u4E2A\u5B58\u5728\u7684\u9A71\u52A8\u5668\u3002\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u9A71\u52A8\u5668\uFF0C\u6216\u53C2\u6570drive \u662F\u96F6\u957F\u5EA6\u5B57\u7B26\u4E32 <span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>\uFF0C\u5219CurDir\u51FD\u6570\u4F1A\u8FD4\u56DE\u5F53\u524D\u9A71\u52A8\u5668\u7684\u8DEF\u5F84\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5047\u8BBE\u793A\u4F8B\u6587\u4EF6\u4FDD\u5B58\u5728 F \u76D8\u7684\u201CVBA\u5E38\u7528\u6280\u5DE7\\\u793A\u4F8B\u6587\u4EF6\\\u7B2C10\u7AE0 \u6587\u4EF6\u64CD\u4F5C\u201D\u6587\u4EF6\u5939\u4E2D\uFF0C\u8FD0\u884C CurFolder \u8FC7\u7A0B\u7ED3\u679C\u5982\u56FE 174-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+p+`" alt="" loading="lazy"></p><p><u>\u56FE 174-1</u> \u83B7\u5F97\u5F53\u524D\u6587\u4EF6\u5939\u7684\u540D\u79F0</p></div><h2 id="_175\u3001\u521B\u5EFA\u548C\u5220\u9664\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_175\u3001\u521B\u5EFA\u548C\u5220\u9664\u6587\u4EF6\u5939" aria-hidden="true">#</a> 175\u3001\u521B\u5EFA\u548C\u5220\u9664\u6587\u4EF6\u5939</h2><p>\u53EF\u4EE5\u5728\u7A0B\u5E8F\u8FD0\u884C\u65F6\u521B\u5EFA\u548C\u5220\u9664\u6587\u4EF6\u5939\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> TempFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	MkDir ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\Temp&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>TempFolder \u8FC7\u7A0B\u4F7F\u7528 MkDir \u8BED\u53E5\u5728\u793A\u4F8B\u6240\u5728\u7684\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u201CTemp\u201D\u6587\u4EF6\u5939\u3002MkDir \u8BED\u53E5\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>MkDir path

\u53C2\u6570path\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u6240\u8981\u521B\u5EFA\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u7684\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u53EF\u4EE5\u5305\u542B\u9A71\u52A8\u5668\u3002\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u9A71\u52A8\u5668\uFF0C\u5219\u5728\u5F53\u524D\u9A71\u52A8\u5668\u4E0A\u521B\u5EFA\u65B0\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 2 \u884C\u4EE3\u7801\u542F\u52A8\u9519\u8BEF\u5904\u7406\u7A0B\u5E8F\uFF0C\u56E0\u4E3A\u5728\u521B\u5EFA\u8FC7\u7A0B\u4E2D\u5982\u679C\u6587\u4EF6\u5939\u4E2D\u5DF2\u5B58\u5728\u76F8\u540C\u540D\u79F0\u7684\u201CTemp\u201D\u6587\u4EF6\u5939\u4F1A\u53D1\u751F \u201C\u8DEF\u5F84\u672A\u627E\u5230\u201D\u9519\u8BEF\uFF0C\u6240\u4EE5\u4F7F\u7528 On Error Resume Next \u8BED\u53E5\u5FFD\u7565\u9519\u8BEF\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 MkDir \u8BED\u53E5\u521B\u5EFA\u201CTemp\u201D\u6587\u4EF6\u5939\u3002</p><p>\u5982\u679C\u9700\u8981\u5220\u9664\u4E0D\u9700\u8981\u7684\u6587\u4EF6\u5939\u53EF\u4EE5\u4F7F\u7528 RmDir \u8BED\u53E5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> RmFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	RmDir ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\Temp&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>RmFolder \u8FC7\u7A0B\u4F7F\u7528 RmDir \u8BED\u53E5\u5220\u9664\u5728\u793A\u4F8B\u6240\u5728\u7684\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u201CTemp\u201D\u6587\u4EF6\u5939\u3002RmDir \u8BED\u53E5\u5220\u9664\u4E00\u4E2A\u5B58\u5728\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>RmDir path

\u53C2\u6570path\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u6240\u8981\u521B\u5EFA\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u7684\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u53EF\u4EE5\u5305\u542B\u9A71\u52A8\u5668\u3002\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u9A71\u52A8\u5668\uFF0C\u5219\u5728\u5F53\u524D\u9A71\u52A8\u5668\u4E0A\u521B\u5EFA\u65B0\u7684\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 2 \u884C\u4EE3\u7801\u542F\u52A8\u9519\u8BEF\u5904\u7406\u7A0B\u5E8F\uFF0C\u56E0\u4E3A\u5728\u4F7F\u7528 RmDir \u8BED\u53E5\u5220\u9664\u5E76\u4E0D\u5B58\u5728\u7684\u6587\u4EF6\u5939\u6216\u5220\u9664\u542B\u6709\u6587\u4EF6\u7684\u6587\u4EF6\u5939\u65F6\u4F1A\u53D1\u751F \u201C\u8DEF\u5F84\u672A\u627E\u5230\u201D\u9519\u8BEF\uFF0C\u6240\u4EE5\u4F7F\u7528 On Error Resume Next \u8BED\u53E5\u5FFD\u7565\u9519\u8BEF\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 RmDir \u8BED\u53E5\u5220\u9664\u201CTemp\u201D\u6587\u4EF6\u5939\u3002\u5982\u679C\u201CTemp\u201D\u6587\u4EF6\u5939\u4E2D\u542B\u6709\u6587\u4EF6\u53EF\u4EE5\u5728\u5220\u9664\u6587\u4EF6\u5939\u4E4B\u524D\uFF0C\u5148\u4F7F\u7528 Kill \u8BED\u53E5\u6765\u5220\u9664\u6240\u6709\u6587\u4EF6\uFF0C\u8BF7\u53C2\u9605 178 \u3002</p><h2 id="_176\u3001\u91CD\u547D\u540D\u6587\u4EF6\u6216\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_176\u3001\u91CD\u547D\u540D\u6587\u4EF6\u6216\u6587\u4EF6\u5939" aria-hidden="true">#</a> 176\u3001\u91CD\u547D\u540D\u6587\u4EF6\u6216\u6587\u4EF6\u5939</h2><p>\u4F7F\u7528 Name \u8BED\u53E5\u53EF\u4EE5\u91CD\u547D\u540D\u6587\u4EF6\u6216\u6587\u4EF6\u5939\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Filename<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Name ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123&quot;</span> <span class="token keyword">As</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC&quot;</span>
	Name ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span> <span class="token keyword">As</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC\\ABC.xls&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Filename \u8FC7\u7A0B\u4F7F\u7528 Name \u8BED\u53E5\u91CD\u547D\u540D\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123\u201D\u6587\u4EF6\u5939\u548C\u201C123.xls\u201D Excel \u6587\u4EF6\u5E76\u5C06\u91CD\u547D\u540D\u540E\u7684 Excel \u6587\u4EF6\u79FB\u52A8\u5230\u91CD\u547D\u540D\u540E\u7684\u6587\u4EF6\u5939\u4E2D\u3002</p><p>Name \u8BED\u53E5\u91CD\u65B0\u547D\u540D\u4E00\u4E2A\u6587\u4EF6\u3001\u76EE\u5F55\u3001\u6216\u6587\u4EF6\u5939\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Name oldpathname <span class="token keyword">As</span> newpathname

\u53C2\u6570oldpathname\u662F\u5FC5\u9700\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u6307\u5B9A\u5DF2\u5B58\u5728\u7684\u6587\u4EF6\u540D\u548C\u4F4D\u7F6E\uFF0C\u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
\u53C2\u6570newpathname\u662F\u5FC5\u9700\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u6307\u5B9A\u65B0\u7684\u6587\u4EF6\u540D\u548C\u4F4D\u7F6E\uFF0C\u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 2 \u884C\u4EE3\u7801\u542F\u52A8\u9519\u8BEF\u5904\u7406\u7A0B\u5E8F\uFF0C\u56E0\u4E3A\u5728\u91CD\u547D\u540D\u8FC7\u7A0B\u4E2D\u5982\u679C\u53C2\u6570 oldpathname \u6307\u5B9A\u7684\u6587\u4EF6\u6216\u6587\u4EF6\u5939\u4E0D\u5B58\u5728\u4F1A\u53D1\u751F \u201C\u6587\u4EF6\u672A\u627E\u5230\u201D\u9519\u8BEF\uFF0C\u6240\u4EE5\u4F7F\u7528 On Error Resume Next \u8BED\u53E5\u5FFD\u7565\u9519\u8BEF\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 Name \u8BED\u53E5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123\u201D\u6587\u4EF6\u5939\u91CD\u547D\u540D\u4E3A\u201CABC\u201D\u6587\u4EF6\u5939\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 Name \u8BED\u53E5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201DExcel\u6587\u4EF6\u91CD\u547D\u540D\u4E3A\u201CABC.xls\u201D\u6587\u4EF6\u5E76\u79FB\u52A8\u5230\u201CABC\u201D\u6587\u4EF6\u5939\u4E2D\u3002</p><p>\u5728\u8FD0\u884C Filename \u8FC7\u7A0B\u524D\u8BF7\u786E\u8BA4\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u5305\u542B\u4E00\u4E2A\u201C123\u201D\u6587\u4EF6\u5939\u548C\u4E00\u4E2A\u201C123.xls\u201D Excel \u6587\u4EF6\u3002</p><h2 id="_177\u3001\u590D\u5236\u6307\u5B9A\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_177\u3001\u590D\u5236\u6307\u5B9A\u7684\u6587\u4EF6" aria-hidden="true">#</a> 177\u3001\u590D\u5236\u6307\u5B9A\u7684\u6587\u4EF6</h2><p>\u5982\u679C\u9700\u8981\u628A\u6587\u4EF6\u4ECE\u4E00\u4E2A\u5730\u65B9\u590D\u5236\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u53EF\u4EE5\u4F7F\u7528 FileCopy \u8BED\u53E5\u590D\u5236\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CopyFile<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> SourceFile <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> DestinationFile <span class="token keyword">As</span> <span class="token keyword">String</span>
	SourceFile <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span>
	DestinationFile <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC\\abc.xls&quot;</span>
	FileCopy SourceFile<span class="token punctuation">,</span> DestinationFile
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>CopyFile \u8FC7\u7A0B\u4F7F\u7528 FileCopy \u8BED\u53E5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201DExcel\u6587\u4EF6\u590D\u5236\u5230\u793A\u4F8B\u6587\u4EF6\u76EE\u5F55\u4E0B\u7684\u201CABC\u201D\u6587\u4EF6\u5939\u4E2D\u5E76\u91CD\u65B0\u547D\u540D\u4E3A\u201Cabc.xls\u201D\u3002</p><p>FileCopy \u8BED\u53E5\u590D\u5236\u4E00\u4E2A\u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>FileCopy source<span class="token punctuation">,</span> destination

Source\u53C2\u6570\u662F\u5FC5\u9700\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u7528\u6765\u8868\u793A\u8981\u88AB\u590D\u5236\u7684\u6587\u4EF6\u540D\u3002source\u53C2\u6570\u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
destination\u53C2\u6570\u662F\u5FC5\u9700\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u7528\u6765\u6307\u5B9A\u8981\u590D\u5236\u7684\u76EE\u5730\u6587\u4EF6\u540D\u3002destination\u53C2\u6570 \u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u4E0D\u80FD\u5BF9\u4E00\u4E2A\u5DF2\u6253\u5F00\u7684\u6587\u4EF6\u4F7F\u7528 FileCopy \u8BED\u53E5\uFF0C\u5426\u5219\u4F1A\u4EA7\u751F\u9519\u8BEF\u3002</p></div><p>\u7B2C 4 \u884C\u4EE3\u7801\u6307\u5B9A\u88AB\u590D\u5236\u7684\u6587\u4EF6\u540D\u79F0\u548C\u8DEF\u5F84\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u6307\u5B9A\u76EE\u7684\u6587\u4EF6\u540D\u79F0\u548C\u8DEF\u5F84\uFF0C\u5982\u679C\u5DF2\u5B58\u5728\u76F8\u540C\u540D\u79F0\u7684\u6587\u4EF6\u5219\u4F1A\u8986\u76D6\u539F\u6587\u4EF6\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u4F7F\u7528 FileCopy \u8BED\u53E5\u590D\u5236\u6587\u4EF6\u3002</p><h2 id="_178\u3001\u5220\u9664\u6307\u5B9A\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_178\u3001\u5220\u9664\u6307\u5B9A\u7684\u6587\u4EF6" aria-hidden="true">#</a> 178\u3001\u5220\u9664\u6307\u5B9A\u7684\u6587\u4EF6</h2><p>\u4F7F\u7528 Kill \u65B9\u6CD5\u5220\u9664\u6307\u5B9A\u7684\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> KillFile<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myFile <span class="token keyword">As</span> <span class="token keyword">String</span>
	myFile <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span>
	<span class="token keyword">If</span> Dir<span class="token punctuation">(</span>myFile<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> Kill myFile
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>KillFile \u8FC7\u7A0B\u4F7F\u7528 Kill \u65B9\u6CD5\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u6307\u5B9A\u6240\u8981\u5220\u9664\u6587\u4EF6\u7684\u8DEF\u5F84\u548C\u6587\u4EF6\u540D\u79F0\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 Dir \u51FD\u6570\u8FD4\u56DE\u6307\u5B9A\u6587\u4EF6\u540D\uFF0C\uFF08\u5173\u4E8E Dir \u51FD\u6570\u8BF7\u53C2\u9605 173 \uFF09\u5982\u679C\u5B58\u5728\u8BE5\u6587\u4EF6\u5219\u4F7F\u7528 Kill \u8BED\u53E5\u5220\u9664\u3002Kill \u8BED\u53E5\u4ECE\u78C1\u76D8\u4E2D\u5220\u9664\u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Kill pathname

\u53C2\u6570pathname\u662F\u5FC5\u9700\u7684\uFF0C\u7528\u6765\u6307\u5B9A\u4E00\u4E2A\u6587\u4EF6\u540D\u7684\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u53EF\u4EE5\u5305\u542B\u76EE\u5F55\u6216\u6587\u4EF6\u5939\u3001\u4EE5\u53CA\u9A71\u52A8\u5668\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5728 Microsoft Windows \u4E2D\uFF0CKill \u65B9\u6CD5\u652F\u6301\u591A\u5B57\u7B26 (*) \u548C\u5355\u5B57\u7B26 (?) \u7684\u7EDF\u914D\u7B26\u6765\u6307\u5B9A\u591A\u91CD\u6587\u4EF6\uFF0C\u5982\u9700\u8981\u5220\u9664\u5F53\u524D\u76EE\u5F55\u4E0B\u6240\u6709 *. Xls \u6587\u4EF6\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u4EE3\u7801\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Kill <span class="token string">&quot;*.xls&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u4F7F\u7528 Kill \u65B9\u6CD5\u4E0D\u80FD\u5220\u9664\u5DF2\u6253\u5F00\u7684\u6587\u4EF6\uFF0C\u5426\u5219\u4F1A\u4EA7\u751F\u9519\u8BEF\u3002</p></div><h2 id="_179\u3001\u641C\u7D22\u7279\u5B9A\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_179\u3001\u641C\u7D22\u7279\u5B9A\u7684\u6587\u4EF6" aria-hidden="true">#</a> 179\u3001\u641C\u7D22\u7279\u5B9A\u7684\u6587\u4EF6</h2><p>\u5982\u679C\u9700\u8981\u5BF9\u6587\u4EF6\u5939\u4E2D\u6240\u6709\u7684 Excel \u6587\u4EF6\u8FDB\u884C\u76F8\u540C\u7684\u64CD\u4F5C\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528 Execute \u65B9\u6CD5\u8FDB\u884C\u6587\u4EF6\u641C\u7D22\uFF0C\u793A\u4F8B\u4EE3\u7801\u5982\u4E0B\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Byte</span>
	Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">False</span>
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>FileSearch
		<span class="token punctuation">.</span>LookIn <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path
		<span class="token punctuation">.</span>FileType <span class="token operator">=</span> msoFileTypeExcelWorkbooks
		<span class="token keyword">If</span> <span class="token punctuation">.</span>Execute <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
			<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token punctuation">.</span>FoundFiles<span class="token punctuation">.</span>Count
				<span class="token keyword">If</span> <span class="token punctuation">.</span>FoundFiles<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> ThisWorkbook<span class="token punctuation">.</span>FullName <span class="token keyword">Then</span>
					Workbooks<span class="token punctuation">.</span>Open <span class="token punctuation">.</span>FoundFiles<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
					<span class="token keyword">With</span> ActiveWorkbook
						<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;\u6700\u540E\u6253\u5F00\u65F6\u95F4\uFF1A&quot;</span> <span class="token operator">&amp;</span> Now
						<span class="token punctuation">.</span>Close <span class="token boolean">True</span>
					<span class="token keyword">End</span> <span class="token keyword">With</span>
				<span class="token keyword">End</span> <span class="token keyword">If</span>
			<span class="token keyword">Next</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Sort \u8FC7\u7A0B\u641C\u7D22\u540C\u4E00\u76EE\u5F55\u4E2D\u7684\u6240\u6709 Excel \u6587\u4EF6\u5E76\u5BF9\u5176\u8FDB\u884C\u64CD\u4F5C\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u5173\u95ED\u5C4F\u5E55\u66F4\u65B0\u529F\u80FD\uFF0C\u52A0\u5FEB\u4EE3\u7801\u7684\u8FD0\u884C\u901F\u5EA6\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4E3A\u6587\u4EF6\u641C\u7D22\u521B\u5EFA\u4E00\u4E2A FoundFiles \u5BF9\u8C61\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u8BBE\u7F6E\u8981\u641C\u7D22\u7684\u6587\u4EF6\u5939\uFF0C\u5E94\u7528\u4E8E FoundFiles \u5BF9\u8C61\u7684 LookIn \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u5728\u6307\u5B9A\u7684\u6587\u4EF6\u641C\u7D22\u8FC7\u7A0B\u4E2D\u8981\u641C\u7D22\u7684\u6587\u4EF6\u5939\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u8BBE\u7F6E\u641C\u7D22\u7684\u6587\u4EF6\u7C7B\u578B\u4E3A Excel \u6587\u4EF6\uFF0C\u5E94\u7528\u4E8E FoundFiles \u5BF9\u8C61\u7684 FileType \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u6587\u4EF6\u641C\u7D22\u8FC7\u7A0B\u4E2D\u8981\u67E5\u627E\u7684\u6587\u4EF6\u7C7B\u578B\uFF0C\u8BBE\u7F6E\u4E3A msoFileTypeExcelWorkbooks \u8FD4\u56DE Excel \u6587\u4EF6\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u5F00\u59CB\u5BF9\u6307\u5B9A\u6587\u4EF6\u8FDB\u884C\u641C\u7D22\uFF0C\u5E94\u7528\u4E8E FoundFiles \u5BF9\u8C61\u7684 Execute \u65B9\u6CD5\u7528\u4E8E\u641C\u7D22\u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Execute<span class="token punctuation">(</span>SortBy<span class="token punctuation">,</span> SortOrder<span class="token punctuation">,</span> AlwaysAccurate<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2AFoundFiles\u5BF9\u8C61\u3002
\u53C2\u6570SortBy\u662F\u53EF\u9009\u7684\uFF0C\u7528\u4E8E\u5BF9\u8FD4\u56DE\u7684\u6587\u4EF6\u8FDB\u884C\u6392\u5E8F\u3002
\u53C2\u6570SortOrder\u662F\u53EF\u9009\u7684\uFF0C\u8868\u660E\u6240\u8FD4\u56DE\u6587\u4EF6\u7684\u6392\u5E8F\u987A\u5E8F\u3002
\u53C2\u6570AlwaysAccurate\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u4E3A<span class="token boolean">True</span>\u4F7F\u6587\u4EF6\u641C\u7D22\u5305\u62EC\u4E0A\u6B21\u66F4\u65B0\u6587\u4EF6\u7D22\u5F15\u4EE5\u6765\u6DFB\u52A0\u3001\u4FEE\u6539\u6216\u5220\u9664\u7684\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u5728\u4F7F\u7528 Execute \u65B9\u6CD5\u641C\u7D22\u6587\u4EF6\u65F6\uFF0C\u5982\u679C\u6CA1\u6709\u627E\u5230\u6587\u4EF6\uFF0C\u5219\u8FD4\u56DE\u96F6 (0)\uFF0C\u5982\u679C\u627E\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\uFF0C\u5219\u8FD4\u56DE\u4E00\u4E2A\u6B63\u6570\u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u4F7F\u7528 For...Next \u8BED\u53E5\u904D\u5386 Execute \u65B9\u6CD5\u8FD4\u56DE\u7684\u8FD4\u56DE\u7684\u6587\u4EF6\u5217\u8868\u3002\u5E94\u7528\u4E8EFoundFiles\u5BF9\u8C61\u7684 FoundFiles \u5C5E\u6027\u8FD4\u56DE\u4E00\u4E2A FoundFiles \u5BF9\u8C61\uFF0C\u4EE3\u8868\u7531\u6587\u4EF6\u641C\u7D22\u8FC7\u7A0B\u4E2D\u8FD4\u56DE\u7684\u6587\u4EF6\u5217\u8868\u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\u5224\u65AD\u8FD4\u56DE\u7684\u5355\u4E2A FoundFiles \u5BF9\u8C61\u7684\u540D\u79F0\u662F\u5426\u662F\u793A\u4F8B\u6587\u4EF6\u7684\u540D\u79F0\uFF0C\u5982\u679C\u5426\u5219\u6267\u884C\u540E\u7EED\u4EE3\u7801\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u4F7F\u7528\u5E94\u7528\u4E8E Workbooks \u5BF9\u8C61\u7684 Open \u65B9\u6CD5\u6253\u5F00\u7531\u8FD4\u56DE\u7684\u5355\u4E2A FoundFiles \u5BF9\u8C61\u4EE3\u8868\u7684\u5DE5\u4F5C\u7C3F\u3002</p><p>\u7B2C 11 \u884C\u5230\u7B2C 14 \u884C\u4EE3\u7801\u5728\u6253\u5F00\u7684\u6D3B\u52A8\u5DE5\u4F5C\u7C3F\u7684\u5DE5\u4F5C\u8868\u4E2D\u5199\u5165\u6253\u5F00\u65F6\u95F4\u540E\u4FDD\u5B58\u3001\u5173\u95ED\u6D3B\u52A8\u5DE5\u4F5C\u7C3F\u3002</p><p>\u8FD0\u884C Sort \u8FC7\u7A0B\u5C06\u6253\u5F00\u793A\u4F8B\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u6240\u6709\u7684 Excel \u6587\u4EF6\u5E76\u5BF9\u5176\u8FDB\u884C\u76F8\u5E94\u7684\u64CD\u4F5C\u3002</p><h2 id="_180\u3001\u4F7F\u7528-wsh-\u5904\u7406\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_180\u3001\u4F7F\u7528-wsh-\u5904\u7406\u6587\u4EF6" aria-hidden="true">#</a> 180\u3001\u4F7F\u7528 WSH \u5904\u7406\u6587\u4EF6</h2><p>Windows Scripting Hos\uFF08WSH\uFF09\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E9B\u63A7\u5236 Windows \u64CD\u4F5C\u7CFB\u7EDF\u548C\u5E94\u7528\u7A0B\u5E8F\u4EE5\u53CA\u4ECE\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u83B7\u53D6\u4FE1\u606F\u7684\u5C0F\u7A0B\u5E8F\uFF0C\u800C\u4F7F\u7528 WSH \u7684 FileSystemObject \u5BF9\u8C61\u53EF\u4EE5\u7528\u6765\u5904\u7406\u6587\u4EF6\u7CFB\u7EDF\u3002</p><p>\u5728\u4F7F\u7528 WSH \u5904\u7406\u6587\u4EF6\u65F6\uFF0C\u5FC5\u9700\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA\u4E00\u4E2A ActiveX \u5BF9\u8C61\uFF08FileSystemObject \u5BF9\u8C61\uFF09\uFF0C\u7528\u6765\u63D0\u4F9B\u8BBF\u95EE\u8BA1\u7B97\u673A\u7684\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4E0A\u9762\u7684\u4EE3\u7801\u9996\u5148\u58F0\u660E\u4E00\u4E2A\u540D\u4E3A MyFile \u7684\u5BF9\u8C61\u53D8\u91CF\uFF0C\u7136\u540E\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA\u4E00\u4E2A ActiveX \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u5BF9\u8C61\u53D8\u91CF\u3002</p><p>CreateObject \u51FD\u6570\u521B\u5EFA\u5E76\u8FD4\u56DE\u4E00\u4E2A\u5BF9 ActiveX \u5BF9\u8C61\u7684\u5F15\u7528\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>CreateObject<span class="token punctuation">(</span><span class="token keyword">class</span><span class="token punctuation">,</span>[servername]<span class="token punctuation">)</span>

\u5176\u4E2D\u53C2\u6570<span class="token keyword">class</span>\u662F\u5FC5\u9700\u7684\uFF0C\u8981\u521B\u5EFA\u7684\u5E94\u7528\u7A0B\u5E8F\u540D\u79F0\u548C\u7C7B\uFF0C\u4F7F\u7528appname<span class="token punctuation">.</span>objecttype\u8FD9\u79CD\u8BED\u6CD5\uFF0Cappname\u6307\u5B9A\u8BE5\u5BF9\u8C61\u7684\u5E94\u7528\u7A0B\u5E8F\u540D\u79F0\uFF0Cobjecttype\u6307\u5B9A\u8BE5\u5BF9\u8C61\u7684\u7C7B\u578B\u6216\u7C7B\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5728\u58F0\u660E\u4E86\u5BF9\u8C61\u53D8\u91CF MyFile \u4E3A Windows Scripting \u5E93\u7684 FileSystemObject \u5BF9\u8C61\u540E\u5C31\u80FD\u4F7F\u7528\u8BE5\u5BF9\u8C61\u7684\u5C5E\u6027\u3001\u65B9\u6CD5\u6765\u5904\u7406\u6587\u4EF6\u7CFB\u7EDF\u3002</p><h3 id="_1-\u83B7\u53D6\u6587\u4EF6\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#_1-\u83B7\u53D6\u6587\u4EF6\u4FE1\u606F" aria-hidden="true">#</a> 1\uFF09\u83B7\u53D6\u6587\u4EF6\u4FE1\u606F</h3><p>\u5982\u679C\u9700\u8981\u83B7\u5F97\u6307\u5B9A\u6587\u4EF6\u7684\u4FE1\u606F\uFF0C\u53EF\u4EE5\u4F7F\u7528 File \u5BF9\u8C61\u7684 Getfile \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Fileinfo<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> Str <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> StrMsg <span class="token keyword">As</span> <span class="token keyword">String</span>
	Str <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> MyFile<span class="token punctuation">.</span>Getfile<span class="token punctuation">(</span>Str<span class="token punctuation">)</span>
		StrMsg <span class="token operator">=</span> StrMsg <span class="token operator">&amp;</span> <span class="token string">&quot;\u6587\u4EF6\u540D\u79F0\uFF1A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">_</span>
			<span class="token operator">&amp;</span> <span class="token string">&quot;\u6587\u4EF6\u521B\u5EFA\u65E5\u671F\uFF1A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>DateCreated <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">_</span>
			<span class="token operator">&amp;</span> <span class="token string">&quot;\u6587\u4EF6\u4FEE\u6539\u65E5\u671F\uFF1A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>DateLastModified <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">_</span>
			<span class="token operator">&amp;</span> <span class="token string">&quot;\u6587\u4EF6\u8BBF\u95EE\u65E5\u671F\uFF1A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>DateLastAccessed <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">_</span>
			<span class="token operator">&amp;</span> <span class="token string">&quot;\u6587\u4EF6\u4FDD\u5B58\u8DEF\u5F84\uFF1A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>ParentFolder
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	MsgBox StrMsg
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Fileinfo \u8FC7\u7A0B\u4F7F\u7528 Getfile \u65B9\u6CD5\u83B7\u53D6\u793A\u4F8B\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u7684\u4FE1\u606F\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u5C06\u6587\u4EF6\u8DEF\u5F84\u540D\u79F0\u8D4B\u7ED9\u53D8\u91CF Str\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u4F7F\u7528 Getfile \u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A File \u5BF9\u8C61\u3002Getfile \u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u548C\u6307\u5B9A\u8DEF\u5F84\u4E2D\u6587\u4EF6\u76F8\u5BF9\u5E94\u7684 File \u5BF9\u8C61\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>GetFile<span class="token punctuation">(</span>filespec<span class="token punctuation">)</span>

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0CFileSystemObject\u5BF9\u8C61\u7684\u540D\u79F0\u3002
\u53C2\u6570filespec\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u5B9A\u6587\u4EF6\u7684\u8DEF\u5F84\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 8 \u884C\u5230\u7B2C 12 \u884C\u4EE3\u7801\u6839\u636E File \u5BF9\u8C61\u7684\u5C5E\u6027\u53D6\u5F97\u6587\u4EF6\u4FE1\u606F\uFF0CFile \u5BF9\u8C61\u7684\u5E38\u7528\u5C5E\u6027\u5982\u8868\u683C 180-1 \u6240\u793A\u3002</p><p><u>\u8868\u683C 180-1</u> File \u5BF9\u8C61\u7684\u5E38\u7528\u5C5E\u6027</p><table><thead><tr><th>\u5C5E\u6027</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>Name</td><td>\u6587\u4EF6\u540D\u79F0</td></tr><tr><td>DateCreated</td><td>\u6587\u4EF6\u521B\u5EFA\u65E5\u671F</td></tr><tr><td>DateLastModified</td><td>\u6587\u4EF6\u6700\u540E\u4FEE\u6539\u65E5\u671F</td></tr><tr><td>DateLastAccessed</td><td>\u6587\u4EF6\u6700\u540E\u8BBF\u95EE\u65E5\u671F</td></tr><tr><td>ParentFolder</td><td>\u6587\u4EF6\u7684\u7236\u6587\u4EF6\u5939</td></tr><tr><td>Path</td><td>\u6587\u4EF6\u7684\u5B8C\u6574\u8DEF\u5F84</td></tr><tr><td>Type</td><td>\u6587\u4EF6\u7C7B\u578B</td></tr><tr><td>Size</td><td>\u4EE5\u5B57\u8282\u8868\u793A\u7684\u6587\u4EF6\u5927\u5C0F</td></tr></tbody></table><p>\u8FD0\u884C Fileinfo \u8FC7\u7A0B\u4F7F\u7528\u6D88\u606F\u6846\u663E\u793A\u201C123.xls\u201D\u6587\u4EF6\u7684\u4FE1\u606F\uFF0C\u5982\u56FE 180-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+t+`" alt="" loading="lazy"></p><p><u>\u56FE 180-1</u> \u83B7\u53D6\u6587\u4EF6\u4FE1\u606F</p></div><h3 id="_2-\u67E5\u627E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-\u67E5\u627E\u6587\u4EF6" aria-hidden="true">#</a> 2\uFF09\u67E5\u627E\u6587\u4EF6</h3><p>\u4F7F\u7528 FileSystemObject \u5BF9\u8C61\u7684 FileExists \u65B9\u6CD5\u53EF\u4EE5\u67E5\u627E\u6307\u5B9A\u7684\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> FileExis<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> Str <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> StrMsg <span class="token keyword">As</span> <span class="token keyword">String</span>
	Str <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">If</span> MyFile<span class="token punctuation">.</span>FileExists<span class="token punctuation">(</span>Str<span class="token punctuation">)</span> <span class="token keyword">Then</span>
		MsgBox <span class="token string">&quot;\u6587\u4EF6\u5DF2\u627E\u5230!&quot;</span>
	<span class="token keyword">Else</span>
		MsgBox <span class="token string">&quot;\u6587\u4EF6\u4E0D\u5B58\u5728!&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>FileExis \u8FC7\u7A0B\u4F7F\u7528 FileExists \u65B9\u6CD5\u67E5\u627E\u793A\u4F8B\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u662F\u5426\u5B58\u5728\u201C123.xls\u201D\u6587\u4EF6\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u4F7F\u7528 FileExists \u65B9\u6CD5\u53EF\u4EE5\u67E5\u627E\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 FileExists \u65B9\u6CD5\u67E5\u627E\u6307\u5B9A\u7684\u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>FileExists<span class="token punctuation">(</span>filespec<span class="token punctuation">)</span>

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0CFileSystemObject\u5BF9\u8C61\u7684\u540D\u79F0\u3002
\u53C2\u6570filespec\u662F\u5FC5\u9700\u7684\uFF0C\u8981\u786E\u5B9A\u662F\u5426\u5B58\u5728\u7684\u6587\u4EF6\u7684\u540D\u5B57\u3002\u5982\u679C\u6587\u4EF6\u4E0D\u5728\u5F53\u524D\u6587\u4EF6\u5939\u4E2D\uFF0C\u5FC5\u987B\u63D0\u4F9B\u4E00\u4E2A\u5B8C\u6574\u7684\u8DEF\u5F84\u8BF4\u660E\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4F7F\u7528 FileExists \u65B9\u6CD5\u67E5\u627E\u6587\u4EF6\u65F6\u5982\u679C\u6307\u5B9A\u7684\u6587\u4EF6\u5B58\u5728\uFF0C\u8FD4\u56DE True\uFF0C\u82E5\u4E0D\u5B58\u5728\uFF0C\u5219\u8FD4\u56DE False\uFF0C\u6839\u636E\u8FD4\u56DE\u503C\u53EF\u4EE5\u786E\u5B9A\u6240\u8981\u67E5\u627E\u7684\u6587\u4EF6\u662F\u5426\u5B58\u5728\u3002</p><h3 id="_3-\u79FB\u52A8\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_3-\u79FB\u52A8\u6587\u4EF6" aria-hidden="true">#</a> 3\uFF09\u79FB\u52A8\u6587\u4EF6</h3><p>\u5982\u679C\u9700\u8981\u628A\u6587\u4EF6\u4ECE\u4E00\u4E2A\u5730\u65B9\u79FB\u52A8\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u53EF\u4EE5\u4F7F\u7528 FileSystemObject \u5BF9\u8C61\u7684 MoveFile \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> MoveFile<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>MoveFile ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span><span class="token punctuation">,</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC\\&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>MoveFile \u8FC7\u7A0B\u4F7F\u7528 MoveFile \u65B9\u6CD5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u79FB\u52A8\u5230\u201CABC\u201D\u6587\u4EF6\u5939\u4E2D\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 MoveFile \u65B9\u6CD5\u79FB\u52A8\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 MoveFile \u65B9\u6CD5\u5C06\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u4ECE\u4E00\u4E2A\u5730\u65B9\u79FB\u52A8\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>MoveFile source<span class="token punctuation">,</span> destination 

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u79F0\u3002
\u53C2\u6570source\u662F\u5FC5\u9700\u7684\uFF0C\u4E00\u4E2A\u6216\u591A\u4E2A\u8981\u79FB\u52A8\u6587\u4EF6\u7684\u8DEF\u5F84\uFF0Csource\u53C2\u6570\u5B57\u7B26\u4E32\u5728\u8DEF\u5F84\u7684\u6700\u540E\u90E8\u4EF6\u4E2D\u53EF\u4EE5\u4F7F\u7528\u901A\u914D\u7B26\u3002
\u53C2\u6570destinatio\u662F\u5FC5\u9700\u7684\uFF0C\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u8981\u79FB\u52A8\u5230\u7684\u76EE\u6807\u8DEF\u5F84\uFF0C\u4E0D\u80FD\u4F7F\u7528\u901A\u914D\u7B26\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u8FD0\u884C MoveFile \u8FC7\u7A0B\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u79FB\u52A8\u5230\u540C\u4E00\u76EE\u5F55\u4E2D\u7684\u201CABC\u201D\u6587\u4EF6\u5939\u3002</p><h3 id="_4-\u590D\u5236\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_4-\u590D\u5236\u6587\u4EF6" aria-hidden="true">#</a> 4\uFF09\u590D\u5236\u6587\u4EF6</h3><p>\u5982\u679C\u9700\u8981\u628A\u6587\u4EF6\u4ECE\u4E00\u4E2A\u5730\u65B9\u590D\u5236\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u53EF\u4EE5\u4F7F\u7528 CopyFile \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CopyFile<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>CopyFile ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span><span class="token punctuation">,</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC\\&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>CopyFile \u8FC7\u7A0B\u4F7F\u7528 CopyFile \u65B9\u6CD5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u590D\u5236\u5230\u201CABC\u201D\u6587\u4EF6\u5939\u4E2D\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 CopyFile \u65B9\u6CD5\u590D\u5236\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 CopyFile \u65B9\u6CD5\u628A\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u4ECE\u4E00\u4E2A\u5730\u65B9\u590D\u5236\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>CopyFile source<span class="token punctuation">,</span> destination[<span class="token punctuation">,</span> overwrite]

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570source\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u4E00\u4E2A\u6216\u591A\u4E2A\u8981\u88AB\u590D\u5236\u6587\u4EF6\u7684\u5B57\u7B26\u4E32\u6587\u4EF6\u8BF4\u660E\uFF0C\u53EF\u4EE5\u5305\u62EC\u901A\u914D\u7B26\u3002
\u53C2\u6570destination\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u53C2\u6570source\u4E2D\u7684\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u8981\u88AB\u590D\u5236\u5230\u7684\u63A5\u53D7\u7AEF\u7684\u5B57\u7B26\u4E32\uFF0C\u4E0D\u5141\u8BB8\u6709\u901A\u914D\u7B26\u3002
\u53C2\u6570overwrite\u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u5B58\u5728\u7684\u6587\u4EF6\u662F\u5426\u88AB\u8986\u76D6\u3002\u5982\u679C\u662F<span class="token boolean">True</span>\uFF0C\u6587\u4EF6\u5C06\u88AB\u8986\u76D6\uFF1B\u5982\u679C\u662F<span class="token boolean">False</span>\uFF0C\u5B83\u4EEC\u4E0D\u88AB\u8986\u76D6\uFF0C\u7F3A\u7701\u503C\u662F<span class="token boolean">True</span>\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u5982\u679C\u53C2\u6570 destination \u6307\u5B9A\u7684\u63A5\u53D7\u7AEF\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\u8BBE\u7F6E\uFF0C\u4E0D\u8BBA\u53C2\u6570 overwrite \u7684\u503C\u5982\u4F55\u8BBE\u7F6E\uFF0CCopyFile \u65B9\u6CD5\u90FD\u5C06\u5931\u8D25\u3002</p></div><p>\u8FD0\u884C CopyFile \u8FC7\u7A0B\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u590D\u5236\u5230\u201CABC\u201D\u6587\u4EF6\u5939\u4E2D\u3002</p><h3 id="_5-\u5220\u9664\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5-\u5220\u9664\u6587\u4EF6" aria-hidden="true">#</a> 5\uFF09\u5220\u9664\u6587\u4EF6</h3><p>\u5982\u679C\u9700\u8981\u5220\u9664\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\uFF0C\u53EF\u4EE5\u4F7F\u7528 DeleteFile \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DelFile<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>DeleteFile ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123.xls&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>DelFile \u8FC7\u7A0B\u4F7F DeleteFile \u65B9\u6CD5\u5220\u9664\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 DeleteFile \u65B9\u6CD5\u590D\u5236\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 DeleteFile \u65B9\u6CD5\u5220\u9664\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>DeleteFile filespec[<span class="token punctuation">,</span> force]

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570filespec\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u8981\u5220\u9664\u6587\u4EF6\u7684\u540D\u5B57\uFF0C\u53EF\u4EE5\u5728\u6700\u540E\u7684\u8DEF\u5F84\u90E8\u4EF6\u4E2D\u5305\u542B\u901A\u914D\u7B26\u3002
\u53C2\u6570force\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u8981\u5220\u9664\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\u8BBE\u7F6E\u7684\u6587\u4EF6\uFF0C\u5176\u503C\u4E3A<span class="token boolean">True</span>\u3002\u5982\u679C\u5176\u503C\u4E3A<span class="token boolean">False</span>\uFF08\u7F3A\u7701\uFF09\uFF0C\u5219\u4E0D\u80FD\u5220\u9664\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\u8BBE\u7F6E\u7684\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u8FD0\u884C DelFile \u8FC7\u7A0B\u5220\u9664\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u3002</p><h3 id="_6-\u521B\u5EFA\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_6-\u521B\u5EFA\u6587\u4EF6\u5939" aria-hidden="true">#</a> 6\uFF09\u521B\u5EFA\u6587\u4EF6\u5939</h3><p>\u5982\u679C\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\u5939\uFF0C\u53EF\u4EE5\u4F7F\u7528 CreateFolder \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>CreateFolder <span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>CreFolder \u8FC7\u7A0B\u4F7F CreateFolder \u65B9\u6CD5\u5728\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u4E00\u4E2A\u201CABC\u201D\u6587\u4EF6\u5939\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 CreateFolder \u65B9\u6CD5\u521B\u5EFA\u6587\u4EF6\u5939\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 CreateFolder \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\u5939\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>CreateFolder<span class="token punctuation">(</span>foldername<span class="token punctuation">)</span>

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570foldername\u662F\u5FC5\u9700\u7684\uFF0C\u5B57\u7B26\u4E32\u8868\u8FBE\u5F0F\uFF0C\u6307\u660E\u8981\u521B\u5EFA\u6587\u4EF6\u5939\u7684\u540D\u79F0\u548C\u8DEF\u5F84\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u8FD0\u884C CreFolder \u8FC7\u7A0B\u5C06\u5728\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u4E00\u4E2A\u201CABC\u201D\u6587\u4EF6\u5939\u3002</p><h3 id="_7-\u590D\u5236\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_7-\u590D\u5236\u6587\u4EF6\u5939" aria-hidden="true">#</a> 7\uFF09\u590D\u5236\u6587\u4EF6\u5939</h3><p>\u5982\u679C\u9700\u8981\u590D\u5236\u6587\u4EF6\u5939\uFF0C\u53EF\u4EE5\u4F7F\u7528 CopyFolder \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CopyFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>CopyFolder ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\ABC&quot;</span><span class="token punctuation">,</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>CopyFolder \u8FC7\u7A0B\u4F7F CopyFolder \u65B9\u6CD5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201CABC\u201D\u6587\u4EF6\u5939\u590D\u5236\u5E76\u6539\u540D\u4E3A\u201C123\u201D\u6587\u4EF6\u5939\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CopyFolder \u65B9\u6CD5\u590D\u5236\u6587\u4EF6\u5939\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 CreateObject \u65B9\u6CD5\u4ECE\u4E00\u4E2A\u5730\u65B9\u9012\u5F52\u5730\u590D\u5236\u4E00\u4E2A\u6587\u4EF6\u5939\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>CopyFolder source<span class="token punctuation">,</span> destination[<span class="token punctuation">,</span> overwrite]

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570source\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u4E00\u4E2A\u6216\u591A\u4E2A\u88AB\u590D\u5236\u6587\u4EF6\u5939\u7684\u5B57\u7B26\u4E32\u6587\u4EF6\u5939\u8BF4\u660E\uFF0C\u53EF\u4EE5\u5305\u62EC\u901A\u914D\u7B26\u3002
\u53C2\u6570destination\u662F\u5FC5\u9700\u7684\uFF0C\u88AB\u590D\u5236\u6587\u4EF6\u5939\u548C\u5B50\u6587\u4EF6\u5939\u7684\u63A5\u53D7\u7AEF\u7684\u5B57\u7B26\u4E32\uFF0C\u4E0D\u5141\u8BB8\u6709\u901A\u914D\u7B26\u3002
\u53C2\u6570overwrite\u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u5DF2\u5B58\u5728\u7684\u6587\u4EF6\u5939\u662F\u5426\u88AB\u8986\u76D6\u3002\u5982\u679C\u4E3A<span class="token boolean">True</span>\uFF0C\u6587\u4EF6\u88AB\u8986\u76D6\uFF0C\u5982\u679C\u4E3A<span class="token boolean">False</span>\uFF0C\u6587\u4EF6\u4E0D\u88AB\u8986\u76D6\u3002\u7F3A\u7701\u503C\u4E3A<span class="token boolean">True</span>\u3002
\u5982\u679C\u53C2\u6570source\u4E2D\u5305\u542B\u901A\u914D\u7B26\u6216\u53C2\u6570destination\u4EE5\u8DEF\u5F84\u5206\u9694\u7B26\uFF08<span class="token operator">\\</span>\uFF09\u4E3A\u7ED3\u5C3E\uFF0C\u5219\u8BA4\u4E3A\u53C2\u6570destination\u662F\u4E00\u4E2A\u5DF2\u5B58\u5728\u7684\u6587\u4EF6\u5939\uFF0C\u5728\u5176\u4E2D\u590D\u5236\u76F8\u5339\u914D\u7684\u6587\u4EF6\u5939\u548C\u5B50\u6587\u4EF6\u5939\u3002\u5426\u5219\u8BA4\u4E3A\u53C2\u6570destination\u662F\u4E00\u4E2A\u8981\u521B\u5EFA\u7684\u6587\u4EF6\u5939\u7684\u540D\u5B57\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u8FD0\u884C CopyFolder \u8FC7\u7A0B\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201CABC\u201D\u6587\u4EF6\u5939\u590D\u5236\u5E76\u6539\u540D\u4E3A\u201C123\u201D\u6587\u4EF6\u5939\u3002</p><h3 id="_8-\u79FB\u52A8\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_8-\u79FB\u52A8\u6587\u4EF6\u5939" aria-hidden="true">#</a> 8\uFF09\u79FB\u52A8\u6587\u4EF6\u5939</h3><p>\u5982\u679C\u9700\u8981\u79FB\u52A8\u6587\u4EF6\u5939\uFF0C\u53EF\u4EE5\u4F7F\u7528 MoveFolder \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> MoveFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>MoveFolder ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;F:\\123&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>MoveFolder \u8FC7\u7A0B\u4F7F MoveFolder \u65B9\u6CD5\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123\u201D\u6587\u4EF6\u5939\u79FB\u52A8\u5230F\u76D8\u4E2D\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F MoveFolder \u65B9\u6CD5\u79FB\u52A8\u6587\u4EF6\u5939\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 MoveFolder \u65B9\u6CD5\u5C06\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u5939\u4ECE\u4E00\u4E2A\u5730\u65B9\u79FB\u52A8\u5230\u53E6\u4E00\u4E2A\u5730\u65B9\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>MoveFolder source<span class="token punctuation">,</span> destination

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570source\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u4E00\u4E2A\u6216\u591A\u4E2A\u8981\u79FB\u52A8\u6587\u4EF6\u5939\u7684\u5B57\u7B26\u4E32\u6587\u4EF6\u5939\u8BF4\u660E\uFF0C\u5728\u8DEF\u5F84\u7684\u6700\u540E\u90E8\u4EF6\u4E2D\u53EF\u4EE5\u5305\u62EC\u901A\u914D\u7B26\u3002
\u53C2\u6570destination\u662F\u5FC5\u9700\u7684\uFF0C\u4E00\u4E2A\u6216\u591A\u4E2A\u6587\u4EF6\u5939\u8981\u79FB\u52A8\u5230\u7684\u76EE\u6807\u8DEF\u5F84\uFF0C\u4E0D\u80FD\u5305\u542B\u901A\u914D\u7B26\u3002
\u5982\u679C\u53C2\u6570source\u4E2D\u5305\u542B\u901A\u914D\u7B26\u6216\u53C2\u6570destination\u4EE5\u8DEF\u5F84\u5206\u9694\u7B26\uFF08<span class="token operator">\\</span>\uFF09\u4E3A\u7ED3\u5C3E\uFF0C\u5219\u8BA4\u4E3A\u53C2\u6570destination\u662F\u4E00\u4E2A\u5DF2\u5B58\u5728\u7684\u6587\u4EF6\u5939\uFF0C\u5728\u6B64\u6587\u4EF6\u5939\u4E2D\u79FB\u52A8\u76F8\u5339\u914D\u7684\u6587\u4EF6\u3002\u5426\u5219\u8BA4\u4E3A\u53C2\u6570destination\u662F\u4E00\u4E2A\u8981\u521B\u5EFA\u7684\u6587\u4EF6\u5939\u7684\u540D\u5B57\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u8FD0\u884C MoveFolder \u8FC7\u7A0B\u5C06\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123\u201D\u6587\u4EF6\u5939\u79FB\u52A8\u5230F\u76D8\u4E2D\u3002</p><h3 id="_9-\u5220\u9664\u6587\u4EF6\u5939" tabindex="-1"><a class="header-anchor" href="#_9-\u5220\u9664\u6587\u4EF6\u5939" aria-hidden="true">#</a> 9\uFF09\u5220\u9664\u6587\u4EF6\u5939</h3><p>\u5982\u679C\u9700\u8981\u5220\u9664\u4E00\u4E2A\u6587\u4EF6\u5939\uFF0C\u53EF\u4EE5\u4F7F\u7528 DeleteFolder \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DelFolder<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
	MyFile<span class="token punctuation">.</span>DeleteFolder ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\123&quot;</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>DelFolder \u8FC7\u7A0B\u4F7F DeleteFolder \u65B9\u6CD5\u5220\u9664\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123\u201D\u6587\u4EF6\u5939\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 DeleteFolder \u65B9\u6CD5\u5220\u9664\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 DeleteFolder \u65B9\u6CD5\u5220\u9664\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\u5939\u548C\u5176\u4E2D\u7684\u5185\u5BB9\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>object.DeleteFolder folderspec[, force]

\u53C2\u6570object\u662F\u5FC5\u9700\u7684\uFF0C FileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570filespec\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u660E\u8981\u5220\u9664\u7684\u6587\u4EF6\u5939\u7684\u540D\u79F0\uFF0C\u53EF\u4EE5\u5728\u6700\u540E\u7684\u8DEF\u5F84\u90E8\u4EF6\u4E2D\u5305\u542B\u901A\u914D\u7B26\u3002
\u53C2\u6570force\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u8981\u5220\u9664\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\u8BBE\u7F6E\u7684\u6587\u4EF6\u5939\uFF0C\u5176\u503C\u4E3ATrue\u3002\u5982\u679C\u5176\u503C\u4E3AFalse\uFF08\u7F3A\u7701\uFF09\uFF0C\u5219\u4E0D\u80FD\u5220\u9664\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\u8BBE\u7F6E\u7684\u6587\u4EF6\u5939\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u8FD0\u884C DelFolder \u8FC7\u7A0B\u5220\u9664\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C123.xls\u201D\u6587\u4EF6\u5939\u3002</p><h3 id="_10-\u5BFC\u5165\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_10-\u5BFC\u5165\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 10\uFF09\u5BFC\u5165\u6587\u672C\u6587\u4EF6</h3><p>\u5982\u679C\u9700\u8981\u4ECE\u6587\u672C\u6587\u4EF6\u4E2D\u5BFC\u5165\u6570\u636E\uFF0C\u53EF\u4EE5\u4F7F\u7528 OpenTextFile \u65B9\u6CD5\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> OpenText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> mArr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	j <span class="token operator">=</span> <span class="token number">1</span>
	Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>ClearContents
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span> <span class="token operator">_</span>
		<span class="token punctuation">.</span>OpenTextFile<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">Do</span> <span class="token keyword">While</span> <span class="token keyword">Not</span> MyFile<span class="token punctuation">.</span>AtEndOfStream
		mArr <span class="token operator">=</span> Split<span class="token punctuation">(</span>MyFile<span class="token punctuation">.</span>ReadLine<span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>mArr<span class="token punctuation">)</span>
			Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>j<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> mArr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">Next</span>
		j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>
	<span class="token keyword">Loop</span>
	MyFile<span class="token punctuation">.</span>Close
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>OpenText \u8FC7\u7A0B\u4F7F\u7528 OpenTextFile \u65B9\u6CD5\u6253\u5F00\u793A\u4F8B\u6587\u4EF6\u6240\u5728\u6587\u4EF6\u5939\u4E2D\u7684\u201C\u5DE5\u8D44\u8868.txt\u201D\u6587\u4EF6\u5E76\u5C06\u6570\u636E\u5BFC\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><p>\u7B2C 7\u30018 \u884C\u4EE3\u7801\u4F7F\u7528 OpenTextFile \u65B9\u6CD5\u6253\u5F00\u6587\u672C\u6587\u4EF6\u3002\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 OpenTextFile \u65B9\u6CD5\u6253\u5F00\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\u5E76\u8FD4\u56DE\u4E00\u4E2A TextStream \u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u53EF\u7528\u4E8E\u5BF9\u6587\u4EF6\u8FDB\u884C\u8BFB\u64CD\u4F5C\u6216\u8FFD\u52A0\u64CD\u4F5C\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>object.OpenTextFile(filename[, iomode[, create[, format]]])

\u53C2\u6570object\u662F\u5FC5\u9700\u7684\uFF0CFileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570filename\u662F\u5FC5\u9700\u7684\uFF0C\u9700\u8981\u6253\u5F00\u7684\u6587\u4EF6\u540D\u79F0\u3002
\u53C2\u6570iomode\u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u8F93\u5165/\u8F93\u51FA\u65B9\u5F0F\uFF0C\u8BBE\u7F6E\u503C\u5982\u8868\u683C180-2\u6240\u793A\u3002
\u53C2\u6570create\u662F\u53EF\u9009\u7684\uFF0C\u5B83\u8868\u793A\u5982\u679C\u6307\u5B9A\u7684\u53C2\u6570filename\u4E0D\u5B58\u5728\u662F\u5426\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u65B0\u6587\u4EF6\u3002\u5982\u679C\u521B\u5EFA\u65B0\u6587\u4EF6\uFF0C\u5176\u503C\u4E3ATrue\u3002\u82E5\u4E0D\u521B\u5EFA\u6587\u4EF6\u5176\u503C\u4E3AFalse\u3002\u7F3A\u7701\u503C\u4E3AFalse\u3002
\u53C2\u6570format\u662F\u53EF\u9009\u7684\uFF0C\u6253\u5F00\u6587\u4EF6\u7684\u683C\u5F0F\uFF0C\u8BBE\u7F6E\u503C\u5982\u8868\u683C180-3\u6240\u793A\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><u>\u8868\u683C 180-2</u> iomode \u53C2\u6570\u8BBE\u7F6E\u503C</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>ForReading</td><td>1</td><td>\u6253\u5F00\u4E00\u4E2A\u53EA\u8BFB\u6587\u4EF6\uFF0C\u4E0D\u80FD\u5BF9\u6B64\u6587\u4EF6\u8FDB\u884C\u5199\u64CD\u4F5C\u3002</td></tr><tr><td>ForAppending</td><td>8</td><td>\u6253\u5F00\u4E00\u4E2A\u6587\u4EF6\u5E76\u5199\u5230\u6587\u4EF6\u7684\u5C3E\u90E8\u3002</td></tr></tbody></table><p><u>\u8868\u683C 180-3</u> format \u53C2\u6570\u8BBE\u7F6E\u503C</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>TristateUseDefault</td><td>-2</td><td>\u4F7F\u7528\u7CFB\u7EDF\u7F3A\u7701\u6253\u5F00\u6587\u4EF6</td></tr><tr><td>TristateTrue</td><td>-1</td><td>\u4EE5 Unicode \u683C\u5F0F\u6253\u5F00\u6587\u4EF6</td></tr><tr><td>TristateFalse</td><td>0</td><td>\u4EE5 ASCII \u683C\u5F0F\u6253\u5F00\u6587\u4EF6</td></tr></tbody></table><p>\u7B2C 9 \u884C\u4EE3\u7801\u5F00\u59CB\u5BF9\u6587\u672C\u6587\u4EF6\u8FDB\u884C\u8BFB\u64CD\u4F5C\u3002\u5E94\u7528\u4E8E TextStream \u5BF9\u8C61\u7684 AtEndOfStream \u5C5E\u6027\u6307\u793A\u6587\u4EF6\u6307\u9488\u662F\u5426\u4F4D\u4E8E TextStream \u6587\u4EF6\u4E2D\u7684\u7ED3\u5C3E\uFF0C\u5982\u679C\u662F\u8FD4\u56DE True\uFF0C\u5426\u5219\u8FD4\u56DE False\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u4F7F\u7528 Split \u51FD\u6570\u5C06\u9010\u884C\u8BFB\u53D6\u7684\u5B57\u7B26\u4E32\u4EE5\u9017\u53F7\u8FDB\u884C\u5206\u9694\u540E\u8D4B\u7ED9\u6570\u7EC4 mArr\u3002\u5173\u4E8E Split \u51FD\u6570\u8BF7\u53C2\u9605 169-2\u3002</p><p>\u5E94\u7528\u4E8E TextStream \u5BF9\u8C61\u7684 ReadLine \u65B9\u6CD5\u4ECE\u4E00\u4E2A TextStream \u6587\u4EF6\u8BFB\u53D6\u4E00\u6574\u884C\uFF08\u5230\u6362\u884C\u7B26\u4F46\u4E0D\u5305\u62EC\u6362\u884C\u7B26\uFF09\u5E76\u8FD4\u56DE\u5F97\u5230\u7684\u5B57\u7B26\u4E32\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>ReadLine

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0CTextStream\u5BF9\u8C61\u7684\u540D\u5B57\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 11 \u884C\u5230\u7B2C 14 \u884C\u4EE3\u7801\u5C06\u6570\u7EC4\u5143\u7D20\u5199\u5165\u5230\u5DE5\u4F5C\u8868\u7684\u5355\u5143\u683C\u3002</p><p>\u7B2C 15 \u884C\u4EE3\u7801\u91CD\u65B0\u8BFB\u53D6\u4E0B\u4E00\u884C\u6570\u636E\u3002</p><p>\u7B2C 16 \u884C\u4F7F\u7528 Close \u65B9\u6CD5\u5173\u95ED\u6253\u5F00\u7684\u6587\u672C\u6587\u4EF6\u3002</p><p>\u8FD0\u884C OpenText \u8FC7\u7A0B\u5C06\u201C\u5DE5\u8D44\u8868.txt\u201D\u6587\u4EF6\u7684\u6570\u636E\u5BFC\u5165\u5230\u5DE5\u4F5C\u8868\u4E2D\u3002</p><h3 id="_11-\u521B\u5EFA\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_11-\u521B\u5EFA\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 11\uFF09\u521B\u5EFA\u6587\u672C\u6587\u4EF6</h3><p>\u5982\u679C\u9700\u8981\u5C06\u5DE5\u4F5C\u8868\u4E2D\u7684\u6570\u636E\u4FDD\u5B58\u4E3A\u6587\u672C\u6587\u4EF6\uFF0C\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u6587\u672C\u6587\u4EF6\u7528\u4E8E\u4FDD\u5B58\u6570\u636E\u3002</p><p>\u4F7F\u7528 CreateTextFile \u65B9\u6CD5\u521B\u5EFA\u6587\u672C\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> myStr <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span> <span class="token operator">_</span>
		<span class="token punctuation">.</span>CreateTextFile<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
			myStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
			<span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Range<span class="token punctuation">(</span><span class="token string">&quot;IV&quot;</span><span class="token operator">&amp;</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlToLeft<span class="token punctuation">)</span><span class="token punctuation">.</span>Column
				myStr <span class="token operator">=</span> myStr <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,&quot;</span>
			<span class="token keyword">Next</span>
			myStr <span class="token operator">=</span> Left<span class="token punctuation">(</span>myStr<span class="token punctuation">,</span> <span class="token punctuation">(</span>Len<span class="token punctuation">(</span>myStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			MyFile<span class="token punctuation">.</span>WriteLine <span class="token punctuation">(</span>myStr<span class="token punctuation">)</span>
		<span class="token keyword">Next</span>
	MyFile<span class="token punctuation">.</span>Close
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>CreText \u8FC7\u7A0B\u4F7F CreateTextFile \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u6307\u5B9A\u540D\u79F0\u7684\u6587\u672C\u6587\u4EF6\u5E76\u5C06\u5DE5\u4F5C\u8868\u6570\u636E\u5199\u5165\u5230\u6587\u4EF6\u5185\u3002</p><p>\u7B2C 5\u30016 \u884C\u4EE3\u7801\u4F7F\u7528 CreateObject \u51FD\u6570\u521B\u5EFA FileSystemObject \u5BF9\u8C61\u5E76\u5C06\u8BE5\u5BF9\u8C61\u8D4B\u7ED9\u53D8\u91CF MyFile \u540E\u4F7F\u7528 CreateTextFile \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u6307\u5B9A\u540D\u79F0\u7684\u6587\u672C\u6587\u4EF6\u3002</p><p>\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 CreateTextFile \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\u5E76\u4E14\u8FD4\u56DE\u4E00\u4E2A\u7528\u4E8E\u8BE5\u6587\u4EF6\u8BFB\u5199\u7684 TextStream \u5BF9\u8C61\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>CreateTextFile<span class="token punctuation">(</span>filename[<span class="token punctuation">,</span> overwrite[<span class="token punctuation">,</span> unicode]]<span class="token punctuation">)</span>

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0CFileSystemObject\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570filename\u662F\u5FC5\u9700\u7684\uFF0C\u9700\u8981\u521B\u5EFA\u7684\u6587\u4EF6\u540D\u79F0\u3002
\u53C2\u6570overwrite\u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u662F\u5426\u8986\u76D6\u5DF2\u5B58\u5728\u6587\u4EF6\u3002\u5982\u679C\u53EF\u88AB\u8986\u76D6\u5176\u503C\u4E3A<span class="token boolean">True</span>\uFF0C\u5176\u503C\u4E3A<span class="token boolean">False</span>\u65F6\u4E0D\u80FD\u8986\u76D6\uFF0C\u5982\u679C\u7701\u7565\uFF0C\u5219\u5DF2\u5B58\u5728\u6587\u4EF6\u4E0D\u80FD\u8986\u76D6\u3002
\u53C2\u6570unicode\u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u6587\u4EF6\u662F\u4F5C\u4E3A\u4E00\u4E2AUnicode\u6587\u4EF6\u521B\u5EFA\u7684\u8FD8\u662F\u4F5C\u4E3A\u4E00\u4E2AASCII\u6587\u4EF6\u521B\u5EFA\u7684\u3002\u5982\u679C\u4F5C\u4E3A\u4E00\u4E2AUnicode\u6587\u4EF6\u521B\u5EFA\uFF0C\u5176\u503C\u4E3A<span class="token boolean">True</span>\uFF0C\u4F5C\u4E3A\u4E00\u4E2AASCII\u6587\u4EF6\u521B\u5EFA\uFF0C\u5176\u503C\u4E3A<span class="token boolean">False</span>\uFF0C\u5982\u679C\u7701\u7565\uFF0C\u5219\u8BA4\u4E3A\u662F\u4E00\u4E2AASCII\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u7B2C 7 \u884C\u4EE3\u7801\u9010\u884C\u8BFB\u53D6\u5DE5\u4F5C\u8868\u6570\u636E\u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u6E05\u7A7A\u5B57\u7B26\u4E32\u53D8\u91CF myStr \u7684\u5185\u5BB9\uFF0C\u7528\u6765\u4FDD\u5B58\u4E0B\u4E00\u884C\u7684\u6570\u636E\u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\u904D\u5386\u5F53\u524D\u884C\u7684\u6240\u6709\u5355\u5143\u683C\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u5C06\u5F53\u524D\u884C\u7684\u6240\u6709\u5355\u5143\u683C\u4FDD\u5B58\u5230\u5B57\u7B26\u4E32\u53D8\u91CF myStr \u4E2D\u5E76\u4EE5\u9017\u53F7\u8FDB\u884C\u5206\u9694\u3002</p><p>\u7B2C 12 \u884C\u4EE3\u7801\u53BB\u9664\u4FDD\u5B58\u5728\u5B57\u7B26\u4E32\u53D8\u91CF myStr \u4E2D\u5F53\u524D\u884C\u6570\u636E\u7684\u6700\u540E\u4E00\u4E2A\u9017\u53F7\u3002</p><p>\u7B2C 13 \u884C\u4EE3\u7801\u4F7F\u7528 WriteLine \u65B9\u6CD5\u5C06\u5F53\u524D\u884C\u6570\u636E\u5199\u5165\u5230\u521B\u5EFA\u7684\u6587\u672C\u6587\u4EF6\u3002</p><p>\u5E94\u7528\u4E8E TextStream \u5BF9\u8C61\u7684 WriteLine \u65B9\u6CD5\u5199\u5165\u4E00\u4E2A\u6307\u5B9A\u7684\u5B57\u7B26\u4E32\u548C\u6362\u884C\u7B26\u5230\u4E00\u4E2A TextStream \u6587\u4EF6\u4E2D\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">object</span><span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span>[<span class="token keyword">string</span>]<span class="token punctuation">)</span>

\u53C2\u6570<span class="token keyword">object</span>\u662F\u5FC5\u9700\u7684\uFF0CTextStream\u5BF9\u8C61\u7684\u540D\u5B57\u3002
\u53C2\u6570<span class="token keyword">string</span>\u662F\u53EF\u9009\u7684\uFF0C\u8981\u5199\u5165\u6587\u4EF6\u7684\u6B63\u6587\u3002\u5982\u679C\u7701\u7565\uFF0C\u5199\u5165\u4E00\u4E2A\u6362\u884C\u7B26\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 15 \u884C\u4F7F\u7528 Close \u65B9\u6CD5\u5173\u95ED\u6253\u5F00\u7684\u6587\u672C\u6587\u4EF6\u3002</p><p>\u8FD8\u53EF\u4EE5\u4F7F\u7528 OpenTextFile \u65B9\u6CD5\u521B\u5EFA\u6587\u672C\u6587\u4EF6\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> OpenText<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> myStr <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span> <span class="token operator">_</span>
		<span class="token punctuation">.</span>OpenTextFile<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\&quot;</span> <span class="token operator">&amp;</span> <span class="token string">&quot;\u5DE5\u8D44\u8868.txt&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
			myStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
			<span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Range<span class="token punctuation">(</span><span class="token string">&quot;IV&quot;</span> <span class="token operator">&amp;</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlToLeft<span class="token punctuation">)</span><span class="token punctuation">.</span>Column
				myStr <span class="token operator">=</span> myStr <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,&quot;</span>
			<span class="token keyword">Next</span>
			myStr <span class="token operator">=</span> Left<span class="token punctuation">(</span>myStr<span class="token punctuation">,</span> <span class="token punctuation">(</span>Len<span class="token punctuation">(</span>myStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			MyFile<span class="token punctuation">.</span>WriteLine <span class="token punctuation">(</span>myStr<span class="token punctuation">)</span>
		<span class="token keyword">Next</span>
	MyFile<span class="token punctuation">.</span>Close
	<span class="token keyword">Set</span> MyFile <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>OpenText \u8FC7\u7A0B\u4F7F OpenTextFile \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u6307\u5B9A\u540D\u79F0\u7684\u6587\u672C\u6587\u4EF6\u5E76\u5C06\u5DE5\u4F5C\u8868\u6570\u636E\u5199\u5165\u5230\u6587\u4EF6\u5185\u3002</p><p>\u5E94\u7528\u4E8E FileSystemObject \u5BF9\u8C61\u7684 OpenTextFile \u65B9\u6CD5\u6253\u5F00\u4E00\u4E2A\u6307\u5B9A\u7684\u6587\u4EF6\u5E76\u8FD4\u56DE\u4E00\u4E2A TextStream \u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u53EF\u7528\u4E8E\u5BF9\u6587\u4EF6\u8FDB\u884C\u8BFB\u64CD\u4F5C\u6216\u8FFD\u52A0\u64CD\u4F5C\uFF0C\u8BF7\u53C2\u9605 180-10\u3002</p><p>\u793A\u4F8B\u4E2D\u5C06 OpenTextFile \u65B9\u6CD5\u7684 iomode \u53C2\u6570\u8BBE\u7F6E\u4E3A 8\uFF0C\u6253\u5F00\u6587\u672C\u6587\u4EF6\u540E\u5728\u6587\u4EF6\u7684\u5C3E\u90E8\u8FDB\u884C\u8FFD\u52A0\u64CD\u4F5C\uFF1B\u5C06 create \u53C2\u6570\u8BBE\u7F6E\u4E3A True\uFF0C\u5982\u679C\u6307\u5B9A\u7684\u6587\u672C\u6587\u4EF6\u4E0D\u5B58\u5728\u5219\u521B\u5EFA\u4E00\u4E2A\u65B0\u6587\u4EF6\u3002</p><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u5982\u679C\u91CD\u590D\u8FD0\u884C OpenText \u8FC7\u7A0B\u5C06\u5728\u6587\u672C\u6587\u4EF6\u4E2D\u91CD\u590D\u5199\u5165\u5DE5\u4F5C\u8868\u6570\u636E\uFF0C\u6240\u4EE5 OpenTextFile \u65B9\u6CD5\u66F4\u9002\u7528\u4E8E\u5BF9\u6587\u672C\u6587\u4EF6\u8FDB\u884C\u8FFD\u52A0\u64CD\u4F5C\u3002</p></div><p>OpenText \u8FC7\u7A0B\u7684\u5176\u4ED6\u4EE3\u7801\u8BF7\u53C2\u9605 CreText \u8FC7\u7A0B\u7684\u4EE3\u7801\u89E3\u6790\u3002</p><p>\u8FD0\u884C CreText \u8FC7\u7A0B\u548C OpenText \u8FC7\u7A0B\u5C06\u5728\u793A\u4F8B\u6240\u5728\u7684\u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u4E00\u4E2A\u540D\u79F0\u4E3A\u201C\u5DE5\u8D44\u8868\u201D\u7684\u6587\u672C\u6587\u4EF6\u5E76\u5C06\u5DE5\u4F5C\u8868\u6570\u636E\u8BFB\u5165\u5230\u6587\u4EF6\u5185\u3002</p>`,303);function r(c,i){return l}var k=n(o,[["render",r]]);export{k as default};
