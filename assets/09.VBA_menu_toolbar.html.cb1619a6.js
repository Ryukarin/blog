import{_ as n,a as s}from"./app.893f8b81.js";var a="/blog/assets/79-1.80f8b9ae.png",p="/blog/assets/80-1.8cdc5997.png",t="/blog/assets/81-1.a07b62e8.png",e="/blog/assets/82-1.1ae14ae5.png",o="/blog/assets/83-1.26962272.png",l="/blog/assets/84-1.1596a5d3.png",c="/blog/assets/85-1.a6fcbfd6.png",r="/blog/assets/86-1.2ebe093d.png",u="/blog/assets/87-1.0ad8b0ac.png",i="/blog/assets/89-1.c079e076.png",k="/blog/assets/89-2.57c2641b.png",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAaCAIAAACsB0LYAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKKklEQVRIia2UW6il91mHf//Dd/7W+tZh77XX3jOTyczuTNJM20QbaNCqufDQQiOivWopFYVAoCJCJdY7Ra8UFayxBCPWSi0qGKiotU3uTCp6EYcY5rB3Zu/Z53X+1nf8n71I0UbvxOfqd/nw8vCSl/6lbFZ1P+4wK0Sz6MSZFIEzSeuEC1tHi5T5QR3pnPW34rXExM4GfiBpejp7ePMy83nn4F1v7MdnnUVA3aYtpcAiukIIidYPujFFZ3gy0zztexRMAMZoRlxEjTTUWQLrEVBiycuvVZHnd0LqkerSdqefYTlHGGMAWB+LFnGM9Up6sS+Illxd9SO3RtugP8KDI0HSuruRQra11yECsYQ10BGIB9bCI/i3e/P7J+WyjeF8piQlSsJqHnjEMMYCnyeBF0ce75G4LfKNXjbsdboxIEU3FFEQr/NKVy4MIwhv2PX9EGWlnLOL9h3ZhDvRjmdDkgY68hRD7ly8tqFtYCknPKq0BG8Il7p5/PpQk7Tcz4WxhFDGA22NdFy0hlIjFFVaS0kp99CKottD2oEUhtGg3+sul4v6klhFLe8Hq4q2Bqsp+CoKTxJrnkB0vd8NTvff6vTRDWh7v8VZF6pJfSajSCVeSmsu55oReGyQYNQLjG6FMrU0rSZSEaEdWOxcJBRdl3aaCz5vm3gUsgy5QCdkB6cgVGWDEap17CJTIx3j7elhZ+QN/HiAbr2iOsH+w/s3rj7y3RK0xMeGoQuw7xJL8MYpaIDnulEYezYFlYEopO/5TVML62lpjLGt1ZYHcMQ5B+IYCCGWt9p1Qq/RxqNsVeFXX/wtYfKvf+N3wtPuIMbeQe4+1L7w0k8t+yfNvEQO9IH+E/Htg7975f7PfeWouy6++YUPzqrlZtifrtZ/+A+1iTce/3i702OTAlm18mM/SXwQ6gWhtZIxyuGYx7WwzloAlhBKKU+9uFpdOOX7vr+uyGL2MO3aINC1z0mCeBCYtJy1B/JMjHcHILxOJ2sy613fKPyNZcuWUqkRaat+qqHD7ltzZSpuw0ESaW6xEZJWChfFq6pC0NWtYo4qKazRlHECWGsdYA14SrFauyyIVJOP+9k3vvrl6zd9YPXOpXRW8aDHz6ezK91bs/LiL57/+97pzhPdwatn9IcGq+kDP2LYjsnmA5WFShkWBoHxhgAsgaxrabqZV8+9DvMhtWXMAWCEUmusdlpra61zDgChjE+45JFa53qzn53PNU/9vWMw29vlONcIWBHz7rv0befk5eYxoZZHOR1urjDteZFsGlXEahL2wqQ6nvd6Q8Bik0pE+tQlGy3uZttx2bYtiDNttUzCKM9LGnhCOW4N/hvDKdDr9Rjl02nN/fizn/1FKPnNv/5a3iyc10/8fkO6vn0U0XopgiQbY4J4p8grU20H6KfTBbRBOas+jnYyWUfYEiYyQcwJeGOwnoFmzsG9hyXfGw7O4fuhWqrvmREKiiAIer1sewtemhKPyMq0uZCi9frmXvXgMDxPE7iFvaaH/WOGi3YcOqeRjS+dJuO7deayrKhkldeq1pySMIqstdbCaKe11VorpbQ27+3vh1O4Is/1Tqc/DE9m6qtfe2kzBSNoNFcWFKSTaB4elYX77T//yUm5t+oBtvfm55YBiZA2533yE3+8X3Z2AQy8uqUI4mQcFoHRlepOdHdgKkOhtdZGK2qU0pZy9b8OwkPfd4Za45QlyrimwVygccIR31k4RwBKCAEcHHUWcIBzxllHKCgFgQXgAAJLKCgIIRbEOhjAOhDCADhHnCXWwloQax2ofV8f4LCuk3SNI9O5Sjv+z3/+eVotXv36K4FHG+dJZXLFdfNod7P99Z/5p6zvP7Xc3gsObxb0jDco/S2Kv3lhNx2AFzhYx59+De1CHtdsg/MuMWNWW+LDASDO/Vcc5L1i3ufhtLHUGuOUtcSCc97JOjtb2b/vzyRP4TPuc+5FYq6uB1e9FRYryF17Jz9rtxJsRhdLGILp0cGHwFgk3CINA99PfGNR5Y1AGZJMMyilpJTMUSU0I1I6Yp16nwdnrCxXZiONk+D4fPXll/5od4OEARI+WAmR68nKNtLtoRIdWpXziYuuLefxKN+yqDBvO7GGS/1e8PpiezSAdOhQg6poNGoTmWSbLJeCxUKIVjBioNqWAQow/8PD96y1QSlp3qok6C6mpWyS7+Y5zfqxfhjisWV5PExFxfFO7t/U11b0LbN8ajUs63mIIS/YShYneT/tmYt0yVEMiw1mpUilu9vp3JqikAGL0eY1iSjI5PU//QJwFkeQBRzZ+enPvCKi3Zme0Nli7iyp2rbb9axRL37xi7/0wvNXtvrVum5btVijbkVeQABzvb8OS7d+ZMjgyUUgJzjRdJ4N8kvew6wUrrGMh4CHRriilKJqqkacVwc6hOb+PA8nk/GnfuEvTyfuZN+dNu5eefT7f/aJd1ff6fZ3eBh1BhtZXZXHD2ceMZzYOOCbA9y/WPtB5ASSZLfDH0e8ebEe9mlamyWlsOJwd+upIFKWVDX3pHdu3fZKCGpAlalbE5iAKFlLml3ZeufwtNSiVdq66GJafOlLr+v8YM6dcKkKekFn++2DV7klWOVl6NNGiOFo8Ae/97sf2M2GGazoKdC8rBZ8b7m6g/Wdr3z7ar9tjrtgVccj0a8896ogT6MN3i6IvcR7IpoUBWtmXiDKhvW8xEdTSLl80F7ZuXJ2dHBlN/GxfuPl3/hXdwg3BwfUjSef+zUdZ8PeiCdxOp9O+KAL7h2enhCjyrq9ODvh2Y1Sk7xamRjXBx9eeXuo3LJBmyBp2op0tOUf3CQrR6WzrtFVYQpqPjDifmqEYmtFja0q7TEV5Sf66sbO0f27wwF97MefufvmYeh5Zq5KfW8N/PCnXqbqSS6lZL5XN0Ib2x/uLOaTRas721eLet5oj/Fk6F/62Y/8VbTRM8Lj2hrKLit7rE5+wL9lLhd1L3gEajpparGOxv6zHx5w3/O4K1fWkhY8SanXWrd/76i38WidO98mH3n62u1v/63T/yw1nnnmN+f20sZuy5MojAJ/upifnJ476peGrwvjK81dp2klJQs5mw0pDXSryJT6xFTDbZ0ZemN+J9/EtOGb67OBNbc8PoE1j2bgXLmGCUk9rSQnlasOz6a97ZGw/vHJcmc0Yi69+YlfnjHxI5980bv8Y1vh5so85HVdFkUFRtMsq7UphfHDqCjFIPS0plFIZCMjjMmSSUM1/KJ3bza5VHV2c+F1t2br8E7tzGB8LZnxxWohahPyqcNmYCIiRS5aqGrr6iMHs4dGX/hbm1W4yIuDKMCNH/3H0jxJO1PZHiEvyZ+8VhhjtMVolL3x5luj0Vg7a7RzeN///z9TYuNb33rt+HjSNFJIG0SRsco5Y3hLXOguZuPLw489/RgPw1BrrRsxnZa3b98m5D/KptbKxkn4/+Lh9W/s7e21lSI8gGPWWq01jAKBF3jeePyDH7317LMf/U/htWFpQ1HkVwAAAABJRU5ErkJggg==",b="/blog/assets/91-1.daf93ccc.png",m="/blog/assets/91-2.95b21a01.png",y="/blog/assets/92-1.7199b12e.png",w="/blog/assets/93-1.b80f9e44.png",g="/blog/assets/95-1.0db92e9b.png",C="/blog/assets/95-2.c4e5f142.png",v="/blog/assets/95-3.d92ee4bc.png",h="/blog/assets/96-1.29397e0e.png",B="/blog/assets/97-1.a987bf09.png",A="/blog/assets/97-2.de0e1684.png";const q={},x=s(`<h2 id="_79\u3001\u5728\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879" tabindex="-1"><a class="header-anchor" href="#_79\u3001\u5728\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879" aria-hidden="true">#</a> 79\u3001\u5728\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879</h2><p>\u5728 Excel \u5DE5\u4F5C\u8868\u7684\u83DC\u5355\u4E2D\u53EF\u4EE5\u6DFB\u52A0\u65B0\u7684\u83DC\u5355\u9879\u548C\u5B50\u83DC\u5355\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> myTools<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myTools <span class="token keyword">As</span> CommandBarPopup
	<span class="token keyword">Dim</span> myCap <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> myid <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Byte</span>
	myCap <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;\u57FA\u7840\u5E94\u7528&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VBA\u7A0B\u5E8F\u5F00\u53D1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u51FD\u6570\u4E0E\u516C\u5F0F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u56FE\u8868\u4E0E\u56FE\u5F62&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6570\u636E\u900F\u89C6\u8868&quot;</span><span class="token punctuation">)</span>
	myid <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">283</span><span class="token punctuation">,</span> <span class="token number">285</span><span class="token punctuation">,</span> <span class="token number">287</span><span class="token punctuation">,</span> <span class="token number">292</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Worksheet menu bar&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Reset
		<span class="token keyword">Set</span> myTools <span class="token operator">=</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u5E2E\u52A9(&amp;H)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">,</span> Before<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">With</span> myTools
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;Excel Home \u6280\u672F\u8BBA\u575B&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">5</span>
				<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>Caption <span class="token operator">=</span> myCap<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> myid<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;myC&quot;</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">Next</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> myTools <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>myTools \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u5728 Excel \u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u7684\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E2D\u6DFB\u52A0\u4E00\u4E2A\u6807\u9898\u4E3A\u201CExcel Home \u6280\u672F\u8BBA\u575B\u201D\u7684\u83DC\u5355\u9879\u548C 5 \u4E2A\u5B50\u83DC\u5355\u3002</p><p>\u7B2C 2 \u884C\u5230\u7B2C 5 \u884C\u4EE3\u7801\u58F0\u660E\u53D8\u91CF\u7C7B\u578B\u3002</p><p>\u7B2C 6\u30017 \u884C\u4EE3\u7801\u4F7F\u7528 Array \u51FD\u6570\u521B\u5EFA\u4E24\u4E2A\u6570\u7EC4\u7528\u4E8E\u4FDD\u5B58\u5B50\u83DC\u5355\u7684\u540D\u79F0\u548C\u56FE\u6807 ID\u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\uFF0C\u5728\u6DFB\u52A0\u83DC\u5355\u9879\u524D\u5148\u4F7F\u7528 Reset \u65B9\u6CD5\u91CD\u7F6E\u83DC\u5355\u680F\u4EE5\u514D\u91CD\u590D\u6DFB\u52A0\u83DC\u5355\u9879\u3002Reset \u65B9\u6CD5\u91CD\u7F6E\u4E00\u4E2A\u5185\u7F6E\u63A7\u4EF6\uFF0C\u6062\u590D\u8BE5\u63A7\u4EF6\u539F\u6765\u5BF9\u5E94\u7684\u52A8\u4F5C\uFF0C\u5E76\u5C06\u5404\u5C5E\u6027\u6062\u590D\u6210\u521D\u59CB\u72B6\u6001\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Reset

\u53C2\u6570expression \u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u547D\u4EE4\u680F\u6216\u547D\u4EE4\u680F\u63A7\u4EF6\u5BF9\u8C61\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7B2C 10 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728 Excel \u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u7684\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879\u3002Add \u65B9\u6CD5\u5E94\u7528\u4E8E CommandBarControls \u5BF9\u8C61\u65F6\uFF0C\u65B0\u5EFA\u4E00\u4E2A CommandBarControl \u5BF9\u8C61\u5E76\u6DFB\u52A0\u5230\u6307\u5B9A\u547D\u4EE4\u680F\u4E0A\u7684\u63A7\u4EF6\u96C6\u5408\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">,</span> Id<span class="token punctuation">,</span> Parameter<span class="token punctuation">,</span> Before<span class="token punctuation">,</span> Temporary<span class="token punctuation">)</span>

\u53C2\u6570expression \u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBarControls\u5BF9\u8C61\uFF0C\u4EE3\u8868\u547D\u4EE4\u680F\u4E2D\u7684\u6240\u6709\u63A7\u4EF6\u3002
\u53C2\u6570<span class="token keyword">Type</span>\u662F\u53EF\u9009\u7684\uFF0C\u6DFB\u52A0\u5230\u6307\u5B9A\u547D\u4EE4\u680F\u7684\u63A7\u4EF6\u7C7B\u578B\uFF0C\u53EF\u4EE5\u4E3A\u8868\u683C <span class="token number">79</span><span class="token number">1</span>\u6240\u5217\u7684MsoControlType\u5E38\u6570\u4E4B\u4E00\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><u>\u8868\u683C 79-1</u> MsoControlType \u5E38\u6570</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u63A7\u4EF6\u7C7B\u578B</th></tr></thead><tbody><tr><td>msoControlButton</td><td>1</td><td>\u547D\u4EE4\u6309\u94AE</td></tr><tr><td>msoControlEdit</td><td>2</td><td>\u6587\u672C\u6846</td></tr><tr><td>msoControlDropdown</td><td>3</td><td>\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846</td></tr><tr><td>msoControlComboBox</td><td>4</td><td>\u4E0B\u62C9\u7EC4\u5408\u63A7\u5236\u6846</td></tr><tr><td>msoControlPopup</td><td>10</td><td>\u5F39\u51FA\u5F0F\u63A7\u4EF6</td></tr></tbody></table><p>\u56E0\u4E3A\u5728\u672C\u4F8B\u4E2D\u5C06\u6DFB\u52A0\u7684\u662F\u5E26\u6709\u5B50\u83DC\u5355\u7684\u83DC\u5355\u9879\uFF0C\u6240\u4EE5\u5C06\u53C2\u6570 Type \u8BBE\u7F6E\u4E3A\u5F39\u51FA\u5F0F\u63A7\u4EF6\u3002</p><p>\u53C2\u6570 Id \u662F\u53EF\u9009\u7684\uFF0C\u6807\u8BC6\u6574\u6570\u3002\u5982\u679C\u5C06\u8BE5\u53C2\u6570\u8BBE\u7F6E\u4E3A 1 \u6216\u8005\u5FFD\u7565\uFF0C\u5C06\u5728\u547D\u4EE4\u680F\u4E2D\u6DFB\u52A0\u4E00\u4E2A\u7A7A\u7684\u6307\u5B9A\u7C7B\u578B\u7684\u81EA\u5B9A\u4E49\u63A7\u4EF6\u3002</p><p>\u53C2\u6570 Parameter \u662F\u53EF\u9009\u7684\uFF0C\u5BF9\u4E8E\u5185\u7F6E\u63A7\u4EF6\uFF0C\u8BE5\u53C2\u6570\u7528\u4E8E\u5BB9\u5668\u5E94\u7528\u7A0B\u5E8F\u8FD0\u884C\u547D\u4EE4\u3002\u5BF9\u4E8E\u81EA\u5B9A\u4E49\u63A7\u4EF6\uFF0C\u53EF\u4EE5\u4F7F\u7528\u8BE5\u53C2\u6570\u5411 Visual Basic \u8FC7\u7A0B\u4F20\u9012\u4FE1\u606F\uFF0C\u6216\u7528\u5176\u5B58\u50A8\u63A7\u4EF6\u4FE1\u606F\u3002</p><p>\u53C2\u6570 Before \u662F\u53EF\u9009\u7684\uFF0C\u8868\u793A\u65B0\u63A7\u4EF6\u5728\u547D\u4EE4\u680F\u4E0A\u4F4D\u7F6E\u7684\u6570\u5B57\u3002\u65B0\u63A7\u4EF6\u5C06\u63D2\u5165\u5230\u8BE5\u4F4D\u7F6E\u63A7\u4EF6\u4E4B\u524D\u3002\u5982\u679C\u5FFD\u7565\u8BE5\u53C2\u6570\uFF0C\u63A7\u4EF6\u5C06\u6DFB\u52A0\u5230\u6307\u5B9A\u547D\u4EE4\u680F\u7684\u672B\u7AEF\u3002\u672C\u4F8B\u4E2D\u5C06 Before \u53C2\u6570\u8BBE\u7F6E\u4E3A 1\uFF0C\u83DC\u5355\u9879\u6DFB\u52A0\u5230\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u7684\u9876\u7AEF\u3002</p><p>\u53C2\u6570 Temporary \u662F\u53EF\u9009\u7684\u3002\u8BBE\u7F6E\u4E3A True \u5C06\u4F7F\u6DFB\u52A0\u7684\u83DC\u5355\u9879\u4E3A\u4E34\u65F6\u7684\uFF0C\u5728\u5173\u95ED\u5E94\u7528\u7A0B\u5E8F\u65F6\u5220\u9664\u3002\u9ED8\u8BA4\u503C\u4E3A False\u3002</p><p>\u7B2C 12 \u884C\u4EE3\u7801\uFF0C\u8BBE\u5B9A\u65B0\u6DFB\u52A0\u83DC\u5355\u9879\u7684 Caption \u5C5E\u6027\u4E3A\u201CExcel Home \u6280\u672F\u8BBA\u575B\u201D\u3002Caption \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u547D\u4EE4\u680F\u63A7\u4EF6\u7684\u6807\u9898\u3002</p><p>\u7B2C 13 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u65B0\u6DFB\u52A0\u83DC\u5355\u9879\u7684 BeginGroup \u5C5E\u6027\u4E3A True\uFF0C\u5206\u7EC4\u663E\u793A\u3002</p><p>\u7B2C 14 \u884C\u5230\u7B2C 19 \u884C\u4EE3\u7801\uFF0C\u5728\u201CExcel Home \u6280\u672F\u8BBA\u575B\u201D\u83DC\u5355\u9879\u4E0A\u6DFB\u52A0\u4E94\u4E2A\u5B50\u83DC\u5355\u5E76\u8BBE\u7F6E\u5176 Caption \u5C5E\u6027\u3001FaceId \u5C5E\u6027\u548C OnAction \u5C5E\u6027\u3002</p><p>FaceId \u5C5E\u6027\u8BBE\u7F6E\u51FA\u73B0\u5728\u83DC\u5355\u6807\u9898\u5DE6\u4FA7\u7684\u56FE\u6807\uFF0C\u4EE5\u6570\u5B57\u8868\u793A\uFF0C\u4E00\u4E2A\u6570\u5B57\u4EE3\u8868\u4E00\u4E2A\u5185\u7F6E\u7684\u56FE\u6807\u3002</p><p>OnAction \u5C5E\u6027\u8BBE\u7F6E\u4E00\u4E2A VBA \u7684\u8FC7\u7A0B\u540D\uFF0C\u8BE5\u8FC7\u7A0B\u5728\u7528\u6237\u5355\u51FB\u5B50\u83DC\u5355\u65F6\u8FD0\u884C\uFF0C\u672C\u4F8B\u4E2D\u8BBE\u7F6E\u4E3A\u4E0B\u9762\u7684\u8FC7\u7A0B\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> myC<span class="token punctuation">(</span><span class="token punctuation">)</span>
	MsgBox <span class="token string">&quot;\u60A8\u9009\u62E9\u4E86\uFF1A &quot;</span> <span class="token operator">&amp;</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>ActionControl<span class="token punctuation">.</span>Caption
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>myC \u8FC7\u7A0B\u662F\u5355\u51FB\u65B0\u6DFB\u52A0\u5B50\u83DC\u5355\u6240\u8FD0\u884C\u8FC7\u7A0B\uFF0C\u4E3A\u4E86\u6F14\u793A\u65B9\u4FBF\u5728\u8FD9\u91CC\u53EA\u4F7F\u7528 MsgBox \u51FD\u6570\u663E\u793A\u6240\u5176 Caption \u5C5E\u6027\u3002</p><p>\u5220\u9664\u65B0\u6DFB\u52A0\u7684\u83DC\u5355\u9879\u53CA\u5B50\u83DC\u5355\u7684\u4EE3\u7801\u5982\u4E0B\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DelmyTools<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Worksheet menu bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Reset
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>DelmyTools \u8FC7\u7A0B\u4F7F\u7528 Reset \u65B9\u6CD5\u91CD\u7F6E\u83DC\u5355\u680F\uFF0C\u5220\u9664\u6DFB\u52A0\u7684\u83DC\u5355\u9879\u53CA\u5B50\u83DC\u5355\u3002</p><p>\u4E3A\u4E86\u5728\u6253\u5F00\u5DE5\u4F5C\u7C3F\u65F6\u81EA\u52A8\u6DFB\u52A0\u83DC\u5355\u9879\uFF0C\u9700\u8981\u5728\u5DE5\u4F5C\u7C3F\u7684 Activate \u4E8B\u4EF6\u4E2D\u8C03\u7528 myTools \u8FC7\u7A0B\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Activate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Call</span> myTools
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4E3A\u4E86\u5728\u5173\u95ED\u5DE5\u4F5C\u7C3F\u65F6\u5220\u9664\u65B0\u6DFB\u52A0\u7684\u83DC\u5355\u9879\uFF0C\u8FD8\u9700\u8981\u5728\u5DE5\u4F5C\u7C3F\u7684 Deactivate \u4E8B\u4EF6\u4E2D\u8C03\u7528 DelmyTools \u8FC7\u7A0B\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Deactivate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Call</span> DelmyTools
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5982\u679C\u5E0C\u671B\u8FD9\u4E2A\u83DC\u5355\u4E3A\u6240\u6709\u5DE5\u4F5C\u7C3F\u4F7F\u7528\uFF0C\u90A3\u4E48\u5C31\u5E94\u8BE5\u5728\u5DE5\u4F5C\u7C3F\u7684 Open \u4E8B\u4EF6\u4E2D\u8C03\u7528 myTools \u8FC7\u7A0B\uFF0C\u5728 BeforeClose \u4E8B\u4EF6\u4E2D\u8C03\u7528 DelmyTools \u8FC7\u7A0B\u3002</p><p>\u8FD0\u884C myTools \u8FC7\u7A0B\uFF0C\u5C06\u5728 Excel \u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u7684\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E2D\u6DFB\u52A0\u4E00\u4E2A\u540D\u4E3A\u201CExcel Home \u6280\u672F\u8BBA\u575B\u201D\u7684\u83DC\u5355\u9879\u53CA\u4E94\u4E2A\u5B50\u83DC\u5355\uFF0C\u5982\u56FE 79-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+a+`" alt="" loading="lazy"></p><p><u>\u56FE 79-1</u> \u5728\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879\u53CA\u5B50\u83DC\u5355</p></div><h2 id="_80\u3001\u5728\u83DC\u5355\u680F\u6307\u5B9A\u4F4D\u7F6E\u6DFB\u52A0\u83DC\u5355" tabindex="-1"><a class="header-anchor" href="#_80\u3001\u5728\u83DC\u5355\u680F\u6307\u5B9A\u4F4D\u7F6E\u6DFB\u52A0\u83DC\u5355" aria-hidden="true">#</a> 80\u3001\u5728\u83DC\u5355\u680F\u6307\u5B9A\u4F4D\u7F6E\u6DFB\u52A0\u83DC\u5355</h2><p>\u9664\u4E86\u53EF\u4EE5\u5728\u5DE5\u4F5C\u8868\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879\u5916\uFF0C\u8FD8\u53EF\u4EE5\u5728\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u7684\u6307\u5B9A\u4F4D\u7F6E\u6DFB\u52A0\u83DC\u5355\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddNewMenu<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> HelpMenu <span class="token keyword">As</span> CommandBarControl
	<span class="token keyword">Dim</span> NewMenu <span class="token keyword">As</span> CommandBarPopup
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Worksheet menu bar&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Reset
		<span class="token keyword">Set</span> HelpMenu <span class="token operator">=</span> <span class="token punctuation">.</span>FindControl<span class="token punctuation">(</span>ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u5E2E\u52A9(&amp;H)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ID<span class="token punctuation">)</span>
		<span class="token keyword">If</span> HelpMenu <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
			<span class="token keyword">Set</span> NewMenu <span class="token operator">=</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
		<span class="token keyword">Else</span>
			<span class="token keyword">Set</span> NewMenu <span class="token operator">=</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">,</span> <span class="token operator">_</span>
				Before<span class="token punctuation">:</span><span class="token operator">=</span>HelpMenu<span class="token punctuation">.</span>Index<span class="token punctuation">)</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
		<span class="token keyword">With</span> NewMenu
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u7EDF\u8BA1(&amp;S)&quot;</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8F93\u5165\u6570\u636E(&amp;D)&quot;</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">162</span>
				<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u6C47\u603B\u6570\u636E(&amp;T)&quot;</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">590</span>
				<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> HelpMenu <span class="token operator">=</span> <span class="token boolean">Nothing</span>
	<span class="token keyword">Set</span> NewMenu <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>AddNewMenu \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u5DE5\u4F5C\u8868\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u524D\u6DFB\u52A0\u4E00\u4E2A\u6807\u9898\u4E3A\u201C\u7EDF\u8BA1\u201D\u7684\u83DC\u5355\u548C\u4E24\u4E2A\u83DC\u5355\u9879\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 FindControl \u65B9\u6CD5\u5728\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u67E5\u627E\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u3002\u5E94\u7528\u4E8E CommandBars \u5BF9\u8C61\u7684 FindControl \u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u7B26\u5408\u6307\u5B9A\u6761\u4EF6\u7684 CommandBarControl \u5BF9\u8C61\u3002\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>FindControl<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">,</span> Id<span class="token punctuation">,</span> Tag<span class="token punctuation">,</span> Visible<span class="token punctuation">,</span> Recursive<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBars\u5BF9\u8C61\u3002
\u53C2\u6570<span class="token keyword">Type</span>\u662F\u53EF\u9009\u7684\uFF0C\u8981\u67E5\u627E\u63A7\u4EF6\u7684\u7C7B\u578B\u3002
\u53C2\u6570Id\u662F\u53EF\u9009\u7684\uFF0C\u8981\u67E5\u627E\u63A7\u4EF6\u7684\u6807\u8BC6\u7B26\u3002
\u53C2\u6570Tag\u662F\u53EF\u9009\u7684\uFF0C\u8981\u67E5\u627E\u63A7\u4EF6\u7684\u6807\u8BB0\u503C\u3002
\u53C2\u6570Visible\u662F\u53EF\u9009\uFF0C\u5982\u679C\u8BE5\u503C\u4E3A<span class="token boolean">True</span>\uFF0C\u90A3\u4E48\u53EA\u67E5\u627E\u5C4F\u5E55\u4E0A\u663E\u793A\u7684\u547D\u4EE4\u680F\u63A7\u4EF6\u3002\u9ED8\u8BA4\u503C\u4E3A<span class="token boolean">False</span>\u3002
\u53C2\u6570Recursive\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u8BE5\u503C\u4E3A<span class="token boolean">True</span>\uFF0C\u90A3\u4E48\u5C06\u5728\u547D\u4EE4\u680F\u53CA\u5176\u5168\u90E8\u5F39\u51FA\u5F0F\u5B50\u5DE5\u5177\u680F\u4E2D\u67E5\u627E\u3002\u6B64\u53C2\u6570\u4EC5\u5E94\u7528\u4E8ECommandBar\u5BF9\u8C61\u3002\u9ED8\u8BA4\u503C\u4E3A<span class="token boolean">False</span>\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u5982\u679C\u6CA1\u6709\u63A7\u4EF6\u7B26\u5408\u641C\u7D22\u6761\u4EF6\uFF0C\u90A3\u4E48 FindControl \u65B9\u6CD5\u8FD4\u56DE Nothing\u3002</p><p>\u7B2C 7 \u884C\u5230\u7B2C 12 \u884C\u4EE3\u7801\uFF0C\u5982\u679C\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u5B58\u5728\u201C\u5E2E\u52A9\u201D\u83DC\u5355\uFF0C\u5C06\u201C\u7EDF\u8BA1\u201D\u83DC\u5355\u6DFB\u52A0\u5230\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E4B\u524D\uFF0C\u5426\u5219\u6DFB\u52A0\u5230\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u672B\u5C3E\u3002</p><p>\u7B2C 12 \u884C\u5230\u7B2C 25 \u884C\u4EE3\u7801\uFF0C\u5728\u201C\u7EDF\u8BA1\u201D\u83DC\u5355\u4E2D\u6DFB\u52A0\u4E24\u4E2A\u5B50\u83DC\u5355\u5E76\u8BBE\u7F6E\u5176\u5404\u79CD\u5C5E\u6027\u3002</p><p>\u8FD0\u884C AddNewMenu \u8FC7\u7A0B\uFF0C\u5C06\u5728\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u7684\u201C\u5E2E\u52A9\u201D\u83DC\u5355\u4E4B\u524D\u6DFB\u52A0\u4E00\u4E2A\u201C\u7EDF\u8BA1\u201D\u83DC\u5355\uFF0C\u5982\u56FE 80-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+p+`" alt="" loading="lazy"></p><p><u>\u56FE 80-1</u> \u5728\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u6DFB\u52A0\u83DC\u5355</p></div><h2 id="_81\u3001\u5C4F\u853D\u548C\u5220\u9664\u5DE5\u4F5C\u8868\u83DC\u5355" tabindex="-1"><a class="header-anchor" href="#_81\u3001\u5C4F\u853D\u548C\u5220\u9664\u5DE5\u4F5C\u8868\u83DC\u5355" aria-hidden="true">#</a> 81\u3001\u5C4F\u853D\u548C\u5220\u9664\u5DE5\u4F5C\u8868\u83DC\u5355</h2><p>\u5982\u679C\u4E0D\u5E0C\u671B\u7528\u6237\u4F7F\u7528\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u7684\u90E8\u5206\u529F\u80FD\uFF0C\u53EF\u4EE5\u628A\u83DC\u5355\u6216\u83DC\u5355\u9879\u5C4F\u853D\u6216\u5220\u9664\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Shibar<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Worksheet menu bar&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Reset
		<span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u5DE5\u5177(&amp;T)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u5B8F(&amp;M)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
		<span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u6570\u636E(&amp;D)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Shibar \u8FC7\u7A0B\u5C4F\u853D \u201C\u5DE5\u5177\u201D\u83DC\u5355\u4E2D\u7684\u201C\u5B8F\u201D\u83DC\u5355\u9879\uFF0C\u5220\u9664\u83DC\u5355\u680F\u4E2D\u7684\u201C\u6570\u636E\u201D\u83DC\u5355\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Reset \u65B9\u6CD5\u91CD\u7F6E\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\uFF0C\u5C06\u201C\u5B8F\u201D\u83DC\u5355\u9879\u7684 Enabled \u5C5E\u6027\u8BBE\u7F6E\u4E3A False\uFF0C\u4F7F\u4E4B\u65E0\u6548\u3002</p><p>Enabled \u5C5E\u6027\u51B3\u5B9A\u547D\u4EE4\u680F\u6216\u547D\u4EE4\u680F\u63A7\u4EF6\u662F\u5426\u6FC0\u6D3B\uFF0C\u5982\u679C\u5C06\u8BE5\u5C5E\u6027\u8BBE\u7F6E\u4E3A False\uFF0C\u90A3\u4E48\u8BE5\u83DC\u5355\u9879\u5C06\u65E0\u6548\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Delete \u65B9\u6CD5\u5C06\u201C\u6570\u636E\u201D\u83DC\u5355\u4ECE\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u5220\u9664\u3002</p><p>Delete \u65B9\u6CD5\u5E94\u7528\u4E8E\u547D\u4EE4\u680F\u6216\u547D\u4EE4\u680F\u63A7\u4EF6\u65F6\uFF0C\u4ECE\u96C6\u5408\u4E2D\u5220\u9664\u6307\u5B9A\u5BF9\u8C61\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Delete<span class="token punctuation">(</span>Temporary<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u547D\u4EE4\u680F\u6216\u547D\u4EE4\u680F\u63A7\u4EF6\u5BF9\u8C61\u4E4B\u4E00\u3002
\u53C2\u6570Temporary\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u4E3A<span class="token boolean">True</span>\u5C06\u4ECE\u5F53\u524D\u4F1A\u8BDD\u4E2D\u5220\u9664\u63A7\u4EF6\uFF0C\u5E94\u7528\u7A0B\u5E8F\u5728\u4E0B\u6B21\u4F1A\u8BDD\u65F6\u5C06\u518D\u6B21\u663E\u793A\u63A7\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u8FD0\u884C Shibar \u8FC7\u7A0B\uFF0C\u5C06\u5C4F\u853D\u5DE5\u4F5C\u8868\u201C\u5DE5\u5177\u201D\u83DC\u5355\u4E2D\u7684\u201C\u5B8F\u201D\u83DC\u5355\u9879\u548C\u5220\u9664\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u4E2D\u7684\u201C\u6570\u636E\u201D\u83DC\u5355\uFF0C\u5982\u56FE 81-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+t+`" alt="" loading="lazy"></p><p><u>\u56FE 81-1</u> \u5C4F\u853D\u548C\u5220\u9664\u5DE5\u4F5C\u8868\u83DC\u5355</p></div><h2 id="_82\u3001\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_82\u3001\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u64CD\u4F5C" aria-hidden="true">#</a> 82\u3001\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u64CD\u4F5C</h2><p>\u5229\u7528 VBA \u751A\u81F3\u53EF\u4EE5\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u9ED8\u8BA4\u64CD\u4F5C\uFF0C\u4F7F\u4E4B\u8FBE\u5230\u81EA\u5B9A\u4E49\u83DC\u5355\u7684\u6548\u679C\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Dim</span> <span class="token keyword">WithEvents</span> Saveas <span class="token keyword">As</span> CommandBarButton
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> Saveas <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;File&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token string">&quot;\u53E6\u5B58\u4E3A(&amp;A)...&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Saveas_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Ctrl <span class="token keyword">As</span> Office<span class="token punctuation">.</span>CommandBarButton<span class="token punctuation">,</span> CancelDefault <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
	CancelDefault <span class="token operator">=</span> <span class="token boolean">True</span>
	MsgBox <span class="token string">&quot;\u672C\u5DE5\u4F5C\u7C3F\u7981\u6B62\u53E6\u5B58!&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u7B2C 1 \u884C\u4EE3\u7801\uFF0C\u5728\u6A21\u5757\u7EA7\u522B\u4E2D\u4F7F\u7528\u5173\u952E\u8BCD WithEvents \u58F0\u660E\u53D8\u91CF Saveas \u662F\u7528\u6765\u54CD\u5E94\u7531 CommandBarButton \u5BF9\u8C61\u89E6\u53D1\u4E8B\u4EF6\u7684\u5BF9\u8C61\u53D8\u91CF\u3002</p><p>\u7B2C 2 \u884C\u5230\u7B2C 4 \u4EE3\u7801\u5DE5\u4F5C\u7C3F\u7684 Open \u4E8B\u4EF6\u8FC7\u7A0B\uFF0C\u5728\u5DE5\u4F5C\u7C3F\u6253\u5F00\u65F6\u5C06\u53D8\u91CF Saveas \u8D4B\u503C\u4E3A\u7CFB\u7EDF\u83DC\u5355\u7684\u201C\u53E6\u5B58\u4E3A\u201D\u83DC\u5355\u3002</p><p>\u56E0\u4E3A\u5728\u58F0\u660E\u53D8\u91CF Saveas \u65F6\u4F7F\u7528\u4E86\u5173\u952E\u8BCD WithEvents\uFF0C\u4E0D\u80FD\u540C\u65F6\u4F7F\u7528 New \u5173\u952E\u8BCD\u9690\u5F0F\u5730\u521B\u5EFA\u5BF9\u8C61\uFF0C\u6240\u4EE5\u5728\u4F7F\u7528\u53D8\u91CF Saveas \u4E4B\u524D\uFF0C\u5FC5\u987B\u4F7F\u7528 Set \u8BED\u53E5\u5C06\u53D8\u91CF\u8D4B\u503C\u4E3A\u4E00\u4E2A\u5DF2\u6709\u5BF9\u8C61\u3002</p><p>\u7B2C 5 \u884C\u5230\u7B2C 8 \u4EE3\u7801\u53D8\u91CF Saveas \u7684\u5355\u51FB\u4E8B\u4EF6\u8FC7\u7A0B\uFF0C\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u201C\u53E6\u5B58\u4E3A\u201D\u7684\u9ED8\u8BA4\u64CD\u4F5C\u3002</p><p>\u53D8\u91CF Saveas \u7684 Click \u4E8B\u4EF6\u5728\u7528\u6237\u5355\u51FB\u7CFB\u7EDF\u83DC\u5355\u201C\u53E6\u5B58\u4E3A\u201D\u65F6\u53D1\u751F\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> CommandBarButton_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Ctrl <span class="token keyword">As</span> CommandBarButton<span class="token punctuation">,</span><span class="token keyword">ByVal</span> CancelDefault <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>

\u53C2\u6570Ctrl\u662F\u5FC5\u9700\u7684\uFF0C\u6307\u793A\u521D\u59CB\u5316\u8BE5\u4E8B\u4EF6\u7684CommandBarButton\u63A7\u4EF6\u3002
\u53C2\u6570CancelDefault\u662F\u5FC5\u9700\u7684\uFF0C<span class="token keyword">Boolean</span>\u7C7B\u578B\uFF0C\u5982\u679C\u6267\u884C\u4E86\u4E0ECommandBarButton\u63A7\u4EF6\u5173\u8054\u7684\u9ED8\u8BA4\u64CD\u4F5C\uFF0C\u8BE5\u503C\u4E3A<span class="token boolean">False</span>\u3002\u9664\u975E\u5176\u4ED6\u8FC7\u7A0B\u6216\u52A0\u8F7D\u9879\u53D6\u6D88\u4E86\u6B64\u64CD\u4F5C\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B2C 6\u30017 \u884C\u4EE3\u7801\uFF0C\u5C06 CancelDefault \u53C2\u6570\u8BBE\u7F6E\u4E3A True\uFF0C\u4F7F\u5355\u51FB\u201C\u53E6\u5B58\u4E3A\u201D\u83DC\u5355\u65F6\u5E76\u4E0D\u6267\u884C\u9ED8\u8BA4\u64CD\u4F5C\u800C\u53EA\u663E\u793A\u4E00\u4E2A\u6D88\u606F\u6846\u3002</p><p>\u5C06\u5DE5\u4F5C\u7C3F\u4FDD\u5B58\u3001\u5173\u95ED\u540E\uFF0C\u91CD\u65B0\u6253\u5F00\uFF0C\u5355\u51FB\u201C\u53E6\u5B58\u4E3A\u201D\u83DC\u5355\u5E76\u4E0D\u6267\u884C\u9ED8\u8BA4\u64CD\u4F5C\uFF0C\u53EA\u663E\u793A\u4E00\u4E2A\u6D88\u606F\u6846\uFF0C\u5982\u56FE 82-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+e+`" alt="" loading="lazy"></p><p><u>\u56FE 82-1</u> \u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u9ED8\u8BA4\u64CD\u4F5C</p></div><h2 id="_83\u3001\u5B9A\u5236\u81EA\u5DF1\u7684\u7CFB\u7EDF\u83DC\u5355" tabindex="-1"><a class="header-anchor" href="#_83\u3001\u5B9A\u5236\u81EA\u5DF1\u7684\u7CFB\u7EDF\u83DC\u5355" aria-hidden="true">#</a> 83\u3001\u5B9A\u5236\u81EA\u5DF1\u7684\u7CFB\u7EDF\u83DC\u5355</h2><p>\u4F7F\u7528 VBA \u5F00\u53D1\u7684\u5C0F\u578B\u5E94\u7528\u7CFB\u7EDF\u5B8C\u6210\u540E\uFF0CExcel \u539F\u6709\u7684\u83DC\u5355\u680F\u5B8C\u5168\u53EF\u4EE5\u820D\u5F03\u4E0D\u7528\uFF0C\u53EA\u4F7F\u7528\u81EA\u5B9A\u4E49\u7684\u83DC\u5355\u680F\uFF0C\u66F4\u52A0\u65B9\u4FBF\u5FEB\u6377\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddNowBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> NewBar <span class="token keyword">As</span> CommandBar
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">With</span> Application
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Standard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">False</span> 
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Formatting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">False</span> 
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Stop Recording&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">False</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;toolbar list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>DisableAskAQuestionDropdown <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>DisplayFormulaBar <span class="token operator">=</span> <span class="token boolean">False</span> 
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;NewBar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> NewBar <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Name<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;NewBar&quot;</span><span class="token punctuation">,</span> Position<span class="token punctuation">:</span><span class="token operator">=</span>msoBarTop<span class="token punctuation">,</span> MenuBar<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> Temporary<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> NewBar
		<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u7CFB\u7EDF\u8BBE\u7F6E(&amp;X)&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4FDD\u5B58(&amp;S)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">1975</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5907\u4EFD(&amp;B)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">747</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u51ED\u8BC1(&amp;P)&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5F55\u5165(&amp;L)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">197</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5BA1\u6838(&amp;S)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">714</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u8D26\u7C3F(&amp;Z)&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8BB0\u8D26(&amp;L)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">65</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u7ED3\u8D26(&amp;S)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">47</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u62A5\u8868(&amp;B)&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8D44\u4EA7\u8D1F\u503A\u8868(&amp;Y)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u6708\u62A5(&amp;M)&quot;</span>
					<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
					<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">1180</span>
				<span class="token keyword">End</span> <span class="token keyword">With</span>
					<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
						<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5E74\u62A5(&amp;Y)&quot;</span>
						<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
						<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">1188</span>
					<span class="token keyword">End</span> <span class="token keyword">With</span>
				<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u635F\u76CA\u8868(&amp;S)&quot;</span>
				<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
				<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u6708\u62A5(&amp;M)&quot;</span>
					<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
					<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">1180</span>
				<span class="token keyword">End</span> <span class="token keyword">With</span>
				<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5E74\u62A5(&amp;Y)&quot;</span>
					<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
					<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">1188</span>
				<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u9000\u51FA\u7CFB\u7EDF(&amp;C)&quot;</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token punctuation">.</span>Style <span class="token operator">=</span> msoButtonCaption
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> NewBar <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>AddNowBar \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u521B\u5EFA\u81EA\u5B9A\u4E49\u83DC\u5355\u680F\u66FF\u6362\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u3002</p><p>\u7B2C 2 \u884C\u4EE3\u7801\u5B9A\u4E49\u53D8\u91CF NwBar \u4E3A\u547D\u4EE4\u680F\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u5FFD\u7565\u9519\u8BEF\u8BED\u53E5\uFF0C\u4EE5\u514D\u7B2C 11 \u884C\u4EE3\u7801\u5728\u5220\u9664\u53EF\u80FD\u4E0D\u5B58\u5728\u7684\u201CNewBar\u201D\u83DC\u5355\u680F\u65F6\u53D1\u751F\u9519\u8BEF\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u9690\u85CF\u201C\u5E38\u7528\u201D\u5DE5\u5177\u680F\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u9690\u85CF\u201C\u683C\u5F0F\u201D\u5DE5\u5177\u680F\u3002</p><p>\u7B2C 7 \u884C\u4EE3\u7801\u9690\u85CF\u201C\u505C\u6B62\u5F55\u5236\u201D\u5DE5\u5177\u680F\u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u5C4F\u853D\u5DE5\u5177\u680F\u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\u5C4F\u853D\u5DE5\u5177\u680F\u7684\u201C\u952E\u5165\u9700\u8981\u5E2E\u52A9\u7684\u95EE\u9898\u201D\u4E0B\u62C9\u6846\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u5C4F\u853D\u5DE5\u5177\u680F\u7684\u7F16\u8F91\u680F\u3002</p><p>\u7B2C 11 \u884C\u4EE3\u7801\uFF0C\u5728\u6DFB\u52A0\u547D\u4EE4\u680F\u524D\u5148\u5220\u9664\u201CNewBar\u201D\u83DC\u5355\u680F\uFF0C\u4EE5\u514D\u91CD\u590D\u589E\u52A0\u3002</p><p>\u7B2C 13 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u521B\u5EFA\u547D\u4EE4\u680F\u3002Add \u65B9\u6CD5\u5E94\u7528\u4E8E CommandBars \u5BF9\u8C61\u7684\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Name<span class="token punctuation">,</span> Position<span class="token punctuation">,</span> MenuBar<span class="token punctuation">,</span> Temporary<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBars\u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u4EE3\u8868\u5E94\u7528\u7A0B\u5E8F\u4E2D\u7684\u547D\u4EE4\u680F\uFF0C\u65B0\u5EFA\u547D\u4EE4\u680F\u7684\u63A7\u4EF6\u5747\u4EE5\u8BE5\u5BF9\u8C61\u4E3A\u8F7D\u4F53\u3002
\u53C2\u6570Name\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u65B0\u5EFA\u547D\u4EE4\u680F\u7684\u6807\u9898\u3002\u5982\u679C\u5FFD\u7565\u8BE5\u53C2\u6570\uFF0C\u5219\u4E3A\u65B0\u5EFA\u547D\u4EE4\u680F\u6307\u5B9A\u9ED8\u8BA4\u6807\u9898\uFF0C\u672C\u4F8B\u4E2D\u8BBE\u7F6E\u65B0\u5EFA\u547D\u4EE4\u680F\u7684\u6807\u9898\u4E3A<span class="token string">\u201CNewBar\u201D</span>\u3002
\u53C2\u6570Position\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u65B0\u5EFA\u547D\u4EE4\u680F\u7684\u4F4D\u7F6E\u6216\u7C7B\u578B\uFF0C\u53EF\u4EE5\u4E3A\u8868\u683C <span class="token number">83</span><span class="token number">1</span>\u6240\u5217\u7684 MsoBarPosition\u5E38\u6570\u4E4B\u4E00\u3002
\u53C2\u6570MenuBar\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u4E3A<span class="token boolean">True</span> \u5C06\u4EE5\u65B0\u547D\u4EE4\u680F\u66FF\u6362\u6D3B\u52A8\u83DC\u5355\u680F\uFF0C\u9ED8\u8BA4\u503C\u4E3A<span class="token boolean">False</span>\u3002
\u53C2\u6570Temporary\u662F\u53EF\u9009\u7684\uFF0C\u8BBE\u7F6E\u4E3A<span class="token boolean">True</span>\u5C06\u4F7F\u65B0\u5EFA\u547D\u4EE4\u680F\u4E3A\u4E34\u65F6\u547D\u4EE4\u680F\uFF0C\u5728\u5173\u95ED\u5E94\u7528\u7A0B\u5E8F\u65F6\u5220\u9664\uFF0C\u9ED8\u8BA4\u503C\u4E3A<span class="token boolean">False</span>\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><u>\u8868\u683C 83-1</u> MsoBarPosition \u5E38\u6570</p><table><thead><tr><th>\u5E38\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>msoBarLeft\u3001msoBarTop\u3001msoBarRight \u548C msoBarBottom</td><td>\u6307\u5B9A\u65B0\u547D\u4EE4\u680F\u7684\u5DE6\u4FA7\u3001\u9876\u90E8\u3001\u53F3\u4FA7\u548C\u5E95\u90E8\u5750\u6807</td></tr><tr><td>msoBarFloating</td><td>\u6307\u5B9A\u65B0\u547D\u4EE4\u680F\u4E0D\u56FA\u5B9A</td></tr><tr><td>msoBarPopup</td><td>\u6307\u5B9A\u65B0\u547D\u4EE4\u680F\u4E3A\u5FEB\u6377\u83DC\u5355</td></tr><tr><td>msoBarMenuBar</td><td>\u4EC5\u9002\u7528\u4E8E Macintosh \u673A</td></tr></tbody></table><p>\u672C\u4F8B\u4E2D\u8BBE\u7F6E\u201CNewBar\u201D\u547D\u4EE4\u680F\u7684 Position \u53C2\u6570\u4E3A msoBarTop\uFF0C\u4F7F\u201CNewBar\u201D\u547D\u4EE4\u680F\u4F4D\u4E8E Excel \u7A97\u53E3\u7684\u9876\u90E8\u3002</p><p>\u5728\u672C\u4F8B\u4E2D\uFF0C\u8BBE\u7F6E\u201CNewBar\u201D\u547D\u4EE4\u680F\u7684 MenuBar \u5C5E\u6027\u4E3A True\uFF0C\u4EE5\u201CNewBar\u201D\u547D\u4EE4\u680F\u66FF\u6362\u6D3B\u52A8\u83DC\u5355\u680F\u3002</p><p>\u5728\u672C\u4F8B\u4E2D\uFF0C\u8BBE\u7F6E\u201CNewBar\u201D\u547D\u4EE4\u680F\u7684 Temporary \u5C5E\u6027\u4E3A True\uFF0C\u4F7F\u201CNewBar\u201D\u547D\u4EE4\u680F\u4E3A\u4E34\u65F6\u547D\u4EE4\u680F\uFF0C\u5728\u5173\u95ED\u5E94\u7528\u7A0B\u5E8F\u65F6\u5220\u9664\u3002</p><p>\u7B2C 15 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u201CNewBar\u201D\u547D\u4EE4\u680F\u4E3A\u53EF\u89C1\u7684\u3002</p><p>\u7B2C 16 \u884C\u5230 95 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u201CNewBar\u201D\u547D\u4EE4\u680F\u4E2D\u6DFB\u52A0\u83DC\u5355\u3001\u83DC\u5355\u9879\u53CA\u5B50\u83DC\u5355\u5E76\u8BBE\u7F6E\u5176\u5404\u9879\u5C5E\u6027\uFF0C\u53C2\u9605 79 \u3002</p><p>\u6062\u590D Excel \u539F\u6709\u7684\u83DC\u5355\u680F\u7684\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DelNowBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">With</span> Application
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Standard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Formatting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Stop Recording&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;toolbar list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>DisableAskAQuestionDropdown <span class="token operator">=</span> <span class="token boolean">False</span>
		<span class="token punctuation">.</span>DisplayFormulaBar <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;NewBar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>DelNowBar \u8FC7\u7A0B\u53D6\u6D88 \u201C\u5E38\u7528\u201D\u3001\u201C\u683C\u5F0F\u201D\u548C\u201C\u505C\u6B62\u5F55\u5236\u201D\u5DE5\u5177\u680F\u7684\u7684\u9690\u85CF\uFF0C\u6062\u590D\u201C\u952E\u5165\u9700\u8981\u5E2E\u52A9\u7684\u95EE\u9898\u201D\u4E0B\u62C9\u6846\u548C\u7F16\u8F91\u680F\uFF0C\u5220\u9664\u201CNewBar\u201D\u547D\u4EE4\u680F\u3002</p><p>\u8FD0\u884C AddNowBar \u8FC7\u7A0B\uFF0C\u5DE5\u4F5C\u8868\u83DC\u5355\u680F\u5982\u56FE 83-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+o+`" alt="" loading="lazy"></p><p><u>\u56FE 83-1</u> \u5B9A\u5236\u81EA\u5DF1\u7684\u7CFB\u7EDF\u83DC\u5355</p></div><h2 id="_84\u3001\u6539\u53D8\u83DC\u5355\u6309\u94AE\u56FE\u6807" tabindex="-1"><a class="header-anchor" href="#_84\u3001\u6539\u53D8\u83DC\u5355\u6309\u94AE\u56FE\u6807" aria-hidden="true">#</a> 84\u3001\u6539\u53D8\u83DC\u5355\u6309\u94AE\u56FE\u6807</h2><p>\u5229\u7528 VBA \u53EF\u4EE5\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u9ED8\u8BA4\u56FE\u6807\uFF0C\u4F7F\u4E4B\u8FBE\u5230\u81EA\u5B9A\u4E49\u6309\u94AE\u56FE\u6807\u7684\u6548\u679C\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> myCbarCnt<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myCbarCnt <span class="token keyword">As</span> CommandBarControl
	<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">.</span>AddShape<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>SchemeColor <span class="token operator">=</span> <span class="token number">29</span>
		<span class="token punctuation">.</span>CopyPicture
		<span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> myCbarCnt <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Standard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	myCbarCnt<span class="token punctuation">.</span>PasteFace
	<span class="token keyword">Set</span> myCbarCnt <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> DelmyCbarCnt<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Standard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Reset
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>myCbarCnt \u8FC7\u7A0B\u6539\u53D8\u7CFB\u7EDF\u83DC\u5355\u7684\u201C\u65B0\u5EFA\u201D\u6309\u94AE\u7684\u56FE\u6807\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 Shape \u5BF9\u8C61\u7684 AddShape \u65B9\u6CD5\u5728\u5DE5\u4F5C\u8868\u4E2D\u65B0\u5EFA\u4E00\u4E2A\u81EA\u9009\u56FE\u5F62\u3002\u5E94\u7528\u4E8E Shape \u5BF9\u8C61\u7684 AddShape \u65B9\u6CD5\u8BF7\u53C2\u9605 53 \u3002</p><p>\u5728\u672C\u4F8B\u4E2D\u5C06\u65B0\u5EFA\u56FE\u5F62\u7684 Left \u53C2\u6570\u548C Top \u53C2\u6570\u8BBE\u7F6E\u4E3A\u8F83\u5927\u7684\u6570\u503C\u4F7F\u65B0\u5EFA\u7684\u81EA\u9009\u56FE\u5F62\u4E0D\u5728\u5F53\u524D\u7A97\u53E3\u7684\u53EF\u89C6\u533A\u57DF\u5185\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u8BBE\u7F6E\u65B0\u5EFA\u81EA\u9009\u56FE\u5F62\u7684\u989C\u8272\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 CopyPicture \u65B9\u6CD5\u5C06\u65B0\u5EFA\u81EA\u9009\u56FE\u5F62\u4F5C\u4E3A\u56FE\u7247\u590D\u5236\u5230\u526A\u8D34\u677F\u3002CopyPicture \u65B9\u6CD5\u7684\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>CopyPicture<span class="token punctuation">(</span>Appearance<span class="token punctuation">,</span> Format<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u4E00\u4E2A\u6709\u6548\u7684\u5BF9\u8C61\u3002
\u53C2\u6570Appearance\u662F\u53EF\u9009\u7684\uFF0C\u6307\u5B9A\u56FE\u7247\u7684\u590D\u5236\u65B9\u5F0F\u3002
\u53C2\u6570Format\u662F\u53EF\u9009\u7684\uFF0C\u56FE\u7247\u7684\u683C\u5F0F\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u7B2C 6 \u884C\u4EE3\u7801\u4F7F\u7528 Delete \u65B9\u6CD5\u5220\u9664\u65B0\u5EFA\u7684\u81EA\u9009\u56FE\u5F62\u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u4F7F\u7528 Set \u8BED\u53E5\u5C06\u7CFB\u7EDF\u83DC\u5355\u7684\u201C\u65B0\u5EFA\u201D\u6309\u94AE\u8D4B\u7ED9\u53D8\u91CF myCbarCnt\u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801 PasteFace \u65B9\u6CD5\u5C06\u65B0\u5EFA\u7684\u81EA\u9009\u56FE\u5F62\u7C98\u8D34\u5230\u201C\u65B0\u5EFA\u201D\u6309\u94AE\u4E2D\u3002PasteFace \u65B9\u6CD5\u5C06\u201C\u526A\u8D34\u677F\u201D\u7684\u5185\u5BB9\u7C98\u8D34\u5230\u6307\u5B9A\u547D\u4EE4\u680F\u6309\u94AE\u63A7\u4EF6\u4E0A\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>PasteFace

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBarButton\u5BF9\u8C61\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>DelmyCbarCnt \u8FC7\u7A0B\u4F7F\u7528 Reset \u65B9\u6CD5\u6062\u590D\u201C\u65B0\u5EFA\u201D\u6309\u94AE\u7684\u9ED8\u8BA4\u56FE\u6807\u3002</p><p>\u8FD0\u884C myCbarCnt \u8FC7\u7A0B\u7ED3\u679C\u5982\u56FE 84-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+l+`" alt="" loading="lazy"></p><p><u>\u56FE 84-1</u> \u5B9A\u5236\u81EA\u5DF1\u7684\u7CFB\u7EDF\u83DC\u5355</p></div><h2 id="_85\u3001\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u589E\u52A0\u83DC\u5355\u9879" tabindex="-1"><a class="header-anchor" href="#_85\u3001\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u589E\u52A0\u83DC\u5355\u9879" aria-hidden="true">#</a> 85\u3001\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u589E\u52A0\u83DC\u5355\u9879</h2><p>\u5728 Excel \u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u53EF\u4EE5\u6DFB\u52A0\u65B0\u7684\u83DC\u5355\u9879\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> MyCmb<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> MyCmb <span class="token keyword">As</span> CommandBarButton
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Cell&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Reset
		<span class="token keyword">Set</span> MyCmb <span class="token operator">=</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">,</span> <span class="token operator">_</span>
			ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">2521</span><span class="token punctuation">,</span> Before<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> Temporary<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
			MyCmb<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> MyCmb <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>MyCmb \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u5728 Excel \u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u6DFB\u52A0\u5185\u7F6E\u7684\u201C\u6253\u5370\u201D\u83DC\u5355\u9879\u3002</p><p>\u5728\u4F7F\u7528 Add \u65B9\u6CD5\u6DFB\u52A0\u83DC\u5355\u9879\u65F6\u5C06 Id \u53C2\u6570\u8BBE\u7F6E\u4E3A 2521\uFF0C\u6DFB\u52A0\u7684\u5C31\u662F\u5185\u7F6E\u7684\u201C\u6253\u5370\u201D\u83DC\u5355\u9879\u3002\u5C06 Before \u5C5E\u6027\u8BBE\u7F6E\u6210\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u6700\u540E\u4E00\u4E2A\u63A7\u4EF6\u7684\u503C\uFF0C\u4F7F\u201C\u6253\u5370\u201D\u83DC\u5355\u9879\u6DFB\u52A0\u5230\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u6700\u540E\u4E00\u4E2A\u63A7\u4EF6\u4E4B\u524D\u3002\u5C06 Temporary \u53C2\u6570\u8BBE\u7F6E\u6210 True\uFF0C\u5728\u5173\u95ED\u5E94\u7528\u7A0B\u5E8F\u65F6\u4ECE\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u5220\u9664\u201C\u6253\u5370\u201D\u83DC\u5355\u9879\u3002</p><p>\u8FD0\u884C MyCmb \u8FC7\u7A0B\uFF0C\u5C06\u5728 Excel \u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u6DFB\u52A0 \u201C\u6253\u5370\u201D\u83DC\u5355\u9879\uFF0C\u5982\u56FE 85-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+c+`" alt="" loading="lazy"></p><p><u>\u56FE 85-1</u> \u5728\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u4E2D\u6DFB\u52A0\u83DC\u5355\u9879</p></div><h2 id="_86\u3001\u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355" tabindex="-1"><a class="header-anchor" href="#_86\u3001\u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355" aria-hidden="true">#</a> 86\u3001\u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355</h2><p>\u5728\u5DE5\u4F5C\u8868\u4E2D\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u66FF\u6362 Excel \u9ED8\u8BA4\u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Mycell<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;Mycell&quot;</span><span class="token punctuation">,</span> msoBarPopup<span class="token punctuation">)</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u51ED\u8BC1&quot;</span>
			<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">9893</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u8D26\u7C3F&quot;</span>
			<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">284</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlPopup<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u4F1A\u8BA1\u62A5\u8868&quot;</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u6708\u62A5&quot;</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">9590</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5B63\u62A5&quot;</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">9591</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u5E74\u62A5&quot;</span>
				<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">9592</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u51ED\u8BC1\u6253\u5370&quot;</span>
			<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">9614</span>
			<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8D26\u7C3F\u6253\u5370&quot;</span>
			<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">707</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u62A5\u8868\u6253\u5370&quot;</span>
			<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> <span class="token number">986</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Mycell \u8FC7\u7A0B\u5728 Excel \u5DE5\u4F5C\u8868\u4E2D\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u3002</p><p>\u7B2C 2 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u6DFB\u52A0\u540D\u79F0\u4E3A\u201CMycell\u201D\u547D\u4EE4\u680F\uFF0C\u8BBE\u7F6E\u201CMycell\u201D\u547D\u4EE4\u680F\u7684 Position \u5C5E\u6027\u4E3A msoBarPopup\uFF0C\u4F7F\u201CMycell\u201D\u547D\u4EE4\u680F\u4E3A\u5FEB\u6377\u83DC\u5355\u3002\u5173\u4E8E Position \u53C2\u6570\u7684 MsoBarPosition \u5E38\u6570\u8BF7\u53C2\u9605 83 \u4E2D\u7684\u8868\u683C 83-1\u3002</p><p>\u7B2C 3 \u884C\u5230\u7B2C 39 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u201CMycell\u201D\u547D\u4EE4\u680F\u4E2D\u6DFB\u52A0\u83DC\u5355\u548C\u83DC\u5355\u9879\uFF0C\u5E76\u8BBE\u7F6E\u5176\u5404\u9879\u5C5E\u6027\u3002</p><p>\u4E3A\u4E86\u8BA9\u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355\u66FF\u6362 Excel \u9ED8\u8BA4\u7684\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5E76\u4E14\u53EA\u5728\u53F3\u952E\u5355\u51FB Sheet1 \u5DE5\u4F5C\u8868\u65F6\u663E\u793A\uFF0C\u9700\u8981\u5728 Sheet1 \u5DE5\u4F5C\u8868\u7684 BeforeRightClick \u4E8B\u4EF6\u4E2D\u5199\u5165\u4E0B\u9762\u7684\u4EE3\u7801\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_BeforeRightClick<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Mycell&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ShowPopup
	Cancel <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u5DE5\u4F5C\u8868\u7684 BeforeRightClick \u4E8B\u4EF6\u8FC7\u7A0B\uFF0C\u5728\u53F3\u952E\u5355\u51FB\u5DE5\u4F5C\u8868\u65F6\uFF0C\u5C06\u201CMycell\u201D\u547D\u4EE4\u680F\u4F5C\u4E3A\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5728\u5F53\u524D\u5149\u6807\u4F4D\u7F6E\u663E\u793A\u3002</p><p>\u5DE5\u4F5C\u8868 BeforeRightClick \u4E8B\u4EF6\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> expression_BeforeRightClick<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0CWorksheet\u7C7B\u578B\u5BF9\u8C61\u3002
\u53C2\u6570Target \u662F\u53EF\u9009\u7684\uFF0C\u53F3\u952E\u5355\u51FB\u53D1\u751F\u65F6\u6700\u9760\u8FD1\u9F20\u6807\u6307\u9488\u7684\u5355\u5143\u683C\u3002
\u53C2\u6570Cancel\u662F\u53EF\u9009\u7684\uFF0C\u5F53\u4E8B\u4EF6\u53D1\u751F\u65F6\u4E3A<span class="token boolean">False</span>\u3002\u5982\u679C\u5728\u4E8B\u4EF6\u8FC7\u7A0B\u4E2D\u5C06Cancel\u53C2\u6570\u8BBE\u4E3A<span class="token boolean">True</span>\uFF0C\u5219\u8BE5\u8FC7\u7A0B\u6267\u884C\u7ED3\u675F\u4E4B\u540E\u4E0D\u8FDB\u884C\u9ED8\u8BA4\u7684\u53F3\u952E\u5355\u51FB\u64CD\u4F5C\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u7B2C 2 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 ShowPopup \u65B9\u6CD5\u5C06\u201CMycell\u201D\u547D\u4EE4\u680F\u4F5C\u4E3A\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5728\u5F53\u524D\u5149\u6807\u4F4D\u7F6E\u663E\u793A\u3002</p><p>ShowPopup \u65B9\u6CD5\u7684\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>ShowPopup<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBar\u5BF9\u8C61\u3002
\u53C2\u6570x\u662F\u53EF\u9009\u7684\uFF0C\u5FEB\u6377\u83DC\u5355\u6240\u5728\u4F4D\u7F6E\u7684 x \u5750\u6807\u3002\u5982\u679C\u7701\u7565\u6B64\u53C2\u6570\uFF0C\u5C06\u4F7F\u7528\u5F53\u524D\u5149\u6807\u4F4D\u7F6E\u7684x\u5750\u6807\u3002
\u53C2\u6570y\u662F\u53EF\u9009\u7684\uFF0C\u5FEB\u6377\u83DC\u5355\u6240\u5728\u4F4D\u7F6E\u7684y\u5750\u6807\u3002\u5982\u679C\u7701\u7565\u6B64\u53C2\u6570\uFF0C\u5C06\u4F7F\u7528\u5F53\u524D\u5149\u6807\u4F4D\u7F6E\u7684y\u5750\u6807\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u5F53\u7528\u9F20\u6807\u53F3\u952E\u5355\u51FB\u5DE5\u4F5C\u8868\u4E2D\u4EFB\u610F\u5355\u5143\u683C\u65F6\u6FC0\u6D3B BeforeRightClick \u4E8B\u4EF6\uFF0C\u6B64\u4E8B\u4EF6\u5148\u4E8E\u9ED8\u8BA4\u7684\u53F3\u952E\u5355\u51FB\u64CD\u4F5C\u3002\u5728\u4F7F\u7528 ShowPopup \u65B9\u6CD5\u663E\u793A\u201CMycell\u201D\u547D\u4EE4\u680F\u540E\uFF0C\u5C06 Cancel \u53C2\u6570\u8BBE\u7F6E\u4E3A True\uFF0C\u8FC7\u7A0B\u6267\u884C\u7ED3\u675F\u4E4B\u540E\u4E0D\u8FDB\u884C\u9ED8\u8BA4\u7684\u53F3\u952E\u5355\u51FB\u64CD\u4F5C\uFF0CExcel \u53F3\u952E\u5FEB\u6377\u83DC\u5355\u5C31\u4E0D\u4F1A\u663E\u793A\u3002</p><p>\u8FD0\u884C Mycell \u8FC7\u7A0B\u540E\uFF0C\u53F3\u952E\u5355\u51FB Sheet1 \u5DE5\u4F5C\u8868\uFF0C\u5728\u5DE5\u4F5C\u8868\u4E2D\u663E\u793A\u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5982\u56FE 86-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+r+`" alt="" loading="lazy"></p><p><u>\u56FE 86-1</u> \u81EA\u5B9A\u4E49\u53F3\u952E\u5FEB\u6377\u83DC\u5355</p></div><h2 id="_87\u3001\u4F7F\u7528\u53F3\u952E\u83DC\u5355\u5236\u4F5C\u6570\u636E\u6709\u6548\u6027" tabindex="-1"><a class="header-anchor" href="#_87\u3001\u4F7F\u7528\u53F3\u952E\u83DC\u5355\u5236\u4F5C\u6570\u636E\u6709\u6548\u6027" aria-hidden="true">#</a> 87\u3001\u4F7F\u7528\u53F3\u952E\u83DC\u5355\u5236\u4F5C\u6570\u636E\u6709\u6548\u6027</h2><p>\u5728\u5DE5\u4F5C\u8868\u4E2D\u8F93\u5165\u6570\u636E\u65F6\u53EF\u4EE5\u4F7F\u7528\u81EA\u5B9A\u4E49\u53F3\u952E\u83DC\u5355\u5236\u4F5C\u6570\u636E\u6709\u6548\u6027\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Mycell<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> arr <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> Mycell <span class="token keyword">As</span> CommandBar
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Mycell&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	arr <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;\u7ECF\u7406\u5BA4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u529E\u516C\u5BA4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u751F\u6280\u79D1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u8D22\u52A1\u79D1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u8425\u4E1A\u90E8&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> Mycell <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;Mycell&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">4</span>
		<span class="token keyword">With</span> Mycell<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span>Caption <span class="token operator">=</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;MyOnAction&quot;</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> MyOnAction<span class="token punctuation">(</span><span class="token punctuation">)</span>
	ActiveCell <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>ActionControl<span class="token punctuation">.</span>Caption
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Mycell \u8FC7\u7A0B\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u53F3\u952E\u83DC\u5355\uFF0C\u8BF7\u53C2\u9605 86 \u3002</p><p>MyOnAction \u8FC7\u7A0B\u662F\u70B9\u51FB\u81EA\u5B9A\u4E49\u53F3\u952E\u83DC\u5355\u6240\u8FD0\u884C\u7684\u8FC7\u7A0B\uFF0C\u5C06\u6240\u9009\u53F3\u952E\u83DC\u5355\u7684\u540D\u79F0\u5199\u5165\u6D3B\u52A8\u5355\u5143\u683C\u3002</p><p>\u4E3A\u4E86\u4F7F\u81EA\u5B9A\u4E49\u7684\u53F3\u952E\u83DC\u5355\u5728 Sheet1 \u5DE5\u4F5C\u8868\u7684\u7279\u5B9A\u533A\u57DF\u4E2D\u663E\u793A\uFF0C\u9700\u8981\u5728 VBE \u4E2D\u53CC\u51FB Sheet1 \u8868\u540E\u5199\u5165\u4E0B\u9762\u7684\u4EE3\u7801\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_BeforeRightClick<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
	<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
		<span class="token keyword">Call</span> Mycell
		Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Mycell&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ShowPopup
		Cancel <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u5DE5\u4F5C\u8868\u7684 BeforeRightClick \u4E8B\u4EF6\u8FC7\u7A0B\uFF0C\u5728\u53F3\u952E\u5355\u51FB\u5DE5\u4F5C\u8868\u65F6\uFF0C\u5C06\u201CMycell\u201D\u547D\u4EE4\u680F\u4F5C\u4E3A\u53F3\u952E\u5FEB\u6377\u83DC\u5355\uFF0C\u5728\u5F53\u524D\u5149\u6807\u4F4D\u7F6E\u663E\u793A\uFF0C\u8BF7\u53C2\u9605 86 \u3002</p><p>\u5728\u5DE5\u4F5C\u8868\u7684 B \u5217\u4E2D\u70B9\u51FB\u53F3\u952E\u7ED3\u679C\u5982\u56FE 87-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+u+`" alt="" loading="lazy"></p><p><u>\u56FE 87-1</u> \u4F7F\u7528\u53F3\u952E\u83DC\u5355\u5236\u4F5C\u6570\u636E\u6709\u6548\u6027</p></div><h2 id="_88\u3001\u7981\u7528\u5DE5\u4F5C\u8868\u53F3\u952E\u83DC\u5355" tabindex="-1"><a class="header-anchor" href="#_88\u3001\u7981\u7528\u5DE5\u4F5C\u8868\u53F3\u952E\u83DC\u5355" aria-hidden="true">#</a> 88\u3001\u7981\u7528\u5DE5\u4F5C\u8868\u53F3\u952E\u83DC\u5355</h2><p>\u6709\u65F6\u5E76\u4E0D\u5E0C\u671B\u7528\u6237\u4F7F\u7528\u5DE5\u4F5C\u8868\u4E2D\u7684\u53F3\u952E\u83DC\u5355\u5BF9\u5DE5\u4F5C\u8868\u8FDB\u884C\u64CD\u4F5C\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u4EE3\u7801\u7981\u7528\u5DE5\u4F5C\u8868\u53F3\u952E\u83DC\u5355\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DisBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myBar <span class="token keyword">As</span> CommandBar
	<span class="token keyword">For</span> <span class="token keyword">Each</span> myBar <span class="token keyword">In</span> CommandBars
		<span class="token keyword">If</span> myBar<span class="token punctuation">.</span><span class="token keyword">Type</span> <span class="token operator">=</span> msoBarTypePopup <span class="token keyword">Then</span>
			myBar<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>DisBar \u8FC7\u7A0B\u7981\u7528\u5DE5\u4F5C\u8868\u4E2D\u6240\u6709\u7684\u53F3\u952E\u83DC\u5355\u3002</p><p>\u7B2C 3 \u884C\u4EE3\u7801\u4F7F\u7528 For Each...Next \u8BED\u53E5\u904D\u5386 CommandBars \u96C6\u5408\u3002CommandBars \u96C6\u5408\u4EE3\u8868\u5E94\u7528\u7A0B\u5E8F\u4E2D\u6240\u6709\u7684\u547D\u4EE4\u680F\u3002</p><p>\u7B2C 4 \u884C\u4EE3\u7801\u6839\u636E\u547D\u4EE4\u680F\u7684 Type \u5C5E\u6027\u5224\u65AD\u547D\u4EE4\u680F\u662F\u5426\u4E3A\u53F3\u952E\u83DC\u5355\u3002\u5E94\u7528\u4E8E CommandBar \u5BF9\u8C61\u7684 Type \u5C5E\u6027\u8FD4\u56DE\u547D\u4EE4\u680F\u7684\u7C7B\u578B\uFF0C\u53EF\u4EE5\u4E3A\u8868\u683C 88-1 \u6240\u5217\u7684 MsoBarType \u5E38\u91CF\u4E4B\u4E00\u3002</p><p>\u8868\u683C 88-1 MsoBarType \u5E38\u91CF</p><table><thead><tr><th>\u5E38\u91CF</th><th>\u503C</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>msoBarTypeMenuBar</td><td>1</td><td>\u83DC\u5355\u680F</td></tr><tr><td>msoBarTypeNormal</td><td>0</td><td>\u5DE5\u5177\u680F</td></tr><tr><td>msoBarTypePopup</td><td>2</td><td>\u53F3\u952E\u5FEB\u6377\u83DC\u5355</td></tr></tbody></table><p>\u7B2C 5 \u884C\u4EE3\u7801\u5C06 CommandBars \u96C6\u5408\u4E2D\u53F3\u952E\u5FEB\u6377\u83DC\u7684 Enabled \u5C5E\u6027\u8BBE\u7F6E\u4E3A False\uFF0C\u4F7F\u4E4B\u65E0\u6548\u3002</p><p>\u8FD0\u884C DisBar \u8FC7\u7A0B\u5C06\u7981\u7528\u5DE5\u4F5C\u8868\u4E2D\u6240\u6709\u7684\u53F3\u952E\u83DC\u5355\uFF0C\u9700\u8981\u6062\u590D\u65F6\u53EA\u9700\u5C06\u5176 Enabled \u5C5E\u6027\u8BBE\u7F6E\u4E3A True \u5373\u53EF\u3002</p><h2 id="_89\u3001\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F" tabindex="-1"><a class="header-anchor" href="#_89\u3001\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F" aria-hidden="true">#</a> 89\u3001\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F</h2><p>\u4E3A\u4E86\u65B9\u4FBF\u7528\u6237\u64CD\u4F5C\uFF0C\u5728 Excel \u539F\u6709\u7684\u7684\u5DE5\u5177\u680F\u4E0A\uFF0C\u8FD8\u53EF\u4EE5\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u5DE5\u5177\u680F\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> NowToolbar<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> arr <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> id <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> Toolbar <span class="token keyword">As</span> CommandBar
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;MyToolbar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	arr <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;\u4F1A\u8BA1\u51ED\u8BC1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u4F1A\u8BA1\u8D26\u7C3F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u4F1A\u8BA1\u62A5\u8868&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u51ED\u8BC1\u6253\u5370&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u8D26\u7C3F\u6253\u5370&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u62A5\u8868\u6253\u5370&quot;</span><span class="token punctuation">)</span>
	id <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">9893</span><span class="token punctuation">,</span> <span class="token number">284</span><span class="token punctuation">,</span> <span class="token number">9590</span><span class="token punctuation">,</span> <span class="token number">9614</span><span class="token punctuation">,</span> <span class="token number">707</span><span class="token punctuation">,</span> <span class="token number">986</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> Toolbar <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;MyToolbar&quot;</span><span class="token punctuation">,</span> msoBarTop<span class="token punctuation">)</span>
		<span class="token keyword">With</span> Toolbar
			<span class="token punctuation">.</span>Protection <span class="token operator">=</span> msoBarNoResize
			<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">5</span>
				<span class="token keyword">With</span> <span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlButton<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>Caption <span class="token operator">=</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>FaceId <span class="token operator">=</span> id<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
					<span class="token punctuation">.</span>BeginGroup <span class="token operator">=</span> <span class="token boolean">True</span>
					<span class="token punctuation">.</span>Style <span class="token operator">=</span> msoButtonIconAndCaptionBelow
				<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">Next</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> Toolbar <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>NowToolbar \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u5728 Excel \u7A97\u53E3\u4E2D\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u3002\u5E94\u7528\u4E8E CommandBars \u5BF9\u8C61\u7684 Add \u65B9\u6CD5\u8BF7\u53C2\u9605 83 \u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u83DC\u5355\u680F\u4E0A\u521B\u5EFA\u540D\u79F0\u4E3A\u201CMyToolbar\u201D\u7684\u547D\u4EE4\u680F\uFF0C\u521B\u5EFA\u65F6\u8BBE\u7F6E\u65B0\u547D\u4EE4\u680F\u7684 Position \u53C2\u6570\u4E3A msoBarTop\uFF0C\u4F7F\u65B0\u547D\u4EE4\u680F\u4F4D\u4E8E\u5E94\u7528\u7A0B\u5E8F\u7A97\u53E3\u7684\u9876\u90E8\u3002\u5982\u679C\u5C06 Position \u53C2\u6570\u8BBE\u7F6E\u6210 msoBarFloating\uFF0C\u65B0\u547D\u4EE4\u680F\u4E3A\u6D6E\u52A8\u5DE5\u5177\u680F\uFF0C\u5982\u56FE 89-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+i+'" alt="" loading="lazy"></p><p><u>\u56FE 89-1</u> \u6D6E\u52A8\u547D\u4EE4\u680F</p></div><p>\u5173\u4E8E Position \u53C2\u6570\u7684 MsoBarPosition \u5E38\u6570\u8BF7\u53C2\u9605 83 \u4E2D\u7684\u8868\u683C 83-1\u3002</p><p>\u7B2C 12 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u201CMyToolbar\u201D\u547D\u4EE4\u680F\u7684 Protection \u5C5E\u6027\u4E3A msoBarNoResize\u3002\u5E94\u7528\u4E8E CommandBar \u5BF9\u8C61\u7684 Protection \u5C5E\u6027\u6307\u5B9A\u547D\u4EE4\u680F\u7684\u4FDD\u62A4\u7C7B\u578B\uFF0C\u53EF\u4EE5\u4E3A\u8868\u683C 89-1 \u6240\u5217\u7684 MsoBarProtection \u5E38\u6570\u4E4B\u4E00\u3002</p><p><u>\u8868\u683C 89-1</u> MsoBarProtection\u5E38\u6570</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>msoBarNoProtection</td><td>0</td><td>\u4E0D\u53D7\u4FDD\u62A4\uFF0C\u53EF\u81EA\u5B9A\u4E49(\u7F3A\u7701\u503C)</td></tr><tr><td>msoBarNoCustomize</td><td>1</td><td>\u4E0D\u80FD\u81EA\u5B9A\u4E49</td></tr><tr><td>msoBarNoResize</td><td>2</td><td>\u4E0D\u80FD\u8C03\u6574\u5927\u5C0F</td></tr><tr><td>msoBarNoMove</td><td>4</td><td>\u4E0D\u80FD\u79FB\u52A8</td></tr><tr><td>msoBarNoChangeVisible</td><td>8</td><td>\u4E0D\u80FD\u66F4\u6539\u53EF\u89C1\u72B6\u6001</td></tr><tr><td>msoBarNoChangeDock</td><td>16</td><td>\u4E0D\u80FD\u6539\u53D8\u505C\u9760\u7684\u4F4D\u7F6E</td></tr><tr><td>msoBarNoVerticalDock</td><td>32</td><td>\u4E0D\u80FD\u6CBF\u7A97\u53E3\u5DE6\u4FA7\u6216\u53F3\u4FA7\u505C\u653E</td></tr><tr><td>msoBarNoHorizontalDock</td><td>64</td><td>\u4E0D\u80FD\u6CBF\u7A97\u53E3\u9876\u90E8\u6216\u5E95\u90E8\u505C\u653E</td></tr></tbody></table><p>\u7B2C 14 \u884C\u5230\u7B2C 21 \u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u65B0\u547D\u4EE4\u680F\u4E2D\u6DFB\u52A0\u6309\u94AE\u63A7\u4EF6\uFF0C\u8BBE\u7F6E\u6309\u94AE\u63A7\u4EF6\u7684\u5404\u9879\u5C5E\u6027\u3002\u5176\u4E2D\u7B2C 19 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u6309\u94AE\u63A7\u4EF6\u7684 Style \u5C5E\u6027\u4E3A msoButtonIconAndCaptionBelow\uFF0C\u4F7F\u5DE5\u5177\u680F\u6309\u94AE\u663E\u793A\u65F6\u5305\u542B\u56FE\u6807\u548C\u6807\u9898\uFF0C\u4E14\u6807\u9898\u4F4D\u4E8E\u56FE\u6807\u4E4B\u4E0B\u3002</p><p>\u5E94\u7528\u4E8E CommandBar \u5BF9\u8C61\u7684 Style \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u5DE5\u5177\u680F\u6309\u94AE\u7684\u663E\u793A\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u4E3A\u8868\u683C 89-2 \u6240\u5217\u7684 MsoButtonStyle \u5E38\u6570\u4E4B\u4E00\u3002</p><p><u>\u8868\u683C 89-2</u> MsoButtonStyle \u5E38\u6570</p><table><thead><tr><th>\u5E38\u6570</th><th>\u503C</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>msoButtonIcon</td><td>1</td><td>\u5305\u542B\u56FE\u6807\u7684\u6309\u94AE</td></tr><tr><td>msoButtonCaption</td><td>2</td><td>\u5305\u542B\u6807\u9898\u7684\u6309\u94AE</td></tr><tr><td>ButtonIconandCaption</td><td>3</td><td>\u5305\u542B\u56FE\u6807\u548C\u6807\u9898\u7684\u6309\u94AE</td></tr><tr><td>msoButtonIconAndCaptionBelow</td><td>11</td><td>\u5305\u542B\u56FE\u6807\u548C\u6807\u9898\uFF0C\u4E14\u6807\u9898\u4F4D\u4E8E\u5E95\u90E8\u7684\u6309\u94AE</td></tr><tr><td>msoButtonIconAndWrapCaption</td><td>7</td><td>\u5305\u542B\u56FE\u6807\u548C\u6807\u9898\uFF0C\u4E14\u6807\u9898\u81EA\u52A8\u6362\u884C\u7684\u6309\u94AE</td></tr><tr><td>msoButtonWrapCaption</td><td>14</td><td>\u5305\u542B\u6807\u9898\uFF0C\u4E14\u6807\u9898\u81EA\u52A8\u6362\u884C\u7684\u6309\u94AE</td></tr></tbody></table><p>\u8FD0\u884C NowToolbar \u8FC7\u7A0B\uFF0C\u5C06\u5728 Excel \u7A97\u53E3\u7684\u9876\u90E8\u521B\u5EFA\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7684\u5DE5\u5177\u680F\uFF0C\u5982\u56FE 89-2 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="'+k+`" alt="" loading="lazy"></p><p><u>\u56FE 89-2</u> \u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F</p></div><h2 id="_90\u3001\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u6309\u94AE\u56FE\u6807" tabindex="-1"><a class="header-anchor" href="#_90\u3001\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u6309\u94AE\u56FE\u6807" aria-hidden="true">#</a> 90\u3001\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u6309\u94AE\u56FE\u6807</h2><p>\u5728\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u5DE5\u5177\u680F\u65F6\uFF0C\u9664\u4E86\u53EF\u4EE5\u4E3A\u5DE5\u5177\u680F\u6309\u94AE\u6DFB\u52A0 Excel \u5185\u7F6E\u7684\u56FE\u6807\u5916\uFF0C\u8FD8\u80FD\u4E3A\u5DE5\u5177\u680F\u6309\u94AE\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u56FE\u6807\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddCustomButton<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> xBar <span class="token keyword">As</span> CommandBar
	<span class="token keyword">Dim</span> xButton <span class="token keyword">As</span> CommandBarButton
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;CustomBar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">Set</span> xBar <span class="token operator">=</span> CommandBars<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;CustomBar&quot;</span><span class="token punctuation">,</span> msoBarTop<span class="token punctuation">)</span>
	<span class="token keyword">Set</span> xButton <span class="token operator">=</span> xBar<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>msoControlButton<span class="token punctuation">)</span>
	<span class="token keyword">With</span> xButton
		<span class="token punctuation">.</span>Picture <span class="token operator">=</span> LoadPicture<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\P.BMP&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Mask <span class="token operator">=</span> LoadPicture<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\M.BMP&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>TooltipText <span class="token operator">=</span> <span class="token string">&quot;Excel Home \u8BBA\u575B&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	xBar<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">Set</span> xBar <span class="token operator">=</span> <span class="token boolean">Nothing</span>
	<span class="token keyword">Set</span> xButton <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>AddCustomButton \u8FC7\u7A0B\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\uFF0C\u5E76\u8BBE\u7F6E\u5DE5\u5177\u680F\u7684\u6309\u94AE\u81EA\u5B9A\u4E49\u56FE\u6807\u3002</p><p>\u7B2C 6\u30017 \u884C\u4EE3\u7801\uFF0C\u4F7F\u7528 Add \u65B9\u6CD5\u5728 Excel \u7A97\u53E3\u4E2D\u6DFB\u52A0\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u548C\u6309\u94AE\u3002\u8BF7\u53C2\u9605 89 \u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u5DE5\u5177\u680F\u6309\u94AE\u7684 Picture \u5C5E\u6027\u4E3A\u540C\u4E00\u76EE\u5F55\u4E2D\u7684 p.bmp \u56FE\u7247\u3002</p><p>\u5E94\u7528\u4E8E CommandBarButton \u5BF9\u8C61\u7684 Picture \u5C5E\u6027\u8FD4\u56DE\u4E00\u4E2A IPictureDisp \u5BF9\u8C61\uFF0C\u8868\u793A CommandBarButton \u5BF9\u8C61\u7684\u56FE\u50CF\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Picture

\u53C2\u6570\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBarButton\u5BF9\u8C61\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u6307\u5B9A\u5BF9\u8C61\u7684 Picture \u5C5E\u6027\u5C31\u80FD\u8BBE\u7F6E\u5BF9\u8C61\u7684\u56FE\u50CF\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u5DE5\u5177\u680F\u6309\u94AE\u7684 Mask \u5C5E\u6027\u4E3A\u540C\u4E00\u76EE\u5F55\u4E2D\u7684 m.bmp \u56FE\u7247\u3002</p><p>\u4E3A\u4E86\u4F7F\u5DE5\u5177\u680F\u6309\u94AE\u56FE\u6807\u900F\u660E\u663E\u793A\uFF0C\u5728\u6307\u5B9A\u5BF9\u8C61\u7684 Picture \u5C5E\u6027\u540E\uFF0C\u8FD8\u9700\u8981\u6307\u5B9A\u5BF9\u8C61\u7684 Mask \u5C5E\u6027\u3002</p><p>\u5E94\u7528\u4E8E CommandBarButton \u5BF9\u8C61\u7684 Mask \u5C5E\u6027\u8FD4\u56DE\u8868\u793A CommandBarButton \u5BF9\u8C61\u7684\u5C4F\u853D\u56FE\u50CF\u7684 IPictureDisp \u5BF9\u8C61\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Mask

\u53C2\u6570\u662F\u5FC5\u9700\u7684\uFF0C\u8FD4\u56DE\u4E00\u4E2ACommandBarButton\u5BF9\u8C61\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5C4F\u853D\u56FE\u50CF\u51B3\u5B9A\u6309\u94AE\u56FE\u50CF\u900F\u660E\u7684\u90E8\u5206\u3002\u5728\u521B\u5EFA\u4F5C\u4E3A\u5C4F\u853D\u56FE\u50CF\u4F7F\u7528\u7684\u56FE\u50CF\u65F6\uFF0C\u6240\u6709\u8981\u900F\u660E\u7684\u533A\u57DF\u5E94\u8BE5\u4E3A\u767D\u8272\uFF0C\u6240\u6709\u8981\u663E\u793A\u7684\u533A\u57DF\u5E94\u8BE5\u4E3A\u9ED1\u8272\u3002</p><p>\u7B2C 11 \u884C\u4EE3\u7801\uFF0C\u8BBE\u7F6E\u6309\u94AE\u7684\u201C\u5C4F\u5E55\u63D0\u793A\u201D\u4E3A\u201CExcelHome\u8BBA\u575B\u201D\u3002</p><p>\u8FD0\u884C AddCustomButton \u8FC7\u7A0B\uFF0C\u521B\u5EFA\u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\uFF0C\u5E76\u8BBE\u7F6E\u5DE5\u5177\u680F\u6309\u94AE\u7684\u56FE\u6807\uFF0C\u5982\u56FE 90-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+d+`" alt="" loading="lazy"></p><p><u>\u56FE 90-1</u> \u81EA\u5B9A\u4E49\u5DE5\u5177\u680F\u56FE\u6807</p></div><h2 id="_91\u3001\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u56FE\u6807" tabindex="-1"><a class="header-anchor" href="#_91\u3001\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u56FE\u6807" aria-hidden="true">#</a> 91\u3001\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u56FE\u6807</h2><p>Excel \u6807\u9898\u680F\u7684\u56FE\u6807\u662F\u9ED8\u8BA4\u7684\uFF0C\u800C\u501F\u52A9 API \u51FD\u6570\u53EF\u4EE5\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u6807\u9898\u680F\u56FE\u6807\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> FindWindow <span class="token keyword">Lib</span> <span class="token string">&quot;user32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindWindowA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpClassName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpWindowName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> DrawMenuBar <span class="token keyword">Lib</span> <span class="token string">&quot;user32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> SetFocus <span class="token keyword">Lib</span> <span class="token string">&quot;user32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> SendMessage <span class="token keyword">Lib</span> <span class="token string">&quot;user32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SendMessageA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wMsg <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wParam <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> ExtractIcon <span class="token keyword">Lib</span> <span class="token string">&quot;shell32.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ExtractIconA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hInst <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszExeFileName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nIconIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> WM_SETICON <span class="token operator">=</span> <span class="token number">&amp;H80</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> IStyle <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">Dim</span> hIcon <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">Dim</span> hWndForm <span class="token keyword">As</span> <span class="token keyword">Long</span>
	hWndForm <span class="token operator">=</span> FindWindow<span class="token punctuation">(</span>vbNullString<span class="token punctuation">,</span> Application<span class="token punctuation">.</span>Caption<span class="token punctuation">)</span>
	hIcon <span class="token operator">=</span> ExtractIcon<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ActiveWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\\p.bmp&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	SendMessage hWndForm<span class="token punctuation">,</span> WM_SETICON<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> hIcon
	SendMessage hWndForm<span class="token punctuation">,</span> WM_SETICON<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> hIcon
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u5DE5\u4F5C\u7C3F\u6253\u5F00\u540E\u4F7F\u7528 API \u51FD\u6570\u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u6807\u9898\u680F\u7684\u56FE\u6807\u3002</p><p>\u7B2C 1 \u884C\u5230\u7B2C 6 \u884C\u4EE3\u7801\uFF0CAPI \u51FD\u6570\u58F0\u660E\u3002</p><p>\u7B2C 7 \u884C\u5230\u7B2C 15 \u884C\u4EE3\u7801\uFF0C\u5DE5\u4F5C\u7C3F\u7684 Open \u4E8B\u4EF6\u8FC7\u7A0B\uFF0C\u628A\u5DE5\u4F5C\u7C3F\u6807\u9898\u680F\u9ED8\u8BA4\u7684\u56FE\u6807\u66F4\u6539\u4E3A\u540C\u4E00\u6587\u4EF6\u5939\u4E0B\u7684 p.bmp \u56FE\u7247\u3002</p><p>\u5DE5\u4F5C\u7C3F\u6253\u5F00\u540E\u6807\u9898\u680F\u5982\u56FE 91-1 \u6240\u793A\uFF0C\u4EFB\u52A1\u680F\u56FE\u6807\u5982\u56FE 91-2 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+b+'" alt="" loading="lazy"></p><p><u>\u56FE 91-1</u> \u81EA\u5B9A\u4E49\u5DE5\u4F5C\u7C3F\u6807\u9898\u548C\u56FE\u6807</p><p><img src="'+m+`" alt="" loading="lazy"></p><p><u>\u56FE 91-2</u> \u4EFB\u52A1\u680F\u56FE\u6807</p></div><h2 id="_92\u3001\u79FB\u9664\u5DE5\u4F5C\u8868\u7684\u6700\u5C0F\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE" tabindex="-1"><a class="header-anchor" href="#_92\u3001\u79FB\u9664\u5DE5\u4F5C\u8868\u7684\u6700\u5C0F\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE" aria-hidden="true">#</a> 92\u3001\u79FB\u9664\u5DE5\u4F5C\u8868\u7684\u6700\u5C0F\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE</h2><p>\u5982\u679C\u4E0D\u5E0C\u671B\u5DE5\u4F5C\u8868\u7684\u6700\u5C0F\u3001\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE\u51FA\u73B0\u5728\u83DC\u5355\u680F\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u4EE3\u7801\u53BB\u9664\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>ActiveWorkbook<span class="token punctuation">.</span>Protect <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token boolean">True</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u4F7F\u7528 Protect \u65B9\u6CD5\u5BF9\u5DE5\u4F5C\u7C3F\u8FDB\u884C\u4FDD\u62A4\u3002Protect \u65B9\u6CD5\u5E94\u7528\u4E8E Workbook \u5BF9\u8C61\u7684\u65F6\u4FDD\u62A4\u5DE5\u4F5C\u7C3F\u4F7F\u5176\u4E0D\u81F3\u88AB\u4FEE\u6539\uFF0C\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Protect<span class="token punctuation">(</span>Password<span class="token punctuation">,</span> <span class="token keyword">Structure</span><span class="token punctuation">,</span> Windows<span class="token punctuation">)</span>

\u53C2\u6570expression\u662F\u5FC5\u9700\u7684\uFF0C\u8BE5\u8868\u8FBE\u5F0F\u8FD4\u56DE\u4E00\u4E2AWorkbook\u5BF9\u8C61\u3002
\u53C2\u6570Password\u662F\u53EF\u9009\u7684\uFF0C\u4E3A\u5DE5\u4F5C\u8868\u6216\u5DE5\u4F5C\u7C3F\u6307\u5B9A\u533A\u5206\u5927\u5C0F\u5199\u7684\u5BC6\u7801\u3002
\u53C2\u6570<span class="token keyword">Structure</span>\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u4E3A<span class="token boolean">True</span>\uFF0C\u5219\u4FDD\u62A4\u5DE5\u4F5C\u7C3F\u7ED3\u6784\uFF08\u5DE5\u4F5C\u8868\u7684\u76F8\u5BF9\u4F4D\u7F6E\uFF09\u3002\u9ED8\u8BA4\u503C\u4E3A<span class="token boolean">False</span>\u3002
\u53C2\u6570Windows\u662F\u53EF\u9009\u7684\uFF0C\u5982\u679C\u4E3A<span class="token boolean">True</span>\uFF0C\u5219\u4FDD\u62A4\u5DE5\u4F5C\u7C3F\u7A97\u53E3\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u6062\u590D\u5DE5\u4F5C\u8868\u7684\u6700\u5927\u3001\u6700\u5C0F\u5316\u548C\u5173\u95ED\u6309\u94AE\u7684\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>ActiveWorkbook<span class="token punctuation">.</span>Protect <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token boolean">False</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u5728\u672C\u4F8B\u4E2D\u5C06 Windows \u53C2\u6570\u8BBE\u7F6E\u4E3A True\uFF0C\u4F7F\u5DE5\u4F5C\u7C3F\u7A97\u53E3\u53D7\u5230\u4FDD\u62A4\uFF0C\u5DE5\u4F5C\u8868\u7684\u6700\u5C0F\u3001\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE\u53CA\u56FE\u6807\u4E0D\u51FA\u73B0\u5728\u83DC\u5355\u680F\u4E2D\uFF0C\u5982\u56FE 92-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+y+`" alt="" loading="lazy"></p><p><u>\u56FE 92-1</u> \u79FB\u9664\u5DE5\u4F5C\u8868\u6700\u5C0F\u3001\u6700\u5927\u5316\u548C\u5173\u95ED\u6309\u94AE</p></div><h2 id="_93\u3001\u5728\u5DE5\u5177\u680F\u4E0A\u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u6846" tabindex="-1"><a class="header-anchor" href="#_93\u3001\u5728\u5DE5\u5177\u680F\u4E0A\u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u6846" aria-hidden="true">#</a> 93\u3001\u5728\u5DE5\u5177\u680F\u4E0A\u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u6846</h2><p>\u5982\u679C\u9700\u8981\u5728\u5DE5\u5177\u680F\u4E2D\u6DFB\u52A0\u7C7B\u4F3C\u201C\u5B57\u4F53\u201D\u8FD9\u6837\u7684\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u4EE3\u7801\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddDropdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myDropdown <span class="token keyword">As</span> <span class="token keyword">Object</span>
	<span class="token keyword">Dim</span> myCap <span class="token keyword">As</span> <span class="token keyword">Variant</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	myCap <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;\u57FA\u7840\u5E94\u7528&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VBA\u7A0B\u5E8F\u5F00\u53D1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u51FD\u6570\u4E0E\u516C\u5F0F&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">Call</span> DeleteButton
	<span class="token keyword">Set</span> myDropdown <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Formatting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls <span class="token operator">_</span>
		<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span>msoControlDropdown<span class="token punctuation">,</span> Before<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> myDropdown
		<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8BF7\u9009\u62E9\u7248\u5757&quot;</span>
		<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;myOnA&quot;</span>
		<span class="token punctuation">.</span>Style <span class="token operator">=</span> msoComboNormal
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myCap<span class="token punctuation">)</span>
			<span class="token punctuation">.</span>AddItem myCap<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">Next</span>
		<span class="token punctuation">.</span>ListIndex <span class="token operator">=</span> <span class="token number">1</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> DeleteButton<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Formatting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">If</span> <span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">&quot;\u8BF7\u9009\u62E9\u7248\u5757&quot;</span> <span class="token keyword">Then</span> <span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> myOnA<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myList <span class="token keyword">As</span> <span class="token keyword">Byte</span>
	myList <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span><span class="token string">&quot;Formatting&quot;</span><span class="token punctuation">)</span> <span class="token operator">_</span>
		<span class="token punctuation">.</span>Controls<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ListIndex
	ActiveWorkbook<span class="token punctuation">.</span>FollowHyperlink <span class="token operator">_</span>
	Address<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;http://club.excelhome.net/forum-&quot;</span> <span class="token operator">&amp;</span> myList <span class="token operator">&amp;</span> <span class="token string">&quot;-1.html&quot;</span><span class="token punctuation">,</span> NewWindow<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>AddDropdown \u8FC7\u7A0B\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u5DE5\u5177\u680F\u4E2D\u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u3002</p><p>\u7B2C 5 \u884C\u4EE3\u7801\u4F7F\u7528 Array \u51FD\u6570\u521B\u5EFA\u4E00\u4E2A\u6570\u7EC4\u7528\u4E8E\u4FDD\u5B58\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u52A0\u8F7D\u5217\u8868\u9879\u6240\u9700\u7684\u5143\u7D20\u3002</p><p>\u7B2C 6 \u884C\u4EE3\u7801\u5148\u8FD0\u884C\u7B2C 19 \u884C\u5230\u7B2C 23 \u884C\u7684 DeleteButton \u8FC7\u7A0B\u5220\u9664\u53EF\u80FD\u5B58\u5728\u7684\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\uFF0C\u4EE5\u514D\u91CD\u590D\u6DFB\u52A0\u3002DeleteButton \u8FC7\u7A0B\u5224\u65AD\u5DE5\u5177\u680F\u4E2D\u7B2C\u4E00\u4E2A\u63A7\u4EF6\u7684 Caption \u5C5E\u6027\u662F\u5426\u4E3A\u201C\u8BF7\u9009\u62E9\u7248\u5757\u201D\uFF0C\u5982\u679C\u662F\u5219\u5220\u9664\u8BE5\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u3002</p><p>\u7B2C 7\u30018 \u884C\u4EE3\u7801\u4F7F\u7528 Add \u65B9\u6CD5\u5728\u5DE5\u5177\u680F\u4E2D\u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u3002\u5E94\u7528\u4E8E CommandBarControls \u5BF9\u8C61\u7684 Add \u65B9\u6CD5\u8BF7\u53C2\u9605 79 \u3002\u793A\u4F8B\u4E2D\u5C06\u5176\u53C2\u6570 Type \u8BBE\u7F6E\u4E3A msoControlDropdown\uFF0C\u6DFB\u52A0\u7684\u5C31\u662F\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u3002</p><p>\u7B2C 10 \u884C\u4EE3\u7801\u8BBE\u7F6E\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684 Caption \u5C5E\u6027\uFF0C\u5E94\u7528\u4E8E CommandBarControls \u5BF9\u8C61\u7684 Caption \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u6307\u5B9A\u547D\u4EE4\u680F\u63A7\u4EF6\u7684\u9898\u6CE8\u6587\u5B57\uFF0C\u4E5F\u53EF\u4F5C\u4E3A\u9ED8\u8BA4\u7684\u201C\u5C4F\u5E55\u63D0\u793A\u201D\u663E\u793A\u3002</p><p>\u7B2C 11 \u884C\u4EE3\u7801\u8BBE\u7F6E\u6539\u53D8\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684\u5185\u5BB9\u65F6\u8981\u8FD0\u884C\u7684\u8FC7\u7A0B\u4E3A\u7B2C 24 \u884C\u5230\u7B2C 30 \u884C\u4EE3\u7801\u7684 myOnA \u8FC7\u7A0B\u3002myOnA \u8FC7\u7A0B\u6839\u636E\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684 ListIndex \u5C5E\u6027\u503C\u6253\u5F00 Excel Home \u8BBA\u575B\u4E2D\u76F8\u5E94\u7684\u7248\u5757\u3002</p><p>\u7B2C 12 \u884C\u4EE3\u7801\u8BBE\u7F6E\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684\u6837\u5F0F\u3002Style \u5C5E\u6027\u8FD4\u56DE\u6216\u8BBE\u7F6E\u547D\u4EE4\u680F\u63A7\u4EF6\u7684\u663E\u793A\u65B9\u5F0F\uFF0C\u8BE5\u5C5E\u6027\u503C\u53EF\u8BBE\u7F6E\u4E3A\u8868\u683C 93-1 \u6240\u5217 MsoComboStyle \u5E38\u91CF\u4E4B\u4E00\u3002</p><p>\u8868\u683C 93-1 MsoComboStyle \u5E38\u91CF</p><table><thead><tr><th>\u5E38\u91CF</th><th>\u503C</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>msoComboLabel</td><td>1</td><td>\u663E\u793A\u6807\u7B7E</td></tr><tr><td>msoComboNormal</td><td>0</td><td>\u4E0D\u663E\u793A\u6807\u7B7E</td></tr></tbody></table><p>\u7B2C 13 \u884C\u5230\u7B2C 15 \u884C\u4EE3\u7801\u4F7F\u7528 AddItem \u65B9\u6CD5\u5C06\u6570\u7EC4\u4E2D\u7684\u5143\u7D20\u6DFB\u52A0\u5230\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684\u5217\u8868\u9879\u4E2D\u3002</p><p>\u7B2C 16 \u884C\u4EE3\u7801\u5C06\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6\u7684 ListIndex \u5C5E\u6027\u8BBE\u7F6E\u4E3A 1\uFF0C\u4F7F\u5176\u663E\u793A\u7B2C\u4E00\u6761\u5217\u8868\u9879\u3002</p><p>\u8FD0\u884C AddDropdown \u8FC7\u7A0B\uFF0C\u5DE5\u5177\u680F\u5982\u56FE 93-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+w+`" alt="" loading="lazy"></p><p><u>\u56FE 93-1</u> \u6DFB\u52A0\u4E0B\u62C9\u5217\u8868\u63A7\u5236\u6846\u63A7\u4EF6</p></div><h2 id="_94\u3001\u5C4F\u853D\u5DE5\u4F5C\u8868\u7684\u590D\u5236\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#_94\u3001\u5C4F\u853D\u5DE5\u4F5C\u8868\u7684\u590D\u5236\u529F\u80FD" aria-hidden="true">#</a> 94\u3001\u5C4F\u853D\u5DE5\u4F5C\u8868\u7684\u590D\u5236\u529F\u80FD</h2><p>\u6709\u65F6\u6211\u4EEC\u5E76\u4E0D\u5E0C\u671B\u7528\u6237\u5BF9\u5DE5\u4F5C\u8868\u4E2D\u7684\u6570\u636E\u8FDB\u884C\u590D\u5236\u7C98\u8D34\u64CD\u4F5C\uFF0C\u6B64\u65F6\u53EF\u4EE5\u628A\u6240\u6709\u7684\u590D\u5236\u529F\u80FD\u90FD\u5C4F\u853D\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>	<span class="token keyword">Dim</span> CmdCtrls <span class="token keyword">As</span> CommandBarControls
	<span class="token keyword">Dim</span> Cmd <span class="token keyword">As</span> CommandBarControl
<span class="token keyword">Sub</span> ProCopy<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> CmdCtrls <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>FindControls<span class="token punctuation">(</span>ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Cmd <span class="token keyword">In</span> CmdCtrls
		Cmd<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
	<span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>CellDragAndDrop <span class="token operator">=</span> <span class="token boolean">False</span>
	Application<span class="token punctuation">.</span>OnKey <span class="token punctuation">(</span><span class="token string">&quot;^c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> StaCopy<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> CmdCtrls <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>FindControls<span class="token punctuation">(</span>ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Cmd <span class="token keyword">In</span> CmdCtrls
		Cmd<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>CellDragAndDrop <span class="token operator">=</span> <span class="token boolean">True</span>
	Application<span class="token punctuation">.</span>OnKey <span class="token punctuation">(</span><span class="token string">&quot;^c&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>\u7B2C 1\u30012 \u884C\u4EE3\u7801\u5728\u6A21\u5757\u9876\u90E8\u58F0\u660E\u4E24\u4E2A\u6A21\u5757\u7EA7\u7684\u53D8\u91CF\u3002</p><p>\u7B2C 3 \u884C\u5230\u7B2C 10 \u884C\u4EE3\u7801 ProCopy \u8FC7\u7A0B\uFF0C\u5C4F\u853D\u5DE5\u4F5C\u8868\u4E2D\u6240\u6709\u7684\u590D\u5236\u529F\u80FD\u3002\u5176\u4E2D\u7B2C 4 \u884C\u5230\u7B2C 7 \u884C\u4EE3\u7801\u4F7F\u7528 FindControls \u65B9\u6CD5\u5C06\u6240\u6709\u4E0E\u201C\u590D\u5236\u201D\u76F8\u5173\u7684\u547D\u4EE4\u680F\u63A7\u4EF6\u8D4B\u7ED9\u53D8\u91CF CmdCtrls \u540E\u5C06\u5176 Enabled \u8BBE\u7F6E\u4E3A False\u3002\u5173\u4E8E FindControls \u65B9\u6CD5\u8BF7\u53C2\u9605 80 \u3002</p><p>\u7B2C 8 \u884C\u4EE3\u7801\u5C4F\u853D\u5355\u5143\u683C\u62D6\u653E\u529F\u80FD\uFF0C\u5173\u4E8E\u5E94\u7528\u4E8E Application \u5BF9\u8C61\u7684 CellDragAndDrop \u5C5E\u6027\u8BF7\u53C2\u9605 10 \u3002</p><p>\u7B2C 9 \u884C\u4EE3\u7801\u5C4F\u853D &lt;Ctrl+C&gt; \u7EC4\u5408\u952E\u529F\u80FD\uFF0C\u5173\u4E8E\u5E94\u7528\u4E8E Application \u5BF9\u8C61\u7684 OnKey \u65B9\u6CD5\u8BF7\u53C2\u9605 68 \u3002</p><p>\u7B2C 11 \u884C\u5230\u7B2C 18 \u884C\u4EE3\u7801 StaCopy \u8FC7\u7A0B\uFF0C\u6062\u590D\u6240\u6709\u7684\u590D\u5236\u529F\u80FD\u3002</p><h2 id="_95\u3001\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49" tabindex="-1"><a class="header-anchor" href="#_95\u3001\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49" aria-hidden="true">#</a> 95\u3001\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49</h2><p>\u5728 Excel \u4E2D\uFF0C\u7528\u6237\u53EF\u4EE5\u901A\u8FC7\u4F9D\u6B21\u5355\u51FB\u83DC\u5355\u201C\u89C6\u56FE\u201D\u2192\u201C\u5DE5\u5177\u680F\u201D\u2192\u201C\u81EA\u5B9A\u4E49\u201D\uFF0C\u663E\u793A\u201C\u81EA\u5B9A\u4E49\u201D\u9009\u9879\u5361\u6765\u8C03\u6574\u83DC\u5355\u680F\u548C\u5DE5\u5177\u680F\uFF0C\u5982\u56FE 95-1\u3001\u56FE 95-2 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+g+'" alt="" loading="lazy"></p><p><u>\u56FE 95-1</u> \u81EA\u5B9A\u4E49\u529F\u80FD</p><p><img src="'+C+`" alt="" loading="lazy"></p><p><u>\u56FE 95-2</u> \u81EA\u5B9A\u4E49\u9009\u9879\u5361</p></div><p>\u5982\u679C\u4E0D\u5E0C\u671B\u7528\u6237\u4F7F\u7528\u201C\u81EA\u5B9A\u4E49\u201D\u9009\u9879\u5361\u6765\u8C03\u6574\u83DC\u5355\u680F\u548C\u5DE5\u5177\u680F\uFF0C\u53EF\u4EE5\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49\u529F\u80FD\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> nCustomize<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>DisableCustomize <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>nCustomize \u8FC7\u7A0B\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49\u529F\u80FD\uFF0C\u5E94\u7528\u4E8E CommandBars \u96C6\u5408\u5BF9\u8C61\u7684DisableCustomize \u5C5E\u6027\u8BBE\u7F6E\u662F\u5426\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49\u3002\u5982\u679C\u7981\u7528\uFF0C\u8FD4\u56DE True\uFF0C\u5426\u5219\u8FD4\u56DE False\u3002</p><p>\u7528\u4E8E\u542F\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49\u7684\u4EE3\u7801\u662F\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> yCustomize<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>DisableCustomize <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u8FD0\u884C nCustomize \u8FC7\u7A0B\uFF0C\u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49\u5BF9\u8BDD\u6846\uFF0C\u81EA\u5B9A\u4E49\u83DC\u5355\u9879\u6D88\u5931,\u5982\u56FE 95-3 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+v+`" alt="" loading="lazy"></p><p><u>\u56FE 95-3</u> \u7981\u7528\u5DE5\u5177\u680F\u7684\u81EA\u5B9A\u4E49</p><h2 id="_96\u3001\u5C4F\u853D\u6240\u6709\u7684\u547D\u4EE4\u680F" tabindex="-1"><a class="header-anchor" href="#_96\u3001\u5C4F\u853D\u6240\u6709\u7684\u547D\u4EE4\u680F" aria-hidden="true">#</a> 96\u3001\u5C4F\u853D\u6240\u6709\u7684\u547D\u4EE4\u680F</h2><p>\u5728\u4F7F\u7528\u81EA\u5B9A\u4E49\u7684\u64CD\u4F5C\u754C\u9762\u65F6\uFF0C\u9700\u8981\u5C4F\u853D Excel \u4E2D\u6240\u6709\u7684\u547D\u4EE4\u680F\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u4EE3\u7801\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Shielding_1<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Count
		Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Shielding_1 \u8FC7\u7A0B\u4F7F\u7528 For...Next \u8BED\u53E5\u904D\u5386 Excel \u547D\u4EE4\u680F\uFF0C\u5E76\u5C06\u5176 Enabled \u5C5E\u6027\u8BBE\u7F6E\u4E3A False\uFF0C\u4F7F\u4E4B\u65E0\u6548\u3002</p><p>\u8FD8\u53EF\u4EE5\u4F7F\u7528 For Each...Next \u8BED\u53E5\u904D\u5386\u6240\u6709\u7684 CommandBars \u5BF9\u8C61\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Shielding_2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Cmd <span class="token keyword">As</span> CommandBar
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Cmd <span class="token keyword">In</span> Application<span class="token punctuation">.</span>CommandBars
		Cmd<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">False</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u8FD0\u884C Shielding_1 \u6216 Shielding_2 \u8FC7\u7A0B\u5DE5\u4F5C\u7C3F\u5982\u56FE 96-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+h+`" alt="" loading="lazy"></p><p><u>\u56FE 96-1</u> \u5C4F\u853D\u6240\u6709\u7684\u547D\u4EE4\u680F</p></div></div><p>\u5728\u9700\u8981\u6062\u590D\u65F6\u53EA\u9700\u5C06 Enabled \u5C5E\u6027\u8BBE\u7F6E\u4E3A True \u5373\u53EF\uFF0C\u5982\u4E0B\u9762\u7684\u4EE3\u7801\u6240\u793A\u3002</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Recovery_1<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>Count
		Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> Recover_2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Cmd <span class="token keyword">As</span> CommandBar
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Cmd <span class="token keyword">In</span> Application<span class="token punctuation">.</span>CommandBars
		Cmd<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u4EE3\u7801\u89E3\u6790\uFF1A</p><p>Recovery_1 \u548C Recover_2 \u8FC7\u7A0B\u5206\u522B\u4F7F\u7528 For...Next \u8BED\u53E5\u548C For Each...Next \u8BED\u53E5\u904D\u5386\u6240\u6709\u7684 CommandBars \u5BF9\u8C61\uFF0C\u8BBE\u7F6E\u5176 Enabled \u5C5E\u6027\u4E3A True\uFF0C\u663E\u793A\u6240\u6709\u7684\u547D\u4EE4\u680F\u3002</p><h2 id="_97\u3001\u6062\u590D-excel-\u7684\u547D\u4EE4\u680F" tabindex="-1"><a class="header-anchor" href="#_97\u3001\u6062\u590D-excel-\u7684\u547D\u4EE4\u680F" aria-hidden="true">#</a> 97\u3001\u6062\u590D Excel \u7684\u547D\u4EE4\u680F</h2><p>\u5982\u679C\u7528\u6237\u7ECF\u5E38\u6DFB\u52A0\u3001\u5220\u9664 Excel \u7684\u83DC\u5355\u548C\u5DE5\u5177\u680F\u800C\u53C8\u6CA1\u6709\u53CA\u65F6\u6062\u590D\u7684\u8BDD\uFF0C\u6709\u65F6\u4F1A\u7834\u574F Excel \u9ED8\u8BA4\u7684\u7528\u6237\u754C\u9762\uFF0C\u5373\u4F7F\u7528 Reset \u65B9\u6CD5\u4E5F\u4E0D\u80FD\u6062\u590D\u6210\u521D\u59CB\u72B6\u6001\u3002</p><p>\u6B64\u65F6\u53EF\u4EE5\u5728\u7535\u8111\u7684\u672C\u5730\u786C\u76D8\u4E2D\u67E5\u627E\u6269\u5C55\u540D\u4E3A *.xlb \u7684\u6587\u4EF6\uFF0C\u8BE5\u6587\u4EF6\u5728\u7535\u8111\u4E2D\u7684\u4F4D\u7F6E\u4F1A\u56E0 Excel \u7248\u672C\u7684\u4E0D\u540C\u800C\u4E0D\u540C\uFF0C\u5728 XP \u64CD\u4F5C\u7CFB\u7EDF\u4E2D\uFF0C\u8BE5\u6587\u4EF6\u4F4D\u4E8E\u7CFB\u7EDF\u76D8\u7684 <code>Documents and Settings\\Administrator\\Application Data\\Microsoft\\Excel</code> \u6587\u4EF6\u5939\uFF0C\u5176\u4E2D Administrator \u662F\u7535\u8111\u7684\u7528\u6237\u540D\u3002\u627E\u5230\u5B83\u6700\u7B80\u5355\u7684\u65B9\u6CD5\u662F\u4F7F\u7528 Windows \u7684\u641C\u7D22\u529F\u80FD\u3002\u6309 &lt;Win+F&gt; \u7EC4\u5408\u952E\u8C03\u51FA Windows \u7684\u641C\u7D22\u7A97\u53E3\uFF0C\u7136\u540E\u7528 *.xlb \u4E3A\u76EE\u6807\u5728\u672C\u5730\u786C\u76D8\u4E2D\u8FDB\u884C\u641C\u7D22\uFF0C\u5982\u56FE 97-1 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="`+B+'" alt="" loading="lazy"></p><p><u>\u56FE 97-1</u> \u641C\u7D22 *.xlb \u6587\u4EF6</p></div><p>\u5982\u679C\u641C\u7D22\u6CA1\u6709\u7ED3\u679C\uFF0C\u8BF7\u68C0\u67E5\u201C\u66F4\u591A\u9AD8\u7EA7\u9009\u9879\u201D\u4E2D\u662F\u5426\u9009\u4E2D\u201C\u641C\u7D22\u9690\u85CF\u7684\u6587\u4EF6\u548C\u6587\u4EF6\u5939\u201D\u9009\u9879\uFF0C\u5982\u56FE 97-2 \u6240\u793A\u3002</p><div class="custom-container center"><p><img src="'+A+'" alt="" loading="lazy"></p><p><u>\u56FE 97-2</u> \u641C\u7D22\u9690\u85CF\u7684\u6587\u4EF6\u548C\u6587\u4EF6\u5939</p></div><p>\u5BF9 Excel \u7528\u6237\u754C\u9762\u7684\u4EFB\u4F55\u4FEE\u6539\u90FD\u4F1A\u4FDD\u5B58\u5728 *.xlb \u6587\u4EF6\u4E2D\uFF0C\u627E\u5230\u540E\u5220\u9664\u8BE5\u6587\u4EF6\uFF0C\u7136\u540E\u91CD\u65B0\u542F\u52A8 Excel\u3002Excel \u4F1A\u91CD\u65B0\u521B\u5EFA\u4E00\u4E2A *.xlb \u6587\u4EF6\uFF0C\u800C\u83DC\u5355\u548C\u5DE5\u5177\u680F\u4E5F\u4F1A\u5168\u90E8\u6062\u590D\u6210\u521D\u59CB\u72B6\u6001\u3002</p>',273);function S(T,E){return x}var F=n(q,[["render",S]]);export{F as default};
