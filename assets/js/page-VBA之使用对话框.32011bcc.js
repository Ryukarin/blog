(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{1112:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_73、使用-msgbox-函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_73、使用-msgbox-函数"}},[s._v("#")]),s._v(" 73、使用 Msgbox 函数")]),s._v(" "),n("h3",{attrs:{id:"_1-显示简单的提示信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-显示简单的提示信息"}},[s._v("#")]),s._v(" 1）显示简单的提示信息")]),s._v(" "),n("p",[s._v("在使用Excel的过程中，如果需要向用户显示简单的提示信息，可以使用MsgBox函数显示一个消息框，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" mymsgbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"欢迎光临Excel Home!"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("Mymsgbox 过程使用 MsgBox 函数显示一个消息框。MsgBox 函数用于显示提示信息，语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("MsgBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prompt["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buttons] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" helpfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n参数prompt是必需的，代表在消息框中作为信息显示的字符或字符串，最多只能接受约"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("个字符，取决于所使用字符的宽度。\n参数buttons是可选的，用于指定消息框中显示按钮的数目及类型、使用的图标样式、缺省按钮以及消息框的强制回应等。如果省略，则buttons参数的缺省值为"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，消息框只显示"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“确定”")]),s._v("按钮。\n参数title是可选的，代表在消息框标题栏中作为标题的字符或字符串。如果省略，则在标题栏中显示"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“Microsoft Excel”")]),s._v("。\n参数helpfile和参数context是可选的，用来为消息框提供上下文相关帮助的帮助文件和帮助主题。如果提供了其中一个参数，则必须提供另一个参数，两者缺一不可。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("运行 Mymsgbox 过程，显示如图 73-1 所示的消息框。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(779),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-1")]),s._v("\t简单的信息提示")])]),s._v(" "),n("h3",{attrs:{id:"_2-定制个性化的消息框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-定制个性化的消息框"}},[s._v("#")]),s._v(" 2）定制个性化的消息框")]),s._v(" "),n("p",[s._v("如果希望 MsgBox 函数显示的消息框具有特定的按钮、图标和标题栏，那么可以使用 MsgBox 函数的 buttons 参数和 title 参数，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Specialmsbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tMsgBox Prompt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"欢迎光临 Excel Home!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\tButtons"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vbOKCancel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vbInformation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\tTitle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Excel Home"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("Specialmsbox 过程使用 MsgBox 函数显示一个具有特定的按钮、图标和标题栏的消息框。")]),s._v(" "),n("p",[s._v("第 3 行代码设置消息框的 Buttons 参数，使消息框显示时具有“确定”、“取消”按钮和信息消息图标。MsgBox 函数的 buttons 参数设置值如表格 73-1 所示。")]),s._v(" "),n("p",[n("u",[s._v("表格 73-1")]),s._v("\tMsgBox 函数的 buttons 参数值")]),s._v(" "),n("table",{attrs:{border:"1"}},[n("tr",[n("th",[s._v("参数组")]),s._v(" "),n("th",[s._v("常数")]),s._v(" "),n("th",[s._v("值")]),s._v(" "),n("th",[s._v("描述")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"6"}},[s._v("第一组设置消息框按钮数目和类型")]),s._v(" "),n("td",[s._v("vbOKOnly")]),s._v(" "),n("td",[s._v("0")]),s._v(" "),n("td",[s._v("只显示“确定”按钮（默认设置）")])]),s._v(" "),n("tr",[n("td",[s._v("VbOKCancel")]),s._v(" "),n("td",[s._v("1")]),s._v(" "),n("td",[s._v("显示“确定”和“取消”按钮")])]),s._v(" "),n("tr",[n("td",[s._v("VbAbortRetryIgnore")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("显示“放弃”、“重试”、和“忽略”按钮")])]),s._v(" "),n("tr",[n("td",[s._v("VbYesNoCancel")]),s._v(" "),n("td",[s._v("3")]),s._v(" "),n("td",[s._v("显示“是”、“否”和“取消”按钮")])]),s._v(" "),n("tr",[n("td",[s._v("VbYesNo")]),s._v(" "),n("td",[s._v("4")]),s._v(" "),n("td",[s._v("显示“是”和“否”按钮")])]),s._v(" "),n("tr",[n("td",[s._v("VbRetryCancel")]),s._v(" "),n("td",[s._v("5")]),s._v(" "),n("td",[s._v("显示“重试”和“取消”按钮")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"4"}},[s._v("第二组设置图标的风格")]),s._v(" "),n("td",[s._v("VbCritical")]),s._v(" "),n("td",[s._v("16")]),s._v(" "),n("td",[s._v("显示危险消息图标")])]),s._v(" "),n("tr",[n("td",[s._v("VbQuestion")]),s._v(" "),n("td",[s._v("32")]),s._v(" "),n("td",[s._v("显示警告询问图标")])]),s._v(" "),n("tr",[n("td",[s._v("VbExclamation")]),s._v(" "),n("td",[s._v("48")]),s._v(" "),n("td",[s._v("显示警告消息图标")])]),s._v(" "),n("tr",[n("td",[s._v("VbInformation")]),s._v(" "),n("td",[s._v("64")]),s._v(" "),n("td",[s._v("显示信息消息图标")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"4"}},[s._v("第三组设置默认按钮")]),s._v(" "),n("td",[s._v("vbDefaultButton1")]),s._v(" "),n("td",[s._v("0")]),s._v(" "),n("td",[s._v("第一个按钮为默认按钮")])]),s._v(" "),n("tr",[n("td",[s._v("vbDefaultButton2")]),s._v(" "),n("td",[s._v("256")]),s._v(" "),n("td",[s._v("第二个按钮为默认按钮")])]),s._v(" "),n("tr",[n("td",[s._v("vbDefaultButton3")]),s._v(" "),n("td",[s._v("512")]),s._v(" "),n("td",[s._v("第三个按钮为默认按钮")])]),s._v(" "),n("tr",[n("td",[s._v("vbDefaultButton4")]),s._v(" "),n("td",[s._v("768")]),s._v(" "),n("td",[s._v("第四个按钮为默认按钮")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("第四组设置消息框特征")]),s._v(" "),n("td",[s._v("vbApplicationModal")]),s._v(" "),n("td",[s._v("0")]),s._v(" "),n("td",[s._v("应用程序模式：用户必须对消息框作出响应才能继续使用当前的应用程序")])]),s._v(" "),n("tr",[n("td",[s._v("vbSystemModal")]),s._v(" "),n("td",[s._v("4096")]),s._v(" "),n("td",[s._v("系统模式：应用程序都被挂起直至用户对消息框作出响应")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"4"}},[s._v("第五组附加选项")]),s._v(" "),n("td",[s._v("vbMsgBoxHelpButton")]),s._v(" "),n("td",[s._v("16384")]),s._v(" "),n("td",[s._v("在消息框上添加“帮助”按钮")])]),s._v(" "),n("tr",[n("td",[s._v("VbMsgBoxSetForeground")]),s._v(" "),n("td",[s._v("65536")]),s._v(" "),n("td",[s._v("将消息框设置为前景窗口")])]),s._v(" "),n("tr",[n("td",[s._v("vbMsgBoxRight")]),s._v(" "),n("td",[s._v("524288")]),s._v(" "),n("td",[s._v("显示右对齐的消息框")])]),s._v(" "),n("tr",[n("td",[s._v("vbMsgBoxRtlReading")]),s._v(" "),n("td",[s._v("1048576")]),s._v(" "),n("td",[s._v("指定在希伯来和阿拉伯语系统中显示的文本应当从右到左阅读")])])]),s._v(" "),n("p",[s._v("在设定 buttons 参数值时，这些值可以相加使用，但每一组中只能选择一个值。在程序代码中也可以使用 buttons 参数的常数名称，而不必使用实际数值。")]),s._v(" "),n("p",[s._v("第 4 行代码将消息框的 Title 参数设置为“Excel Home”，使消息框的标题栏显示“Excel Home”。")]),s._v(" "),n("p",[s._v("运行 Specialmsbox 过程后，显示一个如图 73-2 所示的消息框，该消息框具有“Excel Home”标题、信息消息图标和“确定”、“取消”按钮并以“确定”按钮作为默认按钮。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(780),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-2")]),s._v("\t具有特定按钮、图标和标题栏的消息框")])]),s._v(" "),n("h3",{attrs:{id:"_3-获得消息框的返回值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-获得消息框的返回值"}},[s._v("#")]),s._v(" 3）获得消息框的返回值")]),s._v(" "),n("p",[s._v("如果希望能根据用户对于消息框的不同选择，进行相应的操作，可以对消息框的返回值进行判断，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Workbook_BeforeClose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Cancel "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" iMsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\tiMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MsgBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"文件即将关闭,是否保存?"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" iMsg\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Me")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Save\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Me")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Saved "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\t\t\tCancel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("工作簿的 BeforeClose 过程，在关闭工作簿前使用 MsgBox 函数显示一个消息框，并根据用户的回应用进行相应的操作。")]),s._v(" "),n("p",[s._v("第 3 行代码，使用 MsgBox 函数显示一个具有“是”、“否”和“否”按钮的消息框，并把用户的回应，即消息框的返回值赋给变量 iMsg。MsgBox 是一个函数，这意味着它将返回一个值，如果希望获得返回值，可使用和第 3 行相似的代码，此时如果不使用括号将参数封闭起来，则会提示编译错误，如图 73-3 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(781),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-3")]),s._v("\t提示编译错误")])]),s._v(" "),n("p",[s._v("第 4 行到第 11 行代码，Select Case 结构语句，根据变量 iMsg 的值判断用户的回应，如果变量 iMsg 的值为 6，说明用户选择了“是”按钮，则使用 Save 方法保存工作簿；如果变量 iMsg 的值为 7，说明用户选择了“否”按钮，则将工作簿的 Saved 属性设置为 True，不保存更改而直接关闭工作簿。关于 Save 方法和 Saved 属性请参阅 45-2。如果变量 iMsg 的值为 2，说明用户选择了“取消”按钮，是将 BeforeClose 过程的 Cancel 参数设置为 True，取消关闭工作簿操作。")]),s._v(" "),n("p",[s._v("MsgBox 函数的返回值如表格 73-2 所示，在程序代码中也可以使用常数名称，而不必使用实际数值。")]),s._v(" "),n("p",[n("u",[s._v("表格 73-2")]),s._v("\tMsgBox 函数的返回值")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("常数")]),s._v(" "),n("th",[s._v("值")]),s._v(" "),n("th",[s._v("描述")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("vbOK")]),s._v(" "),n("td",[s._v("1")]),s._v(" "),n("td",[s._v("确定")])]),s._v(" "),n("tr",[n("td",[s._v("vbCancel")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("取消")])]),s._v(" "),n("tr",[n("td",[s._v("vbAbort")]),s._v(" "),n("td",[s._v("3")]),s._v(" "),n("td",[s._v("放弃")])]),s._v(" "),n("tr",[n("td",[s._v("vbRetry")]),s._v(" "),n("td",[s._v("4")]),s._v(" "),n("td",[s._v("重试")])]),s._v(" "),n("tr",[n("td",[s._v("vbIgnore")]),s._v(" "),n("td",[s._v("5")]),s._v(" "),n("td",[s._v("忽略")])]),s._v(" "),n("tr",[n("td",[s._v("vbYes")]),s._v(" "),n("td",[s._v("6")]),s._v(" "),n("td",[s._v("是")])]),s._v(" "),n("tr",[n("td",[s._v("vbNo")]),s._v(" "),n("td",[s._v("7")]),s._v(" "),n("td",[s._v("否")])])])]),s._v(" "),n("p",[s._v("在关闭本工作簿时将显示一个如图 73-4 所示的消息框，询问用户是否保存，并根据用户的回应用进行相应的操作。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(782),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-4")]),s._v("\t询问消息框")])]),s._v(" "),n("h3",{attrs:{id:"_4-在消息框中排版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-在消息框中排版"}},[s._v("#")]),s._v(" 4）在消息框中排版")]),s._v(" "),n("p",[s._v("如果在消息框中显示的字符串很长，比如是一段多行的文字内容，为了达到美观的效果，需要首字缩进，并将各行分隔开来，如下面代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Newlinemsbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tMsgBox Space"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"欢迎来到 ExcelHome 技术论坛，全球最领先的 Excel 技术论坛之一。"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Space"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"在这里，我们讨论 Microsoft\tOffice 系列产品的应用技术，重点讨论"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Microsoft Excel。"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Space"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"本论坛从属于 Excel Home 这一全球最大的华语 Excel 技术门户，目前"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"是个人、非营利性质的网站学习平台。"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Space"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Let’s do it better! 这是 Excel Home 的口号，我们的宗旨是帮助大"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"家解决在使用Office软件中的问题，提升自己的应用技能。"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("Newlinemsbox 过程使用消息框显示一段经过排版后的文本内容。")]),s._v(" "),n("p",[s._v("代码中使用 Space 函数在每段的首字前插入 4 个空格，使首字缩进，在需要换行的地方插入换行符 < Chr(10) > 将各行分隔开来。也可以使用回车符 < Chr(13) >、或是回车与换行符的组合 < Chr(13) & Chr(10) > 换行。")]),s._v(" "),n("p",[s._v("在程序代码中也可以使用 vbCrLf、vbNewLine 等常数，而不必使用 Chr 函数，如表格 73-3 所示。")]),s._v(" "),n("p",[n("u",[s._v("表格 73-3")]),s._v("\t回车符与换行符")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("常数")]),s._v(" "),n("th",[s._v("等于")]),s._v(" "),n("th",[s._v("描述")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("vbCrLf")]),s._v(" "),n("td",[s._v("Chr(13) + Chr(10)")]),s._v(" "),n("td",[s._v("回车符与换行符结合")])]),s._v(" "),n("tr",[n("td",[s._v("vbCr")]),s._v(" "),n("td",[s._v("Chr(13)")]),s._v(" "),n("td",[s._v("回车符")])]),s._v(" "),n("tr",[n("td",[s._v("vbLf")]),s._v(" "),n("td",[s._v("Chr(10)")]),s._v(" "),n("td",[s._v("换行符")])]),s._v(" "),n("tr",[n("td",[s._v("vbNewLine")]),s._v(" "),n("td",[s._v("Chr(13) + Chr(10) or, on the Macintosh, Chr(13)")]),s._v(" "),n("td",[s._v("平台指定的新行字符")])])])]),s._v(" "),n("p",[s._v("运行 Newlinemsbox 过程，用消息框显示一段经过排版后的文本内容，效果如图 73-5 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(783),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-5")]),s._v("\t在消息框中排版")])]),s._v(" "),n("h3",{attrs:{id:"_5-对齐消息框中显示的信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-对齐消息框中显示的信息"}},[s._v("#")]),s._v(" 5）对齐消息框中显示的信息")]),s._v(" "),n("p",[s._v("在用消息框显示如图 73-6 所示的工作表中多行多列的单元格区域时，如果只用换行符 < Chr(10) >等进行换行，而数据列没有对齐，会使显示的信息显得杂乱无章，缺乏可读性，如图 73-7 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(784),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-6")]),s._v("\t工作表单元格区域")]),s._v(" "),n("p",[n("img",{attrs:{src:a(785),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-7")]),s._v("\t没有对列进行分隔的消息框")])]),s._v(" "),n("p",[s._v("为了达到消息框中显示信息各列对齐的效果，在使用换行符 < Chr(10) > 等进行换行的基础上，还需要使用制表符 < Chr(9) > 或常数 vbTab，对数据列进行分隔，使之排列整齐，如下面代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Outmsbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sMsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" iRow "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" iCom "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" iRow "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" iCom "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\t\t\tsMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("iRow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" iCom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n\t\tsMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n\tMsgBox sMsg\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("Outmsbox 过程使用两层循环读取当前工作表中 "),n("code",[s._v("A1:E11")]),s._v(" 单元格的内容，并用消息框显示出来。")]),s._v(" "),n("p",[s._v("第 7 行代码，iCom 循环中在把逐列读取的单元格内容赋给变量 myMsg 时插入一个制表符 < Chr(9) >，对列进行分隔。")]),s._v(" "),n("p",[s._v("第 9 行代码，iRow 循环中在读取下一行单元格内容赋给变量 myMsg 时插入一个换行符 < Chr(10) >，对行进行换行。")]),s._v(" "),n("p",[s._v("运行 Outmsbox 过程将用消息框显示当前工作表中 "),n("code",[s._v("A1:E11")]),s._v(" 单元格区域中的内容，并排列整齐，如图 73-8 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(786),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 73-8")]),s._v("\t分列显示数据的消息框")])]),s._v(" "),n("h2",{attrs:{id:"_74、自动关闭的消息框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_74、自动关闭的消息框"}},[s._v("#")]),s._v(" 74、自动关闭的消息框")]),s._v(" "),n("p",[s._v("在程序执行完毕后给用户一个提示信息，但用 MsgBox 函数显示的消息框将一直保持，需要用户单击“确定”或“关闭”按钮才会关闭。如果希望显示的消息框自动关闭，那么可以使用以下方法显示消息框。")]),s._v(" "),n("h3",{attrs:{id:"_1-使用-wshshell-popup-方法显示消息框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用-wshshell-popup-方法显示消息框"}},[s._v("#")]),s._v(" 1）使用 WshShell.Popup 方法显示消息框")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" WshShell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" WshShell "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" WshShell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Wscript.Shell"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tWshShell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("popup "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"执行完毕!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提示"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" WshShell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("WshShell 过程使用 WshShell.Popup 方法显示消息框，2 秒后自动关闭。")]),s._v(" "),n("p",[s._v("WshShell.Popup 方法的语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("WshShell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Popup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" [natSecondsToWait]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" [strTitle]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" [natType]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" intButton\n\n参数strText是必需的，与Msgbox的Prompt参数类似，代表在消息框中作为信息显示的字符或字符串。如果显示的内容超过一行，可以在每一行之间用换行符（Chr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("）等将各行分隔开来。\n参数natSecondsToWait是可选的，其时间单位为妙。如果提供natSecondsToWait参数且其值大于零，则消息框在natSecondsToWait 参数指定的秒数后关闭。\n参数strTitle是可选的，代表在消息框标题栏中作为标题的字符或字符串，若省略，则窗口标题为"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“Windows 脚本宿主”")]),s._v("。\n参数natType是可选的，指定消息框中显示按钮的数目及类型、使用的图标样式、缺省按钮以及消息框的强制回应等，与MsgBox函数buttons参数相同，请参阅技巧"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("中的表格"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\n参数intButton指示用户所单击的按扭编号，与MsgBox函数的返回值相同，请参阅"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("中的表格"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。若用户在natSecondsToWait 秒之前不单击按扭，则返回值为"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("运行 WshShell 过程显示一个如图 74-1 所示消息框，无需点击“确定”按纽，2 秒后自动关闭。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(787),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 74-1")]),s._v("\t自动关闭的消息框")])]),s._v(" "),n("h3",{attrs:{id:"_2-使用-api-函数显示消息框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-api-函数显示消息框"}},[s._v("#")]),s._v(" 2）使用 API 函数显示消息框")]),s._v(" "),n("p",[s._v("使用 API 函数也可以达到这一效果，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" SetTimer "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hWnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" nIDEvent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uElaspe "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpTimerFunc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" KillTimer "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hWnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" nIDEvent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" TID "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tTID "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SetTimer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AddressOf")]),s._v(" CloseTest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"执行完毕!"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" CloseTest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hWnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uMsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" idevent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" Systime "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tApplication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SendKeys "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"~"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n\tKillTimer "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" TID\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("第 1 行代码到第 9 行代码是 API 函数声明。")]),s._v(" "),n("p",[s._v("Test 过程显示一个消息框并在 3 秒钟后运行 CloseTest 过程。")]),s._v(" "),n("p",[s._v("CloseTest 过程发送一个确定键给 Excel 程序关闭显示的消息框。")]),s._v(" "),n("p",[s._v("运行 Test 过程显示一个如图 74-2 所示的消息框并在 2 秒钟后关闭。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(788),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 74-2")]),s._v("\t自动关闭的消息框")])]),s._v(" "),n("h2",{attrs:{id:"_75、使用-inputbox-函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_75、使用-inputbox-函数"}},[s._v("#")]),s._v(" 75、使用 InputBox 函数")]),s._v(" "),n("h3",{attrs:{id:"_1-简单的数据输入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-简单的数据输入"}},[s._v("#")]),s._v(" 1）简单的数据输入")]),s._v(" "),n("p",[s._v("Excel 的使用过程中，有时需要用户输入简单的数据，此时可以使用 InputBox 函数显示一个对话框，供用户在对话框中输入数据信息，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" myInputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sInt "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" r "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\tr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Sheet1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A65536"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row\n\tsInt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" InputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请输入人员姓名："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" Len"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Trim"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sInt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\tSheet1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sInt\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n\t\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"您没有输入内容!"')]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("myInputBox 过程使用 InputBox 函数显示一个对话框供用户在对话框中输入数据，InputBox 函数显示一个对话框，等待用户输入正文或按下按钮，并返回包含文本框内容的字符串，语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("InputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prompt["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" xpos] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ypos] ["),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" helpfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n参数prompt是必需的，作为对话框消息出现的字符串表达式。\n参数title是可选的，作为显示在对话框标题栏中的字符串表达式，如果省略title参数，则在标题栏中显示"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“Microsoft Excel”")]),s._v("。\n参数"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("是可选的，显示在文本框中的字符串表达式，在没有其它输入时作为缺省值，如果省略"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("参数，则文本框为空。\n参数xpos是可选的，指定对话框的左边与屏幕左边的水平距离。如果省略xpos参数，则对话框会在水平方向居中。\n参数ypos是可选的，指定对话框的上边与屏幕上边的距离。如果省略ypos参数，则对话框被放置在屏幕垂直方向距下边大约三分之一的位置。\n参数helpfile和参数context是可选的，为对话框提供上下文相关的帮助和编号，如果提供了其中一个参数，则必须提供另一个参数，两者缺一不可。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("第 5 行代码，使用 InputBox 函数显示一个提示用户输入邮政编码的对话框，其中“请输入人员姓名：”是必需的 prompt 参数，其他参数使用缺省值。")]),s._v(" "),n("p",[s._v("第 4 行代码，使用 Len 函数和 Trim 函数判断返回的去除空格后的字符串长度。如果字符串长度大于零，说明用户单击了对话框的“确定”按钮，则将用户输入的数据写到工作表的 A 列单元格。如果返回的是长度为零的字符串，说明用户单击了对话框的“取消”按钮，则显示一条提示消息。")]),s._v(" "),n("p",[s._v('因为当用户单击对话框的“确定”按钮后，InputBox 函数返回包含文本框内容的字符串，如果用户单击对话框的“取消”按钮则返回一个长度为零的字符串（""），通过返回的字符串长度可以判断用户做出的选择。')]),s._v(" "),n("p",[s._v("运行 sInput 过程将显示一个提示用户输入数据的对话框，如图 75-1 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(789),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 75-1")]),s._v("\tInputBox 函数显示的对话框")])]),s._v(" "),n("h3",{attrs:{id:"_2-使用对话框输入密码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用对话框输入密码"}},[s._v("#")]),s._v(" 2）使用对话框输入密码")]),s._v(" "),n("p",[s._v("使用 InputBox 函数显示的对话框输入密码简单方便，但有个明显的缺陷，就是输入过程中不能用占位符显示密码，不够安全。借助 API 函数可以在输入密码过程中以占位符“*”号来显示密码，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" FindWindow "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FindWindowA"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpClassName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpWindowName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" FindWindowEx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FindWindowExA"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hWnd1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hWnd2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpsz1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpsz2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" SendMessage "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SendMessageA"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hwnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" wMsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" wParam "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lParam "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" timeSetEvent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"winmm.dll"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uDelay "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uResolution "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpFunction "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwUser "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uFlags "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" timeKillEvent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"winmm.dll"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uID "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" GetTickCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" EM_SETPASSWORDCHAR "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("&HCC")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" lTimeID "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" TimeProc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uID "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uMsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwUser "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dw1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dw2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" hwd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\thwd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FindWindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"32770"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"密码"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hwd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\thwd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FindWindowEx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hwd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"edit"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vbNullString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\tSendMessage hwd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" EM_SETPASSWORDCHAR"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\t\ttimeKillEvent lTimeID\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" Password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v("\n\tlTimeID "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" timeSetEvent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AddressOf")]),s._v(" TimeProc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tPassword "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" InputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请输入密码："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"密码"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" Password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"密码正确!"')]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n\t\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"密码错误!"')]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("Password 程使用 InputBox 函数显示一个输入密码的对话框，并且以占位符“*”号显示输入的密码。")]),s._v(" "),n("p",[s._v("第 1 行到第 8 行代码，API 函数声明。")]),s._v(" "),n("p",[s._v("第 9 行到第 17 行代码，TimeProc 过程是 timeSetEvent 的回调函数，获得对话框句柄。")]),s._v(" "),n("p",[s._v("第 18 行到第 27 行代码，Password 过程显示一个提示用户输入密码的对话框。")]),s._v(" "),n("p",[s._v("运行 Password 过程将显示一个密码输入框，输入的密码以占位符“*”号代替，如图 75-2 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(790),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 75-2")]),s._v("\t密码输入框")])]),s._v(" "),n("h2",{attrs:{id:"_76、使用-inputbox-方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_76、使用-inputbox-方法"}},[s._v("#")]),s._v(" 76、使用 InputBox 方法")]),s._v(" "),n("p",[s._v("在 Excel 中输入简单的数据可以使用 InputBox 函数显示的对话框，但是如果输入的数据类型不匹配时，过程运行时会产生意外错误。为了避免此类情况发生，可以使用另一种获得用户输入的方式——InputBox 方法。")]),s._v(" "),n("h3",{attrs:{id:"_1-输入指定类型的数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-输入指定类型的数据"}},[s._v("#")]),s._v(" 1）输入指定类型的数据")]),s._v(" "),n("p",[s._v("使用 InputBox 方法输入数据时可以指定数据的类型，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" dInput"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dInput "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" r "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\tr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Sheet1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A65536"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row\n\tdInput "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("InputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Prompt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请输入数字："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" dInput "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\tSheet1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dInput\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n\t\tMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你已取消了输入!"')]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("dInput 过程使用 InputBox 方法显示一个提示用户输入数字的对话框。")]),s._v(" "),n("p",[s._v("InputBox 方法显示一个接收用户输入的对话框，返回此对话框中输入的信息，语法如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("expression.InputBox(Prompt, Title, Default, Left, Top, HelpFile, HelpContextId, Type)\n\n参数expression是必需的，返回一个Application对象。\n参数Prompt是必需的，作为对话框消息显示的字符串表达式。\n参数Title是可选的，作为显示在对话框标题栏中的字符串表达式。如果省略Title参数，将使用默认的标题。\n参数Default是可选的，在对话框显示时出现在文本框中的初始值。如果省略Default参数，则文本框为空。\n参数Left是可选的，指定对话框相对于屏幕左上角的 x 坐标。\n参数Top是可选的，指定对话框相对于屏幕左上角的 y 坐标。\n参数HelpFile和参数HelpContextId是可选的，为对话框提供上下文相关的帮助和编号，如果提供了其中一个参数，则必须提供另一个参数，两者缺一不可。\n参数Type是可选的，指定返回的数据类型。如果省略Type参数，对话框将返回文本。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("InputBox 方法的语法和 InputBox 函数的语法相似，最大的区别在于最后一个参数——Type。通过 Type 参数可以指定返回值的数据类型，表格 76-1 列出了 Type 参数可以使用的数值。")]),s._v(" "),n("p",[n("u",[s._v("表格 76-1")]),s._v("\tType 参数的值")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("数值")]),s._v(" "),n("th",[s._v("期望的返回值")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("0")]),s._v(" "),n("td",[s._v("一个公式")])]),s._v(" "),n("tr",[n("td",[s._v("1")]),s._v(" "),n("td",[s._v("一个数字")])]),s._v(" "),n("tr",[n("td",[s._v("2")]),s._v(" "),n("td",[s._v("文本（字符串）")])]),s._v(" "),n("tr",[n("td",[s._v("4")]),s._v(" "),n("td",[s._v("一个逻辑值，例如true或false")])]),s._v(" "),n("tr",[n("td",[s._v("8")]),s._v(" "),n("td",[s._v("一个单元格引用")])]),s._v(" "),n("tr",[n("td",[s._v("16")]),s._v(" "),n("td",[s._v("一个错误值")])]),s._v(" "),n("tr",[n("td",[s._v("64")]),s._v(" "),n("td",[s._v("一个值的数组")])])])]),s._v(" "),n("p",[s._v("这些数值可以相加使用，如果希望返回数字和文本，可以将 Type 参数设置为 1+2。")]),s._v(" "),n("p",[s._v("InputBox 方法与 InputBox 函数相比，优点是内置的出错处理。在第 5 行代码中将 Type 参数值设置为 1，这意味着对话框只能输入数值。当用户输入的不是数值时，显示一个如图 76-1 所示的消息框提示输入错误。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(791),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 76-1")]),s._v("\t提示输入错误")])]),s._v(" "),n("p",[s._v("第 6 行到第 10 行代码，如果用户单击对话框的“确定”按钮，将用户输入的数字写入工作表的 A 列单元格。如果用户单击对话框的“取消”按钮，则显示一条提示消息。")]),s._v(" "),n("p",[s._v("InputBox 方法和 InputBox 函数的另一个区别是，当用户单击“取消”按纽时返回 False 而不是长度为零的字符串。")]),s._v(" "),n("p",[s._v("运行 dInput 过程将显示一个提示用户输入数字的对话框，如图 76-2 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(792),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 76-2")]),s._v("\tInputBox 方法显示的对话框")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("在 VBA 代码中，Application.InputBox 调用的是 InputBox 方法，不带对象识别符的 InputBox 调用的是 InputBox 函数。")])]),s._v(" "),n("h3",{attrs:{id:"_2-获得单元格区域地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-获得单元格区域地址"}},[s._v("#")]),s._v(" 2）获得单元格区域地址")]),s._v(" "),n("p",[s._v("InputBox 方法很适合用户选择工作表单元格区域，并对所选择的单元格区域进行操作，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" RngInput"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" rng "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Range\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Error")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" line\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" rng "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("InputBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请使用鼠标选择单元格区域："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\trng"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Interior"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ColorIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\nline"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("RngInput 过程使用 InputBox 方法显示一个对话框，提示用户在工作表中选择一个单元格区域，并改变所选单元格区域内部的颜色。")]),s._v(" "),n("p",[s._v("第 3 行代码，错误处理语句。因为当对话框显示后，如果用户单击“取消”按钮，将显示一错误信息，如图 76-3 所示，所以必需使用 On Error GoTo 语句来绕过错误。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(793),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 76-3")]),s._v("\t提示运行错误")])]),s._v(" "),n("p",[s._v("第 4 行代码，使用 Set 语句将用户选择的单元格区域赋给变量 rng。当 Type 参数设置为 8 时，将返回一个 Range 对象，必须用 Set 语句将结果指定给一个 Range 对象。")]),s._v(" "),n("p",[s._v("第 5 行代码，改变用户所选单元格区域内部的颜色。")]),s._v(" "),n("p",[s._v("运行 RngInput 过程，将显示一个对话框，提示用户在工作表中选择一个单元格区域，并改变所选单元格区域内部的颜色，如图 76 4 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(794),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 76-4")]),s._v("\t使用 InputBox 方法获得区域地址")])]),s._v(" "),n("h2",{attrs:{id:"_77、内置对话框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_77、内置对话框"}},[s._v("#")]),s._v(" 77、内置对话框")]),s._v(" "),n("h3",{attrs:{id:"_1-调用内置的对话框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-调用内置的对话框"}},[s._v("#")]),s._v(" 1）调用内置的对话框")]),s._v(" "),n("p",[s._v("如果需要使用“打开”、“打印”等 Excel 内置对话框已经具有的功能，可以使用代码直接调用这些内置的对话框，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" DialogOpen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tApplication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Dialogs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDialogOpen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Show arg1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\*.xls"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("DialogOpen 过程显示内置的“打开”对话框并选定示例所在的文件夹。")]),s._v(" "),n("p",[s._v("显示内置对话框语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Dialogs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDialogConst"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Show\n\nDialogs集合代表所有的内置对话框，每个Dialog对象代表一个内置对话框，不能新建内置对话框或向该集合中添加内置对话框。\n参数xlDialogConst是内置对话框的内置常量，每个常量都以"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“xlDialog”")]),s._v("开头，其后是对话框的名称，如"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“打开”")]),s._v("对话框的常量为"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“xlDialogOpen”")]),s._v("。常用内置对话框的内置常量如表格"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("77")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("所示。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("u",[s._v("表格 77-1")]),s._v("\t内置对话框的内置常量")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("常量")]),s._v(" "),n("th",[s._v("值")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("xlDialogActiveCellFont")]),s._v(" "),n("td",[s._v("476")]),s._v(" "),n("td",[s._v("单元格格式(字体）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogBorder")]),s._v(" "),n("td",[s._v("45")]),s._v(" "),n("td",[s._v("单元格格式(边框）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogCellProtection")]),s._v(" "),n("td",[s._v("46")]),s._v(" "),n("td",[s._v("单元格格式(保护）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogDeleteFormat")]),s._v(" "),n("td",[s._v("111")]),s._v(" "),n("td",[s._v("单元格格式(数字）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogFormatNumber")]),s._v(" "),n("td",[s._v("42")]),s._v(" "),n("td",[s._v("单元格格式(数字）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogPatterns")]),s._v(" "),n("td",[s._v("84")]),s._v(" "),n("td",[s._v("单元格格式(图案）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogClear")]),s._v(" "),n("td",[s._v("52")]),s._v(" "),n("td",[s._v("清除")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogColumnWidth")]),s._v(" "),n("td",[s._v("47")]),s._v(" "),n("td",[s._v("列宽")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogRowHeight")]),s._v(" "),n("td",[s._v("127")]),s._v(" "),n("td",[s._v("行高")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogConditionalFormatting")]),s._v(" "),n("td",[s._v("583")]),s._v(" "),n("td",[s._v("条件格式")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogDefineName")]),s._v(" "),n("td",[s._v("61")]),s._v(" "),n("td",[s._v("定义名称")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogDefineStyle")]),s._v(" "),n("td",[s._v("229")]),s._v(" "),n("td",[s._v("样式")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogDisplay")]),s._v(" "),n("td",[s._v("27")]),s._v(" "),n("td",[s._v("显示选项")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogFont")]),s._v(" "),n("td",[s._v("26")]),s._v(" "),n("td",[s._v("字体")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogSetBackgroundPicture")]),s._v(" "),n("td",[s._v("509")]),s._v(" "),n("td",[s._v("工作表背景")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogInsert")]),s._v(" "),n("td",[s._v("55")]),s._v(" "),n("td",[s._v("插入")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogInsertHyperlink")]),s._v(" "),n("td",[s._v("596")]),s._v(" "),n("td",[s._v("插入超链接")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogInsertPicture")]),s._v(" "),n("td",[s._v("342")]),s._v(" "),n("td",[s._v("插入图片")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogNew")]),s._v(" "),n("td",[s._v("119")]),s._v(" "),n("td",[s._v("新建工作簿")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogOpen")]),s._v(" "),n("td",[s._v("1")]),s._v(" "),n("td",[s._v("打开")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogSaveAs")]),s._v(" "),n("td",[s._v("5")]),s._v(" "),n("td",[s._v("另存为")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookCopy")]),s._v(" "),n("td",[s._v("283")]),s._v(" "),n("td",[s._v("移动或复制工作表（建立副本）")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookInsert")]),s._v(" "),n("td",[s._v("354")]),s._v(" "),n("td",[s._v("插入工作表")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookMove")]),s._v(" "),n("td",[s._v("282")]),s._v(" "),n("td",[s._v("移动或复制工作表")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookName")]),s._v(" "),n("td",[s._v("386")]),s._v(" "),n("td",[s._v("重命名工作表")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookNew")]),s._v(" "),n("td",[s._v("302")]),s._v(" "),n("td",[s._v("新建工作表")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogWorkbookProtect")]),s._v(" "),n("td",[s._v("417")]),s._v(" "),n("td",[s._v("保护工作簿")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogPageSetup")]),s._v(" "),n("td",[s._v("7")]),s._v(" "),n("td",[s._v("页面设置")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogPrint")]),s._v(" "),n("td",[s._v("8")]),s._v(" "),n("td",[s._v("打印内容")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogPrinterSetup")]),s._v(" "),n("td",[s._v("9")]),s._v(" "),n("td",[s._v("打印机设置")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogPrintPreview")]),s._v(" "),n("td",[s._v("222")]),s._v(" "),n("td",[s._v("打印预览")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogSetPrintTitles")]),s._v(" "),n("td",[s._v("23")]),s._v(" "),n("td",[s._v("设置打印标题")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogRun")]),s._v(" "),n("td",[s._v("17")]),s._v(" "),n("td",[s._v("宏")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogTable")]),s._v(" "),n("td",[s._v("41")]),s._v(" "),n("td",[s._v("模拟运算表")])]),s._v(" "),n("tr",[n("td",[s._v("xlDialogSendMail")]),s._v(" "),n("td",[s._v("189")]),s._v(" "),n("td",[s._v("发送邮件")])])])]),s._v(" "),n("p",[s._v("显示内置对话框使用 Show 方法，应用于 Dialog 对象的 Show 方法语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Show"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Arg1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg9"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg11"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg12"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg13"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg14"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg17"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg18"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg19"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg20"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg21"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg23"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg24"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg25"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg26"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg27"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg28"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg29"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arg30"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n参数expression是必需的，返回Dialog对象之一。\n参数arg1到参数arg30是可选的，仅应用于内置对话框，是命令的初始参数。若要查找要设置的参数，请在内置对话框参数列表中查找对应的对话框常量。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("运行 alogOpen 过程，显示内置的“打开”对话框，并且直接选定示例所在的文件夹，如图 77-1 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(795),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 77-1")]),s._v("\t使用内置对话框")])]),s._v(" "),n("h3",{attrs:{id:"_2-获取选定文件的文件名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取选定文件的文件名"}},[s._v("#")]),s._v(" 2）获取选定文件的文件名")]),s._v(" "),n("p",[s._v("如果只希望获取用户在显示的内置 “打开”对话框中选定文件的文件名，而不想真正打开该文件，那么可以使用 GetOpenFilename 方法，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" OpenFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" Filename "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" mymsg "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n\tFilename "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetOpenFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"删除文件"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MultiSelect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" IsArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Filename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\tmymsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MsgBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"是否删除所选文件?"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vbYesNo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提示"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" mymsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vbYes "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" UBound"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Filename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\tKill Filename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("OpenFilename 过程使用 GetOpenFilename 方法显示标准的内置“打开”对话框，获取用户选定文件的文件名后使用 Kill 语句删除。")]),s._v(" "),n("p",[s._v("GetOpenFilename 方法显示标准的内置“打开”对话框，获取文件名，语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetOpenFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FileFilter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FilterIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ButtonText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MultiSelect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n参数expression是必需的，返回一个Application对象。\n参数FileFilter是可选的，指定文件筛选条件的字符串。如果省略，则默认参数值为"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“所有文件(*.*)”")]),s._v("。\n参数FilterIndex是可选的，指定默认文件筛选条件的索引号，取值范围为 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 到由 FileFilter 所指定的筛选条件数目。如果省略，或者取值大于可用筛选数目，则采用第一个文件筛选条件。\n参数Title是可选的，指定对话框的标题。如果省略，则使用"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("“打开”")]),s._v("作为标题。\n参数ButtonText是可选的，仅用于Macintosh。\n参数MultiSelect是可选的，如果该值为"),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("，则允许选定多个文件名，如果该值为"),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("，则只允许选定单个文件名。默认值为"),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("第 5 行代码显示标准的“打开”对话框，将对话框的标题设置为“删除文件”，将 MultiSelect 参数设置为 True，允许选定多个文件。")]),s._v(" "),n("p",[s._v("第 6 行代码，获得返回值。当用户选定文件后，返回的是选定的文件名或用户输入的文件名。因为 MultiSelect 参数已设置为 True，所以返回值将是一个包含所有选定文件名的数组（即使仅选定了一个文件名）。如果用户取消了对话框，则该值为 False。")]),s._v(" "),n("p",[s._v("第 8 行到第 12 行代码，经询问用户后使用 Kill 语句从磁盘中删除用户选定的文件。")]),s._v(" "),n("p",[s._v("运行 OpenFilename 过程，显示标准的内置“打开”对话框，删除用户选定的文件，如所图 77-2示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(796),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 77-2")]),s._v("\t使用内置对话框")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("VBA 中数组下界默认从 0 开始，但使用 GetOpenFilename 方法选择多个文件时返回的包含选定文件名的数组下界是从 1 开始。")])]),s._v(" "),n("h3",{attrs:{id:"_3-使用-另存为-对话框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用-另存为-对话框"}},[s._v("#")]),s._v(" 3）使用“另存为”对话框")]),s._v(" "),n("p",[s._v("在备份文件时可以使用 GetSaveAsFilename 方法显示标准的内置“另存为”对话框，获取备份文件的文件名和保存路径，而无须真正保存任何文件。如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" CopyFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" NowWorkbook "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Workbook\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" FileName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Error")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" line\n\tFileName "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetSaveAsFilename "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("InitialFileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D:\\"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Date")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\tfileFilter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Excel files(*.xls),*.xls,All files (*.*),*.*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\tTitle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"数据备份"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" FileName "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"False"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" NowWorkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Workbooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Add\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" NowWorkbook\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SaveAs FileName\n\t\t\tThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Save\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" line\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\nline"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\tActiveWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Close\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("CopyFilename 过程使用 GetSaveAsFilename 方法显示标准的内置“另存为”对话框，获取备份文件的文件名和保存路径，新建工作簿保存备份数据。")]),s._v(" "),n("p",[s._v("第 4 行代码，错误处理语句。备份过程中，如果已存在同名工作簿，会出现如图 77-3 所示的提示，如果选择了“否”，此时新工作簿已经建立，在执行第 12 行代码时发生错误，使程序中断，所以使用 GoTo 语句执行第 21 行代码，关闭新建立的工作簿。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(797),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 77-3")]),s._v("\t文件已存在提示")])]),s._v(" "),n("p",[s._v("第 5 行代码，使用 GetSaveAsFilename 方法显示标准的内置“另存为”对话框。GetSaveAsFilename 方法的语法如下：")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[s._v("expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetSaveAsFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("InitialFilename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FileFilter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FilterIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ButtonText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n参数expression是必需的，返回一个Application对象。\n参数InitialFilename是可选的，指定建议的文件名。如果省略，将活动工作簿的名称作为建议的文件名。\n参数FileFilter是可选的，指定文件筛选条件的字符串。\n参数FilterIndex是可选的，指定默认文件筛选条件的索引号，取值范围为 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 到 FileFilter 指定的筛选条件数目之间。如果省略，或者取值大于可用筛选数目，则采用第一个文件筛选条件。\n参数Title是可选的，指定对话框标题。如果省略，则使用默认标题。\n参数ButtonText是可选的，仅用于 Macintosh。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("第 6 行代码，设置对话框的保存路径为 D 盘，保存文件名为日期加工作簿名称。")]),s._v(" "),n("p",[s._v("第 7 行代码，设置对话框文件保存类型为 Excel 文件类型。如果需要设置为文本类型需设置为“文本文件(*.txt), *.txt”，而如果是图片文件则需设置为“图片文件(*.bmp;*.jpg),*.bmp;*.jpg”。")]),s._v(" "),n("p",[s._v("第 8 行代码，设置对话框的标题为“数据备份”。")]),s._v(" "),n("p",[s._v("第 9 行代码，如果用户没有取消操作。")]),s._v(" "),n("p",[s._v("第 10 行到第 16 行代码，使用 Add 方法新建工作簿保存到对话框选定的路径中，将数据备份到新工作簿中。")]),s._v(" "),n("p",[s._v("第 17 行代码，使用 GoTo 语句执行第 21 行代码，关闭新建工作簿和开启屏幕刷新。")]),s._v(" "),n("p",[s._v("运行 CopyFilename 过程，显示内置“另存为”对话框，供用户备份工作簿数据，如图 77-4 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(798),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 77-4")]),s._v("\t使用“另存为”对话框备份文件")])]),s._v(" "),n("h2",{attrs:{id:"_78、调用操作系统-关于-对话框"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_78、调用操作系统-关于-对话框"}},[s._v("#")]),s._v(" 78、调用操作系统“关于”对话框")]),s._v(" "),n("p",[s._v("VBA 程序开发完成后，有时需要一个“关于”对话框，除了使用窗体外，还可以调用操作系统的“关于”对话框，显示自定义的内容，如下面的代码所示。")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" ShellAbout "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shell32.dll"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ShellAboutA"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hwnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" szApp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" szOtherStuff "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hIcon "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" FindWindow "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user32"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FindWindowA"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpClassName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpWindowName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" CommandButton1_Click"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" ApphWnd "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\tApphWnd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FindWindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"XLMAIN"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Caption"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tShellAbout ApphWnd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"财务处理系统"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yuanzhuping@yeah.net\t0513-86548930"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("代码解析：")]),s._v(" "),n("p",[s._v("第 1 行到第 5 行代码是 API 函数声明。")]),s._v(" "),n("p",[s._v("第 8、9 行代码调用操作系统的“关于”对话框并显示自定义的内容。")]),s._v(" "),n("p",[s._v("代码运行后显示如图 78-1 所示的对话框。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(799),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[n("u",[s._v("图 78-1")]),s._v("\t调用操作系统的“关于”对话框")])])])}),[],!1,null,null,null);t.default=e.exports},779:function(s,t,a){s.exports=a.p+"assets/img/73-1.87c31109.png"},780:function(s,t,a){s.exports=a.p+"assets/img/73-2.ada08b72.png"},781:function(s,t,a){s.exports=a.p+"assets/img/73-3.b614561c.png"},782:function(s,t,a){s.exports=a.p+"assets/img/73-4.692882de.png"},783:function(s,t,a){s.exports=a.p+"assets/img/73-5.3fbd13f9.png"},784:function(s,t,a){s.exports=a.p+"assets/img/73-6.1179df81.png"},785:function(s,t,a){s.exports=a.p+"assets/img/73-7.b8e6e31f.png"},786:function(s,t,a){s.exports=a.p+"assets/img/73-8.01560445.png"},787:function(s,t,a){s.exports=a.p+"assets/img/74-1.589f3f39.png"},788:function(s,t){s.exports="data:image/png;base64,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"},789:function(s,t,a){s.exports=a.p+"assets/img/75-1.b847bfaf.png"},790:function(s,t,a){s.exports=a.p+"assets/img/75-2.deea6ad9.png"},791:function(s,t,a){s.exports=a.p+"assets/img/76-1.a82f63ed.png"},792:function(s,t,a){s.exports=a.p+"assets/img/76-2.44d454de.png"},793:function(s,t,a){s.exports=a.p+"assets/img/76-3.3a0a78c3.png"},794:function(s,t,a){s.exports=a.p+"assets/img/76-4.2a2d3af0.png"},795:function(s,t,a){s.exports=a.p+"assets/img/77-1.a5e9c94f.png"},796:function(s,t,a){s.exports=a.p+"assets/img/77-2.1e6049c6.png"},797:function(s,t,a){s.exports=a.p+"assets/img/77-3.1d0208fd.png"},798:function(s,t,a){s.exports=a.p+"assets/img/77-4.dd5f9891.png"},799:function(s,t,a){s.exports=a.p+"assets/img/78-1.c260013b.png"}}]);