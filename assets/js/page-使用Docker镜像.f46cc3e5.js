(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{1098:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("镜像是 Docker 三大核心概念中最重要的，自 Docker 诞生之日起镜像就是相关社区最为热门的关键词。")]),s._v(" "),t("p",[s._v("Docker 运行容器前需要本地存在对应的镜像，如果镜像不存在，Docker 会尝试先从默认镜像仓库下载（默认使用 Docker Hub 公共注册服务器中的仓库），用户也可以通过配置，使用自定义的镜像仓库。")]),s._v(" "),t("p",[s._v("本章将围绕镜像这一核心概念介绍具体操作，包括如何使用 "),t("code",[s._v("pull")]),s._v(" 命令从 Docker Hub 仓库中下载镜像到本地；如何查看本地已有的镜像信息和管理镜像标签；如何在远端仓库使用 "),t("code",[s._v("search")]),s._v(" 命令进行搜索和过滤；如何删除镜像标签和镜像文件；如何创建用户定制的镜像并且保存为外部文件。最后，还将介绍如何往 Docker Hub 仓库中推送自己的镜像。")]),s._v(" "),t("h2",{attrs:{id:"获取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取镜像"}},[s._v("#")]),s._v(" 获取镜像")]),s._v(" "),t("p",[s._v("镜像是运行容器的前提，官方的 Docker Hub 网站已经提供了数十万个镜像供大家开放下载。但是，根据 Docker 公司政策，2020 年 11 月 01 日起将逐步向 Docker Hub 匿名和免费用户实施速率和拉取请求次数限制。因此，如果您在个人版中构建服务拉取 Docker Hub 镜像，将可能受此影响导致构建失败。")]),s._v(" "),t("p",[s._v("关于 Docker Hub 拉取请求次数限制的详细介绍，请参见 "),t("a",{attrs:{href:"https://docs.docker.com/docker-hub/download-rate-limit/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Download rate limit"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("解决方法")]),s._v(" "),t("p",[s._v("要解决此问题，需要配置国内仓库源。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建daemon.json文件，并配置以下内容")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<国内加速镜像源地址>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#保存推出")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#国内加速镜像源地址")]),s._v("\nhttps://registry.docker-cn.com\nhttp://hub-mirror.c.163.com\nhttps://3laho3y3.mirror.aliyuncs.com\nhttp://f1361db2.m.daocloud.io\nhttps://mirror.ccs.tencentyun.com\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#然后重新加载配置，重启服务")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("之后就可以正常 pull 镜像了。")])]),s._v(" "),t("p",[s._v("我们可以使用 "),t("code",[s._v("docker [image] pull")]),s._v(" 命令直接从 Docker Hub 镜像源来下载镜像。该命令的格式为 "),t("code",[s._v("docker [image] pull NAME[:TAG]")]),s._v("。")]),s._v(" "),t("p",[s._v("其中，NAME 是镜像仓库名称（用来区分镜像），TAG 是镜像的标签（往往用来表示版本\n信息）。通常情况下，描述一个镜像需要包括“名称+标签”信息。")]),s._v(" "),t("p",[s._v("例如，获取一个 Ubuntu 18.04 系统的基础镜像可以使用如下的命令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull ubuntu:18.04\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v(": Pulling from library/ubuntu\ne4ca327ec0e7: Pull complete \nDigest: sha256:9bc830af2bef73276515a29aa896eedfa7bdf4bdbc5c1063b4c457a4bbb8cd79\nStatus: Downloaded newer image "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" ubuntu:18.04\ndocker.io/library/ubuntu:18.04\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("对于 Docker 镜像来说，如果不显式指定 TAG，则默认会选择 latest 标签，这会下载仓库中最新版本的镜像。")]),s._v(" "),t("p",[s._v("下面的例子将从 centos 仓库下载一个最新版本的 centos 操作系统的镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull centos\nUsing default tag: latest\nlatest: Pulling from library/centos\n7a0437f04f83: Pull complete \nDigest: sha256:5528e8b1b1719d34604c87e11dcd1c0a20bedf46e83b5632cdeac91b8c04efc1\nStatus: Downloaded newer image "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" centos:latest\ndocker.io/library/centos:latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("该命令实际上下载的就是 centos:latest 镜像。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("一般来说，镜像的 latest 标签意味着该镜像的内容会跟踪最新版本的变更而变化，内容是不稳定的。因此，从稳定性上考虑，不要在生产环境中忽略镜像的标签信息或使用默认的 latest 标记的镜像。")])]),s._v(" "),t("p",[s._v("下载过程中可以看出，镜像文件一般由若干层（layer）组成，e4ca327ec0e7 这样的串是层的唯一 id（实际上完整的 id 包括 256 比特，64 个十六进制字符组成）。使用 "),t("code",[s._v("docker pull")]),s._v(" 命令下载中会获取并输出镜像的各层信息。当不同的镜像包括相同的层时，本地仅存储了层的一份内容，减小了存储空间。")]),s._v(" "),t("p",[s._v("你可能会想到，在不同的镜像仓库服务器的情况下，可能会出现镜像重名的情况。")]),s._v(" "),t("p",[s._v("严格地讲，镜像的仓库名称中还应该添加仓库地址（即 registry，注册服务器）作为前缀，只是默认使用的是官方 Docker Hub 服务，该前缀可以忽略。")]),s._v(" "),t("p",[s._v("例如，"),t("code",[s._v("docker pull ubuntu:18.04")]),s._v(" 命令相当于 "),t("code",[s._v("docker pull registry.hub.docker.com/ubuntu:18.04")]),s._v(" 命令，即从默认的注册服务器 Docekr Hub Registry 中的 ubuntu 仓库来下载标记为 18.04 的镜像。")]),s._v(" "),t("p",[s._v("如果从非官方的仓库下载，则需要在仓库名称前指定完整的仓库地址。例如从网易蜂巢命令，此时下载的镜像名称为 "),t("code",[s._v("hub.c.163.com/public/ubuntu:18.04")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull hub.c.163.com/public/ubuntu:18.04\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("pull")]),s._v(" 子命令支持的选项主要包括：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-a，--all-tags=true|false：是否获取仓库中的所有镜像，默认为否；")])]),s._v(" "),t("li",[t("p",[s._v("--disable-content-trust：取消镜像的内容校验，默认为真。")])])]),s._v(" "),t("p",[s._v("另外，有时需要使用镜像代理服务来加速 Docke 镜像获取过程，可以在 Docker 服务\n启动配置中增加 --registry-mirror=proxy_URL 来指定镜像代理服务地址（如 https://\nregistry.docker-en.com）")]),s._v(" "),t("p",[s._v('下载镜像到本地后，即可随时使用该镜像了，例如利用该镜像创建一个容器，在其中运\n行 bash 应用，执行打印"HelloWorld"命令：')]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it ubuntu:18.04 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nroot@65663247040f:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "Hello World"')]),s._v("\nHello World\nroot@65663247040f:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n$  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"查看镜像信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看镜像信息"}},[s._v("#")]),s._v(" 查看镜像信息")]),s._v(" "),t("p",[s._v("主要介绍 Docker 镜像的 "),t("code",[s._v("ls")]),s._v("、"),t("code",[s._v("tag")]),s._v(" 和 "),t("code",[s._v("inspect")]),s._v(" 子命令。")]),s._v(" "),t("h3",{attrs:{id:"_1、使用-images-命令列出镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用-images-命令列出镜像"}},[s._v("#")]),s._v(" 1、使用 images 命令列出镜像")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("docker images")]),s._v(" 或 "),t("code",[s._v("docker image ls")]),s._v(" 命令可以列出本地主机上已有镜像的基本信息。")]),s._v(" "),t("p",[s._v("例如，下面的命令列出了之前下载的镜像信息：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY    TAG       IMAGE ID       CREATED        SIZE\nubuntu        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("     54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nhello-world   latest    d1165f221234   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" months ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\ncentos        latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("在列出信息中，可以看到几个字段信息：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("来自于哪个仓库，比如 ubuntu 表示 ubuntu 系列的基础镜像；")])]),s._v(" "),t("li",[t("p",[s._v("镜像的标答信息，比如 18.04、latest 表示不同的版本信息。标签只是标记，并不能标\n识镜像内容；")])]),s._v(" "),t("li",[t("p",[s._v("镜像的 ID（唯一标识镜像），如果两个镜像的 ID 相同，说明它们实际上指向了同一个镜像，只是具有不同标签名称而已；")])]),s._v(" "),t("li",[t("p",[s._v("创建时间，说明镜像最后的更新时间；")])]),s._v(" "),t("li",[t("p",[s._v("镜像大小，优秀的镜像往往体积都较小。")])])]),s._v(" "),t("p",[s._v("其中镜像的 ID 信息十分重要，它唯一标识了镜像。在使用镜像 ID 的时候，一般可以使用该 ID 的前若干个字符组成的可区分串来替代完整的 ID。")]),s._v(" "),t("p",[s._v("TAG 信息用于标记来自同一个仓库的不同镜像。例如 ubuntu 仓库中有多个镜像，通过 TAG 信息来区分发行版本，如 18.04、18.10 等。")]),s._v(" "),t("p",[s._v("镜像大小信息只是表示了该镜像的逻辑体积大小，实际上由于相同的镜像层本地只会存储一份，物理上占用的存储空间会小于各镜像逻辑体积之和。")]),s._v(" "),t("p",[s._v("images 子命令主要支持如下选项，用户可以自行进行尝试：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-a，--all=true|false：列出所有（包括临时文件）镜像文件，默认为否；")])]),s._v(" "),t("li",[t("p",[s._v("--digests=true|false：列出镜像的数字摘要值，默认为否；")])]),s._v(" "),t("li",[t("p",[s._v("-f，--filter=[]：过滤列出的镜像，如 dangling=true 只显示没有被使用的镜像；也可指定带有特定标注的镜像等；")])]),s._v(" "),t("li",[t("p",[s._v('--format="TEMPLATE"：控制输出格式，如 '),t("code",[s._v(".ID")]),s._v(" 代表 ID 信息，"),t("code",[s._v(".Repository")]),s._v(" 代表仓库信息等；")])]),s._v(" "),t("li",[t("p",[s._v("--no-trunc=true|false：对输出结果中太长的部分是否进行截断，如镜像的 ID 信息，默认为是；")])]),s._v(" "),t("li",[t("p",[s._v("-q，--quiet=true|false：仅输出 ID 信息，默认为否。")])])]),s._v(" "),t("p",[s._v("其中，还支持对输出结果进行控制的选项，如 -f. --filter=[]、--no-trunc=true|false、-q、--quiet=true|false 等。")]),s._v(" "),t("p",[s._v("更多子命令选项还可以通过 "),t("code",[s._v("man docker-images")]),s._v(" 来查看。")]),s._v(" "),t("h3",{attrs:{id:"_2、使用-tag-命令添加镜像标签"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、使用-tag-命令添加镜像标签"}},[s._v("#")]),s._v(" 2、使用 tag 命令添加镜像标签")]),s._v(" "),t("p",[s._v("为了方便在后续工作中使用特定镜像，还可以使用 "),t("code",[s._v("docker tag")]),s._v(" 命令来为本地镜像任意添加新的标签。 例如，添加 一 个新的 centos:latest 镜像标签：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag centos:latest mycentos\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("再次使用 "),t("code",[s._v("docker images")]),s._v(" 列出本地主机上镜像信息， 可以看到多了一 个 mycentos:latest 标签的镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY    TAG       IMAGE ID       CREATED        SIZE\nubuntu        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("     54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nhello-world   latest    d1165f221234   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" months ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\ncentos        latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\nmycentos      latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("之后， 用户就可以直接使用 mycentos:latest 来表示这个镜像了。\n细心的你可能注意到， 这些 mycentos:latest 镜像的 ID 跟 centos:latest 是完全一致的，它们实际上指向了同一个镜像文件，只是别名不同而巳。"),t("code",[s._v("docker tag")]),s._v(" 命令添加的标签实际上起到了类似链接的作用。")]),s._v(" "),t("h3",{attrs:{id:"_3、使用-inspect-命令查看详细信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、使用-inspect-命令查看详细信息"}},[s._v("#")]),s._v(" 3、使用 inspect 命令查看详细信息")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("docker [image] inspect")]),s._v(" 命令可以获取该镜像的详细信息，包括制作者、适应架构、各层的数字摘要等：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect ubuntu:18.04\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sha256:54919e10a95d6f756f7286dc0fa6b3e25b637a7f90e361504b0b14ab6762a547"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RepoTags"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ubuntu:18.04"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RepoDigests"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ubuntu@sha256:9bc830af2bef73276515a29aa896eedfa7bdf4bdbc5c1063b4c457a4bbb8cd79"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Parent"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Comment"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-08-31T01:20:48.414661265Z"')]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("上面代码返回的是一个 JSON 格式的消息，如果我们只要其中一项内容时，可以使用 -f 来指定，例如，获取镜像的 Architecture：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect -f "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".Architecture"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" ubuntu:18.04\namd64\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_4、使用-history-命令查看镜像历史"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、使用-history-命令查看镜像历史"}},[s._v("#")]),s._v(" 4、使用 history 命令查看镜像历史")]),s._v(" "),t("p",[s._v("既然镜像文件由多个层组成， 那么怎么知道各个层的内容具体是什么呢？这时候可以使用 "),t("code",[s._v("history")]),s._v(" 子命令，该命令将列出各层的创建信息。")]),s._v(" "),t("p",[s._v("例如，查看 ubuntu:18.04 镜像的创建过程，可以使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" ubuntu:18.04\nIMAGE          CREATED      CREATED BY                                      SIZE      COMMENT\n54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago   /bin/sh -c "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#(nop)  CMD ["bash"]                 0B        ')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("missing"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago   /bin/sh -c "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop) ADD file:425a053fd043786e9…  63.1MB    ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("过长的命令被自动截断了，可以使用前面提到的 --no-trunc 选项来输出完整命令。")])]),s._v(" "),t("h2",{attrs:{id:"搜寻镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搜寻镜像"}},[s._v("#")]),s._v(" 搜寻镜像")]),s._v(" "),t("p",[s._v("本节主要介绍 Docker 镜像的 "),t("code",[s._v("search")]),s._v(" 子命令。使用 "),t("code",[s._v("docker search")]),s._v(" 命令可以搜索 Docker Hub 官方仓库中的镜像。 语法为 "),t("code",[s._v("docker search [option] keyword")]),s._v("。支持的命令选项主要包括：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-f，--filter filter：过滤输出内容；")])]),s._v(" "),t("li",[t("p",[s._v("--format string：格式化输出内容；")])]),s._v(" "),t("li",[t("p",[s._v("--limit int：限制输出结果个数，默认为 25 个；")])]),s._v(" "),t("li",[t("p",[s._v("--no-trunc：不截断输出结果。")])])]),s._v(" "),t("p",[s._v("例如，搜索官方提供的带 nginx 关键字的镜像，如下所示：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search --filter"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("is-official"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true nginx\nNAME      DESCRIPTION                STARS     OFFICIAL   AUTOMATED\nnginx     Official build of Nginx.   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15394")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("       \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("再比如，搜索所有收藏数超过 4 的关键词包括 tensorflow 的镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search --filter"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("stars"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" tensorflow\nNAME                                       DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\ntensorflow/tensorflow                      Official Docker images "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the machine learn…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1944")]),s._v("                 \njupyter/tensorflow-notebook                Jupyter Notebook Scientific Python Stack w/ …   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("280")]),s._v("                  \ntensorflow/serving                         Official images "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" TensorFlow Serving "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("117")]),s._v("                  \nrocm/tensorflow                            Tensorflow with ROCm backend support            \t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),s._v("                   \nxblaster/tensorflow-jupyter                Dockerized Jupyter with tensorflow              \t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nfloydhub/tensorflow                        tensorflow                                      \t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nopensciencegrid/tensorflow-gpu             TensorFlow GPU "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" OSG                   \t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("                   \nemacski/tensorflow-serving                 Project images from https://github.com/emacs…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("                   \ntokunagaken/tensorflow-keras-jupyter-py3   TensorFlow-gpu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.13")]),s._v(".1 Keras "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.2")]),s._v(".4 python "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.5")]),s._v("…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("                    \ntensorflow/tf_grpc_test_server             Testing server "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" GRPC-based distributed ru…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("               \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("可以看到返回了很多包含关键字的镜像，其中包括镜像名字、描述、收藏数（表示该镜像的受欢迎程度）、是否官方创建、是否自动创建等。默认的输出结果将按照星级评价进行排序。")]),s._v(" "),t("h2",{attrs:{id:"删除和清理镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除和清理镜像"}},[s._v("#")]),s._v(" 删除和清理镜像")]),s._v(" "),t("p",[s._v("主要介绍 Docker 镜像的 "),t("code",[s._v("rm")]),s._v(" 和 "),t("code",[s._v("prune")]),s._v(" 子命令。")]),s._v(" "),t("h3",{attrs:{id:"_1、使用标签删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用标签删除镜像"}},[s._v("#")]),s._v(" 1、使用标签删除镜像")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("docker rmi")]),s._v(" 或 "),t("code",[s._v("docker image rm")]),s._v(" 命令可以删除镜像，命令格式为 "),t("code",[s._v("docker rmi IMAGE [IMAGE...]")]),s._v("，其中 IMAGE 可以为标签或 ID。")]),s._v(" "),t("p",[s._v("支持选项包括：")]),s._v(" "),t("ul",[t("li",[s._v("-f，-force：强制删除镜像，即使有容器依赖它；")]),s._v(" "),t("li",[s._v("-no-prune：不要清理未带标签的父镜像。")])]),s._v(" "),t("p",[s._v("例如，要删除掉 mycentos:latest 镜像，可以使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi mycentos:latest \nUntagged: mycentos:latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("你可能会想到，本地的 centos:latest 镜像是否会受到此命令的影响。无须担心，当同一个镜像拥有多个标签的时候，"),t("code",[s._v("docker rmi")]),s._v(" 命令只是删除了该镜像多个标签中的指定标签而巳，并不影响镜像文件。因此上述操作相当于只是删除了镜像 300e315adb2f 的一个标签副本而已。")]),s._v(" "),t("p",[s._v("保险起见，再次查看本地的镜像，发现 centos:latest 镜像（准确地说，300e315adb2f\n镜像）仍然存在：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY    TAG       IMAGE ID       CREATED        SIZE\nubuntu        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("     54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nhello-world   latest    d1165f221234   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" months ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\ncentos        latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("但当镜像只剩下一个标签的时候就要小心了，此时再使用 "),t("code",[s._v("docker rmi")]),s._v(" 命令会彻底删除镜像。")]),s._v(" "),t("p",[s._v("例如通过执行 "),t("code",[s._v("docker rmi")]),s._v(" 命令来删除只有一个标签的镜像，可以看出会删除这个镜像文件的所有文件层：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi hello-world:latest \nUntagged: hello-world:latest\nUntagged: hello-world@sha256:7d91b69e04a9029b99f3585aaaccae2baa80bcf318f4a5d2165a9898cd2dc0a1\nDeleted: sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726\nDeleted: sha256:f22b99068db93900abe17f7f5e09ec775c2826ecfe9db961fea68293744144bd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),t("p",[s._v("如果在删除镜像，遇到下面的 Erroe 时，需要先删除容器，再删除镜像。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、删除镜像时出现 Error")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi hello-world:latest \nError response from daemon: conflict: unable to remove repository reference "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello-world:latest"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("must force"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - container 882249d25e88 is using its referenced image d1165f221234\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、先删除容器（可以查到镜像所在容器的CONTAINER ID）")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\nCONTAINER ID   IMAGE          COMMAND    CREATED       STATUS                   PORTS     NAMES\n882249d25e88   hello-world    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago   Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago             priceless_neumann\ndba94731dbca   centos         "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago   Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago             romantic_benz\n810d3dbcd35b   ubuntu:18.04   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago   Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago             naughty_hoover\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除容器（对应的CONTAINER ID）")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 882249d25e88\n882249d25e88\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、最后删除镜像")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi hello-world:latest \nUntagged: hello-world:latest\nUntagged: hello-world@sha256:7d91b69e04a9029b99f3585aaaccae2baa80bcf318f4a5d2165a9898cd2dc0a1\nDeleted: sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726\nDeleted: sha256:f22b99068db93900abe17f7f5e09ec775c2826ecfe9db961fea68293744144bd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])])]),s._v(" "),t("h3",{attrs:{id:"_2、使用镜像-id-来删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、使用镜像-id-来删除镜像"}},[s._v("#")]),s._v(" 2、使用镜像 ID 来删除镜像")]),s._v(" "),t("p",[s._v("当使用 "),t("code",[s._v("docker rmi")]),s._v(" 命令，并且后面跟上镜像的 ID （也可以是能进行区分的部分 ID 前缀）时， 会先尝试删除所有指向该镜像的标签，然后删除该镜像文件本身。")]),s._v(" "),t("p",[s._v("注意，当有该镜像创建的容器存在时，镜像文件默认是无法被删除的，例如：先利用 ubuntu:18.04 镜像创建一个简单的容器来输出 一 段话：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run ubuntu:18.04 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello! I am here!'")]),s._v("\nhello"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" i am here"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("docker ps -a")]),s._v(" 命令可以看到本机上存在的所有容器：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\nCONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                      PORTS     NAMES\n586d17fcdf93   ubuntu:18.04   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \'hello! i am h…"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" seconds ago   Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" seconds ago             vigilant_wu\ndba94731dbca   centos         "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago      Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago                romantic_benz\n810d3dbcd35b   ubuntu:18.04   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago      Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" hours ago                naughty_hoover\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("可以看到，后台存在一个退出状态的容器，是刚基于 ubuntu:18.04 镜像创建的。试图删除该镜像，Docker 会提示有容器正在运行，无法删除：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi ubuntu:18.04 \nError response from daemon: conflict: unable to remove repository reference "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ubuntu:18.04"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("must force"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - container 810d3dbcd35b is using its referenced image 54919e10a95d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("如果要想强行删除镜像， 可以使用 -f 参数：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi -f ubuntu:18.04 \nUntagged: ubuntu:18.04\nUntagged: ubuntu@sha256:9bc830af2bef73276515a29aa896eedfa7bdf4bdbc5c1063b4c457a4bbb8cd79\nDeleted: sha256:54919e10a95d6f756f7286dc0fa6b3e25b637a7f90e361504b0b14ab6762a547\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("注意，通常并不推荐使用 -f 参数来强制删除一个存在容器依赖的镜像。正确的做法是，先删除依赖该镜像的所有容器，再来删除镜像。")]),s._v(" "),t("p",[s._v("首先删除容器 "),t("u",[s._v("586d17fcdf93")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 586d17fcdf93\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后使用 ID 来删除镜像，此时会正常打印出删除的各层信息：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi 54919e10a95d\nUntagged: ubuntu:18.04\nUntagged: ubuntu@sha256:9bc830af2bef73276515a29aa896eedfa7bdf4bdbc5c1063b4c457a4bbb8cd79\nDeleted: sha256:54919e10a95d6f756f7286dc0fa6b3e25b637a7f90e361504b0b14ab6762a547\nDeleted: sha256:6babb56be2593d69d561cae7ad16b670a1ee7c0a32b4fa715007fba7febd5ddb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_3、清理镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、清理镜像"}},[s._v("#")]),s._v(" 3、清理镜像")]),s._v(" "),t("p",[s._v("使用 Docker 一段时间后，系统中可能会遗留一些临时的镜像文件，以及一些没有被使用的镜像，可以通过 "),t("code",[s._v("docker image prune")]),s._v(" 命令来进行清理。")]),s._v(" "),t("p",[s._v("支待选项包括：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-a，-all：删除所有无用镜像，不光是临时镜像；")])]),s._v(" "),t("li",[t("p",[s._v("-filter filter：只清理符合给定过滤器的镜像；")])]),s._v(" "),t("li",[t("p",[s._v("-f，-force：强制删除镜像，而不进行提示确认。")])])]),s._v(" "),t("p",[s._v("例如，如下命令会自动清理临时的遗留镜像文件层，最后会提示释放的存储空间：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v(" $ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image prune -f\n "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n Total reclaimed space: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(" GB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"创建镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建镜像"}},[s._v("#")]),s._v(" 创建镜像")]),s._v(" "),t("p",[s._v("创建镜像的方法主要有三种：基于已有镜像的容器创建、基于本地模板导入、基于 Dockerfile 创建。")]),s._v(" "),t("p",[s._v("这里主要介绍 Docker 的 "),t("code",[s._v("commit")]),s._v("、"),t("code",[s._v("import")]),s._v(" 和 "),t("code",[s._v("build")]),s._v(" 子命令。")]),s._v(" "),t("h3",{attrs:{id:"_1、基于已有容器创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、基于已有容器创建"}},[s._v("#")]),s._v(" 1、基于已有容器创建")]),s._v(" "),t("p",[s._v("该方法主要是使用 "),t("code",[s._v("docker [container] commit")]),s._v(" 命令。")]),s._v(" "),t("p",[s._v("命令格式为 "),t("code",[s._v("docker [container] commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]")]),s._v("，主要选项包括：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v('-a，--author=""：作者信息；')])]),s._v(" "),t("li",[t("p",[s._v("-c，--change=[]：提交的时候执行 Dockerfile 指令，")]),s._v(" "),t("p",[s._v("包括CMD|ENTRYPOINT|ENV|EXPOSE|LABEL|ONBUILD|USER|VOLUME|WORKDIR 等；")])]),s._v(" "),t("li",[t("p",[s._v("-m，--message= “”：提交消息；")])]),s._v(" "),t("li",[t("p",[s._v("-p，--pause=true：提交时暂停容器运行。")])])]),s._v(" "),t("p",[s._v("下面将演示如何使用该命令创建一个新镜像。")]),s._v(" "),t("p",[s._v("首先，启动一个镜像，并在其中进行修改操作。例如，创建一个 test 文件，之后退出，代码如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it ubuntu:18.04 /bin/bash\nroot@38e4a9445436:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test")]),s._v("\nroot@38e4a9445436:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("记住容器的 ID 为 38e4a9445436。此时该容器与原 ubuntu:18.04 镜像相比，已经发生了改变，可以使用 "),t("code",[s._v("docker [container] commit")]),s._v(" 命令来提交为一个新的镜像。提交时可以使用 ID 或名称来指定容器：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ADDed a new file"')]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Docker Newbee"')]),s._v(" 38e4a9445436 test:0.1\nsha256:fdebc600d6f4ff0296917924668be67608af1af4ae10e4a9583478d9815a7969\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("顺利的话，会返回新创建镜像的 ID 信息，例如：")]),s._v(" "),t("p",[t("u",[s._v("fdebc600d6f4ff0296917924668be67608af1af4ae10e4a9583478d9815a7969")]),s._v("。")]),s._v(" "),t("p",[s._v("此时查看本地镜像列表，会发现新创建的镜像已经存在了：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY   TAG       IMAGE ID       CREATED          SIZE\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("       fdebc600d6f4   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" seconds ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nubuntu       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("     54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\ncentos       latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago     209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_2、基于本地模板导入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、基于本地模板导入"}},[s._v("#")]),s._v(" 2、基于本地模板导入")]),s._v(" "),t("p",[s._v("用户也可以直接从一个操作系统模板文件导人一个镜像，主要使用 docker [container] import 命令。命令格式为 "),t("code",[s._v("docker [image] import [OPTIONS] file|URL| - [REPOSITORY [:TAG]]")])]),s._v(" "),t("p",[s._v("要直接导人一个镜像，可以使用 OpenVZ 提供的模板来创建，或者用其他已导出的镜像模板来创建。OPENVZ 模板的下载地址为 "),t("a",{attrs:{href:"https://download.openvz.org/template/precreated/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.openvz.org/template/precreated/"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("例如，下载了 ubuntu-18.04 的模板压缩包，之后使用以下命令导人即可：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.openvz.org/template/precreated/centos-7-x86_64-minimal.tar.gz\n--2021-09-02 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":25:09--  https://download.openvz.org/template/precreated/centos-7-x86_64-minimal.tar.gz\n正在解析主机 download.openvz.org "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("download.openvz.org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("185.231")]),s._v(".241.69\n正在连接 download.openvz.org "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("download.openvz.org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("185.231")]),s._v(".241.69"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(":443"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 已连接。\n已发出 HTTP 请求，正在等待回应"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" OK\n长度： "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("145639219")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("139M"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("application/x-gzip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n正在保存至: “centos-7-x86_64-minimal.tar.gz”\n\ncentos-7-x86_64-minimal.tar.gz        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("138")]),s._v(".89M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".15MB/s    用时 4m 48ss\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-09-02 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":29:59 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("494")]),s._v(" KB/s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - 已保存 “centos-7-x86_64-minimal.tar.gz” "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("145639219")]),s._v("/145639219"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" centos-7-x86_64-minimal.tar.gz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" - centos:7\nsha256:f1dbb0e36a07382f4f6b2001836374e51d297c841fb1fe4e85dfa92ba3f43139\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("然后查看新导人的镜像，已经在本地存在了 :")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY   TAG       IMAGE ID       CREATED         SIZE\ncentos       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("         f1dbb0e36a07   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" seconds ago   435MB\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("       fdebc600d6f4   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nubuntu       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("     54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\ncentos       latest    300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago    209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_3、基于-dockefile-创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、基于-dockefile-创建"}},[s._v("#")]),s._v(" 3、基于 Dockefile 创建")]),s._v(" "),t("p",[s._v("基于 Dockerfile 创建是最常见的方式。Dockerfile 是一个文本文件，利用给定的指令描述基于某个父镜像创建新镜像的过程。")]),s._v(" "),t("p",[s._v("下面给出 Dockerfile 的一个简单示例，基于 debian:stretch-slim 镜像安装 Python 3 环境，构成一个新的 python:3 镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("FROM debian:stretch-slim\n\nLABEL "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("maintainer")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker user <docker_user@githubs>"')]),s._v("\n\nRUN "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" instal l-y python3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" clean "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/apt/lists/*\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("创建镜像的过程可以使用 "),t("code",[s._v("docker [image] build")]),s._v(" 命令，编译成功后本地将多出一个 python:3 镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t python:3 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nSending build context to Docker daemon  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".048kB\nStep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/3 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM debian:stretch-slim\n ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 750df3e387d7\nStep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/3 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" LABEL "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("maintainer")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker user <docker_user@githubs>"')]),s._v("\n ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 89c03eb7f46d\nStep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y python3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" clean "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/apt/lists/*\n ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 81e5fe4c9c9a\nGet:1 http://security.debian.org/debian-security stretch/updates InRelease "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53.0")]),s._v(" kB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nIgn:2 http://deb.debian.org/debian stretch InRelease\nGet:3 http://security.debian.org/debian-security stretch/updates/main amd64 Packages "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("710")]),s._v(" kB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nSetting up python3 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.5")]),s._v(".3-1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nrunning python rtupdate hooks "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" python3.5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nrunning python post-rtupdate hooks "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" python3.5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nProcessing triggers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" libc-bin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.24")]),s._v("-11+deb9u4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nRemoving intermediate container 81e5fe4c9c9a\n ---"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" cb3faf5fd7e5\nSuccessfully built cb3faf5fd7e5\nSuccessfully tagged python:3\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译完成，再次查看下镜像，多出一个 python 的镜像")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY   TAG            IMAGE ID       CREATED        SIZE\npython       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("              cb3faf5fd7e5   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" hours ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v(".2MB\ncentos       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("              f1dbb0e36a07   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" hours ago   435MB\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("            fdebc600d6f4   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" hours ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nubuntu       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("          54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\ndebian       stretch-slim   750df3e387d7   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("55")]),s._v(".3MB\ncentos       latest         300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("p",[s._v("更多使用 Dockerfile 的技巧将将在后面进行介绍。")]),s._v(" "),t("h2",{attrs:{id:"存出和载人镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存出和载人镜像"}},[s._v("#")]),s._v(" 存出和载人镜像")]),s._v(" "),t("p",[s._v("主要介绍 Docker 镜像的 "),t("code",[s._v("save")]),s._v(" 和 "),t("code",[s._v("load")]),s._v(" 子命令。用户可以使用 "),t("code",[s._v("docker save")]),s._v(" 和 "),t("code",[s._v("docker")]),s._v(" "),t("code",[s._v("[image] load")]),s._v(" 命令来存出和载人镜像 。")]),s._v(" "),t("h3",{attrs:{id:"_1、存出镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、存出镜像"}},[s._v("#")]),s._v(" 1、存出镜像")]),s._v(" "),t("p",[s._v("如果要导出镜像到本地文件，可以使用 "),t("code",[s._v("docker [image] save")]),s._v(" 命令。该命令支持 -o、-output string 参数，导出镜像到指定的文件中。")]),s._v(" "),t("p",[s._v("例如，导出本地的 ubuntu:18.04 镜像为文件 ubuntu_18.04.tar，如下所示：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY   TAG            IMAGE ID       CREATED        SIZE\npython       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("              cb3faf5fd7e5   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" hours ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v(".2MB\ncentos       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("              f1dbb0e36a07   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" hours ago   435MB\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("            fdebc600d6f4   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" hours ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\nubuntu       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.04")]),s._v("          54919e10a95d   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" days ago     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".1MB\ndebian       stretch-slim   750df3e387d7   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("55")]),s._v(".3MB\ncentos       latest         300e315adb2f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago   209MB\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" save -o ubuntu_18.04.tar ubuntu:18.04 \n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -lh\n总用量 63M\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("197")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":57 Dockerfile\n-rw------- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" 63M "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" 08:48 ubuntu_18.04.tar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("之后，用户就可以通过复制 ubuntu_18.04.tar 文件将该镜像分享给他人。")]),s._v(" "),t("h3",{attrs:{id:"_2、载入镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、载入镜像"}},[s._v("#")]),s._v(" 2、载入镜像")]),s._v(" "),t("p",[s._v("可以使用 "),t("code",[s._v("docker [image] load")]),s._v(" 将导出的 tar 文件再导人到本地镜像库。支持 -i、-input string 选项，从指定文件中读人镜像内容。")]),s._v(" "),t("p",[s._v("例如，从文件 ubuntu_18.04.tar 导人镜像到本地镜像列表，如下所示：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load -i ubuntu_ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" 04.tar\nLoaded image: ubuntu:18.04\n或者 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" ubuntu_18 04.tar\nLoaded image: ubuntu:18.04\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("这将导人镜像及其相关的元数据信息（包括标签等）。导入成功后，可以使用 "),t("code",[s._v("docker images")]),s._v(" 命令进行查看，与原镜像一致。")]),s._v(" "),t("h2",{attrs:{id:"上传镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传镜像"}},[s._v("#")]),s._v(" 上传镜像")]),s._v(" "),t("p",[s._v("主要介绍 Docker 镜像的 "),t("code",[s._v("push")]),s._v(" 子命令。可以使用 "),t("code",[s._v("docker [image] push")]),s._v(" 命令上传镜像到仓库，默认上传到 Docker Hub 官方仓库（需要登录）。")]),s._v(" "),t("p",[s._v("命令格式为 "),t("code",[s._v("docker push NAME [:TAG] | [image] [REGISTRY_HOST[:REGISTRY_PORT]/]NAME[:TAG]")]),s._v("。")]),s._v(" "),t("p",[s._v("用户在 Docker Hub 网站注册后可以上传自制的镜像。")]),s._v(" "),t("p",[s._v("例如，用户 user 上传本地的 test:latest 镜像，可以先添加新的标签 user/test:latest，然后用 "),t("code",[s._v("docker [image] push")]),s._v(" 命令上传镜像：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag test:latest user/test:latest\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push user/test:latest\nThe push refers to a repository "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/user/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nSending image list\n\nPlease login prior to push:\nUsername "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\nPassword:\nEmail "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("第一次上传时，会提示输入登录信息或进行注册，之后登录信息会记录到本地 "),t("code",[s._v("~/.docker")]),s._v("\n目录下。")]),s._v(" "),t("h2",{attrs:{id:"小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),t("p",[s._v("具体介绍了围绕 Docker 镜像的一系列重要命令操作，包括获取、查看、搜索、删除、创建、存出和载入、上传等。你可以使用 "),t("code",[s._v("docker image help")]),s._v(" 命令查看 Docker 支持的镜像操作子命令。")]),s._v(" "),t("p",[s._v("镜像是使用 Docker 的前提，也是最基本的资源。所以，在平时的 Docker 使用中，要注意积累自己定制的镜像文件，并将自己创建的高质量镜像分享到社区中。")])])}),[],!1,null,null,null);a.default=n.exports}}]);