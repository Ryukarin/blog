(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{1089:function(s,n,a){"use strict";a.r(n);var e=a(1),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("关于 kernel.img 系统内核文件，我们该如何去修改呢？一般此类型文件是很难打开或挂载的，那么就没有办法修改了吗，经过几天的查资料，其实也不难。对安卓开发的大神来说，那是轻而易举的，但对于没有开发经验的来说就比较困难了。")]),s._v(" "),a("p",[s._v("好了，下面直接把我折腾的内容整理一下。")]),s._v(" "),a("h2",{attrs:{id:"解压-kernel-img-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压-kernel-img-文件"}},[s._v("#")]),s._v(" 解压 kernel.img 文件")]),s._v(" "),a("h3",{attrs:{id:"查看文件类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看文件类型"}},[s._v("#")]),s._v(" 查看文件类型")]),s._v(" "),a("p",[s._v("要想解压某个文件，首先要知道该文件是什么类型的。用 "),a("code",[s._v("file")]),s._v(" 命令查看一下 "),a("code",[s._v("kernel.img")]),s._v(" 文件的类型。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("img$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" kernel.img\nkernel.img: Android bootimg, kernel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1080000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", ramdisk "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1000000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", page size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("由此可知，这是 Android bootimg 文件类型。那么，怎么解压呢？")]),s._v(" "),a("h3",{attrs:{id:"下载工具并解压"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载工具并解压"}},[s._v("#")]),s._v(" 下载工具并解压")]),s._v(" "),a("p",[s._v("在网上查找了相关资料，需要 "),a("code",[s._v("unpackbootimg")]),s._v(" 解包命令，"),a("code",[s._v("mkbootimg")]),s._v(" 打包命令。那这两个命令系统并没有，需要自行下载。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载项目 android-unpackbootimg")]),s._v("\nimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/anestisb/android-unpackbootimg.git bootimg\nimg.git bootimg\n正克隆到 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bootimg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nremote: Enumerating objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(", done.\nremote: Total "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", pack-reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n展开对象中: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("/50"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", 完成.\nimg$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" bootimg\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译此项目，会多出两个可执行文件 mkbootimg、unpackbootimg")]),s._v("\nimg/bootimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\ncc -O2 -Wall -Werror -Wno-address-of-packed-member -Iinclude -o mkbootimg mkbootimg.c  -L. -lmincrypt\ncc -O2 -Wall -Werror -Wno-address-of-packed-member -Iinclude -o unpackbootimg unpackbootimg.c  -L. -lmincrypt\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回上级目录并查看文件列表")]),s._v("\nimg/bootimg$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" kei kei     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":01 bootimg\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16543744")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":15 kernel.img\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建boot目录，把 kernel.img 解压缩到 boot 目录")]),s._v("\nimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" boot\nimg$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" bootimg/\nimg/bootimg$ ./unpackbootimg -i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img -o "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/boot\nBOARD_KERNEL_CMDLINE \nBOARD_KERNEL_BASE 01078000\nBOARD_NAME \nBOARD_PAGE_SIZE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\nBOARD_HASH_TYPE sha1\nBOARD_KERNEL_OFFSET 00008000\nBOARD_RAMDISK_OFFSET fff88000\nBOARD_SECOND_OFFSET ffe88000\nBOARD_TAGS_OFFSET fef88100\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压缩完成")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("补充")]),s._v(" "),a("p",[a("code",[s._v("mkbootimg")]),s._v("、"),a("code",[s._v("unpackbootimg")]),s._v(" 命令工具使用方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ ./unpackbootimg\nusage: unpackbootimg\n  -i|--input boot.img\n  [ -o|--output output_directory]\n  [ -p|--pagesize <size-in-hexadecimal> ]\n$ ./mkbootimg\nusage: mkbootimg\n       --kernel <filename>\n       [ --ramdisk <filename> ]\n       [ --second <2ndbootloader-filename> ]\n       [ --cmdline <kernel-commandline> ]\n       [ --board <boardname> ]\n       [ --base <address> ]\n       [ --pagesize <pagesize> ]\n       [ --dt <filename> ]\n       [ --kernel_offset <base offset> ]\n       [ --ramdisk_offset <base offset> ]\n       [ --second_offset <base offset> ]\n       [ --tags_offset <base offset> ]\n       [ --os_version <A.B.C version> ]\n       [ --os_patch_level <YYYY-MM-DD date> ]\n       [ --hash <sha1(default)|sha256> ]\n       [ --id ]\n       -o|--output <filename>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"查看解压后的文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看解压后的文件"}},[s._v("#")]),s._v(" 查看解压后的文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("img/bootimg$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/boot\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -lh\n总用量 17M\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-base\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-board\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-cmdline\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-hash\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-kerneloff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-pagesize\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".3M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-ramdisk.gz\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-ramdiskoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-secondoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-tagsoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei  12M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-zImage\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("有两个文件比较大：")]),s._v(" "),a("ul",[a("li",[s._v("kernel.img-ramdisk.gz：根文件系统")]),s._v(" "),a("li",[s._v("kernel.img-zImage：Linux 内核 zImage")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看这两个文件类型")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" kernel.img-ramdisk.gz \nkernel.img-ramdisk.gz: ASCII cpio archive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SVR4 with no CRC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cpio格式的文件")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" kernel.img-zImage \nkernel.img-zImage: lzop compressed data - version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.030")]),s._v(", LZO1X-999, os: Unix\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#lzop压缩的文件")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),a("p",[s._v("zImage 内核文件，一般不建议修改；但是 ramdisk 根文件系统是可以根据需要适当的修改。")])]),s._v(" "),a("h2",{attrs:{id:"修改-ramdisk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-ramdisk"}},[s._v("#")]),s._v(" 修改 ramdisk")]),s._v(" "),a("p",[s._v("kernel.img-ramdisk.gz 映像是一个最基础的小型文件系统，它包括了初始化系统所需要的全部核心文件，例如：初始化 init 进程以及 init.rc（可以用于设置很多系统的参数）等文件。我们怎么去修改它呢？")]),s._v(" "),a("h3",{attrs:{id:"挂载修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#挂载修改"}},[s._v("#")]),s._v(" 挂载修改")]),s._v(" "),a("p",[s._v("上面查了它是 cpio 格式的文件，那么我们就用 "),a("code",[s._v("cpio")]),s._v(" 进行挂载。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先，新建一个目录，用于挂载 kernel.img-ramdisk.gz")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" kernel.img-ramdisk\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" kernel.img-ramdisk/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cpio 命令进行挂载")]),s._v("\nimg/boot/kernel.img-ramdisk$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" cpio -i -F "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img-ramdisk.gz\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10696")]),s._v(" 块\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载成功后，查看文件列表")]),s._v("\nimg/boot/kernel.img-ramdisk$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 bin -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/bin\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 dev\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 etc\n-rwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3879")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 functions\n-rwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("38051")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 init\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 lib -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib\n-rwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2411")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 platform_init\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 sbin -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/sbin\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 splash\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 usr\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("然后，我们进入挂载的目录中，对需要改动的文件进行修改或替换等。（可能需要 sudo 权限）")]),s._v(" "),a("h3",{attrs:{id:"压缩还原"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#压缩还原"}},[s._v("#")]),s._v(" 压缩还原")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先对原先的kernel.img-ramdisk.gz做个备份（改名）")]),s._v("\nimg/boot/kernel.img-ramdisk$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img-ramdisk.gz "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img-ramdisk.gz.bk\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用 cpio 命令进行打包")]),s._v("\nimg/boot/kernel.img-ramdisk$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cpio -o -H newc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img-ramdisk.gz\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10696")]),s._v(" 块\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回上一级目录，查看生成的文件")]),s._v("\nimg/boot/kernel.img-ramdisk$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22116")]),s._v("\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-base\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-board\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-cmdline\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-hash\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-kerneloff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-pagesize\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" kei kei     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":00 kernel.img-ramdisk\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5476352")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":05 kernel.img-ramdisk.gz\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5476352")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-ramdisk.gz.bk\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-ramdiskoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-secondoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-tagsoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11652817")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-zImage\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"打包还原-kernel-img"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包还原-kernel-img"}},[s._v("#")]),s._v(" 打包还原 kernel.img")]),s._v(" "),a("h3",{attrs:{id:"查看解包信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看解包信息"}},[s._v("#")]),s._v(" 查看解包信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 成功生成 kernel.img-ramdisk.gz，那么原先的备份就不需要了，可以删除或移到其他位置")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" kernel.img-ramdisk.gz.bk\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16192")]),s._v("\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-base\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-board\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-cmdline\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-hash\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-kerneloff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-pagesize\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4887552")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":53 kernel.img-ramdisk.gz\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-ramdiskoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-secondoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-tagsoff\n-rw-rw-r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11652817")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 09:52 kernel.img-zImage\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看解包 kernel.img 的信息")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" kernel.img-base kernel.img-board kernel.img-cmdline kernel.img-hash kernel.img-kerneloff kernel.img-pagesize kernel.img-ramdiskoff kernel.img-secondoff kernel.img-tagsoff\n01078000\n\n\nsha1\n00008000\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\nfff88000\nffe88000\nfef88100\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看解包打包参数信息")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h3",{attrs:{id:"打包封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包封装"}},[s._v("#")]),s._v(" 打包封装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回到 kernel.img 所在目录，修改原文件名称，以防原文件被覆盖导致混淆")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" kei kei     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":10 boot\ndrwxrwxr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" kei kei     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":01 bootimg\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kei kei "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16543744")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":15 kernel.img\nimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" kernel.img kernel.img.bk\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据上面的参数信息，进行打包封装")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/bootimg/mkbootimg --kernel kernel.img-zImage --ramdisk kernel.img-ramdisk.gz --base 01078000 --kernel_offset 00008000  --ramdisk_offset fff88000 --second_offset ffe88000 --tags_offset fef88100 -o "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/kernel.img\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包封装完成后，返回上一级目录查看")]),s._v("\nimg/boot$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" kernel.img\nkernel.img: Android bootimg, kernel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1080000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", ramdisk "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1000000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", page size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\nimg$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" kernel.img.bk\nkernel.img: Android bootimg, kernel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1080000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", ramdisk "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x1000000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", page size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 和原版文件的信息对比，一样")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kernel.img 为后打包封装的，kernel.img.bk 为原文件")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);