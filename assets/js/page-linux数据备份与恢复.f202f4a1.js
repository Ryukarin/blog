(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1151:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("不知道大家有没有丢失过重要的数据呢？")]),s._v(" "),n("p",[s._v("丢失数据的理由是多种多样的，有人是因为重装系统时，没有把加密文件的密钥导出，重装系统后密钥丢失，导致所有的加密数据不能解密；也有人是因为在火车上笔记本电脑被别人调包，从而导致硬盘中的重要数据丢失；还有人是因为在系统中误执行了 "),n("code",[s._v("rm -rf")]),s._v(" 命令，导致整个根目录被人为清空。但由此带来的后果是一样严重的。")]),s._v(" "),n("p",[s._v("保护重要数据的最有效的方法就是“不要把鸡蛋都放在一只篮子里”，这就是数据备份最主要的作用。")]),s._v(" "),n("h2",{attrs:{id:"备份的重要性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份的重要性"}},[s._v("#")]),s._v(" 备份的重要性")]),s._v(" "),n("p",[s._v("前面我们已经学习了很多有关 Linux  系统的安全防范策略（例如用户管理、权限管理等），但安全永远是相对的，而不是绝对的。系统硬件的损坏，黑客的无孔不入，都是系统安全的大敌。在这种情况下，如果我们要保证系统安全和应用安全，备份是必不可少的一个步骤。")]),s._v(" "),n("p",[s._v("虽然 Linux 系统难免会因内部环境、底层硬件、外来黑客等因素的影响出现问题，但作为一名系统管理人员，自身的职责并不是要保证系统永远不出问题（事实上也是不可能做到的），而是要在系统出现故障或者崩溃时，能以最快的速度，用最短时间恢复系统的运行，保证数据的安全，从而将故障带来的损失降到最低。")]),s._v(" "),n("p",[s._v("要实现这样的目标，就要求系统管理人员对系统和业务应用有一个合理的备份恢复策略，完美的备份策略可以保证业务的 0 宕机时间和数据的完全恢复。有人说，既然数据备份非常重要，那我把重要数据在硬盘中保存一份，在移动硬盘中也保存一份，再刻录一张光盘，这样数据应该非常安全了吧？")]),s._v(" "),n("p",[s._v("对个人用户来讲，这样保存数据已经足够了；但是对企业用户来讲，还是有安全隐患的，因为这些数据还是放在同一个地方的。还记得美国的“9·11”事件吗？像美国纽约世贸中心那样的庞然大物也轰然倒塌。当然，相比这样的灾难来讲，数据的损失已经是微不足道的了，不过这仍然说明异地备份的重要性。所以，我们在备份数据的时候，不仅要把数据保存在多个存储介质中，还要考虑把重要数据异地保存。")]),s._v(" "),n("p",[s._v("至于在 Linux 系统中，有哪些数据应该被视为重要数据，又该如何备份？")]),s._v(" "),n("h2",{attrs:{id:"linux-中的哪些数据需要备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux-中的哪些数据需要备份"}},[s._v("#")]),s._v(" Linux 中的哪些数据需要备份")]),s._v(" "),n("p",[s._v("既然备份这么重要，那么对 Linux 服务器来讲，我们到底需要备份哪些数据呢？当然最理想的就是把整块硬盘中的数据都备份，甚至连分区和文件系统都备份，这样如果硬盘损坏，那么我们可以直接把备份硬盘中的数据导入损坏的硬盘，甚至可以直接用备份硬盘代替损坏的硬盘。从数据恢复角度来说，这样的整盘备份是最方便的（"),n("code",[s._v("dd")]),s._v(" 命令就可以实现整盘备份，类似于 Windows 中的 GHOST 软件)。不过这种备份的备份时间比较长，占用的硬盘空间较大，不太适合经常进行。我们最常进行的备份还是把系统中的重要数据进行备份。那么，哪些数据是 Linux 服务器中较为重要的、需要定时备份的数据呢？")]),s._v(" "),n("h3",{attrs:{id:"linux-服务器中的重要数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux-服务器中的重要数据"}},[s._v("#")]),s._v(" Linux 服务器中的重要数据")]),s._v(" "),n("p",[s._v("Linux 服务器中的哪些数据需要备份，可能不同的管理员有不同的理解，不过有这样一些数据是大家公认的需要备份的数据。")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("/root/")]),s._v(" 目录："),n("code",[s._v("/toot/")]),s._v(" 目录是管理员的家目录，很多管理员会习惯在这个目录中保存一些相关数据，那么，当进行数据备份时，需要备份此目录。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/home/")]),s._v(" 目录："),n("code",[s._v("/home/")]),s._v(" 目录是普通用户的家目录。如果是生产服务器，那么这个目录中也会保存大量的重要数据，应该备份。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/var/spool/mail/")]),s._v(" 目录：在默认情况下，所有的用户未读的邮件会保存在 "),n("code",[s._v("/var/spool/mail/")]),s._v(" 目录下和用户名相同的邮箱文件中，已读的邮件会保存在用户家目录下的 "),n("code",[s._v("mbox")]),s._v(" 文件中（"),n("code",[s._v("mail")]),s._v(" 命令默认如此保存，不过如果使用了 "),n("code",[s._v("hold")]),s._v(" 命令，那么不管邮件是否已读，都保存在 "),n("code",[s._v("/var/spool/mail/")]),s._v(" 目录中。可以使用 "),n("code",[s._v("mbox")]),s._v(" 命令恢复已读邮件保存在 "),n("code",[s._v("~/mbox")]),s._v(" 文件中）。一般情况下，用户的邮件也是需要备份的重要数据。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/etc/")]),s._v(" 目录：系统重要的配置文件保存目录，当然需要备份。")])]),s._v(" "),n("li",[n("p",[s._v("其他目录：根据系统的具体情况，备份你认为重要的目录。比如，我们的系统中有重要的日志，或者安装了 RPM 包的 MySQL 服务器（RPM 包安装的 mysql 服务，数据库保存在 "),n("code",[s._v("/var/lib/mysql/")]),s._v("目录中)，那么 "),n("code",[s._v("/var/")]),s._v(" 目录就需要备份；如果我们的服务器中安装了多个操作系统，或编译过新的内核，那么 "),n("code",[s._v("/boot")]),s._v(" 目录就需要备份。")])])]),s._v(" "),n("h3",{attrs:{id:"安装服务的数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装服务的数据"}},[s._v("#")]),s._v(" 安装服务的数据")]),s._v(" "),n("p",[s._v("我们的 Linux 服务器中会安装各种各样的应用程序，这些程序当然也有重要数据需要备份。不过应用程序是多种多样的，每种应用程序到底应该备份什么数据也不尽相同，要具体情况具体对待。这里拿最常见的 apache 服务和 mysql 服务来举例。")]),s._v(" "),n("ul",[n("li",[s._v("apache 服务需要备份如下内容：\n"),n("ul",[n("li",[s._v("配置文件。RPM 包安装的 apache 需要备份 "),n("code",[s._v("/etc/httpd/con/hpptd.conf")]),s._v("；源码包安装的 apache 则需要备份 "),n("code",[s._v("/usr/local/apache2/conf/httpd.conf")]),s._v("。")]),s._v(" "),n("li",[s._v("网页主目录。RPM 包安装的 apache 需要备份 "),n("code",[s._v("/var/www/html/")]),s._v(" 目录中所有的数据；源码包安装的 apache 需要备份 "),n("code",[s._v("/usr/local/apache2/htdocs/")]),s._v(" 目录中所有的数据。")]),s._v(" "),n("li",[s._v("日志文件。RPM 包安装的 apache 需要备份 "),n("code",[s._v("/var/log/httpd/")]),s._v(" 目录中所有的日志；源码包安装的 apache 需要备份 "),n("code",[s._v("/usr/local/apache2/logs/")]),s._v(" 目录中所有的日志。")])])])]),s._v(" "),n("p",[s._v("其实，对源码包安装的 apache 来讲，只要备份 "),n("code",[s._v("/usr/ocal/apache2/")]),s._v(" 目录中所有的数据即可，因为源码包安装的服务的所有数据都会保存到指定目录中。但如果是 RPM 包安装的服务，就需要单独记忆和指定了。")]),s._v(" "),n("ul",[n("li",[s._v("mysql 服务需要备份如下内容：\n"),n("ul",[n("li",[s._v("对于源码包安装的 mysql 服务，数据库默认安装到 "),n("code",[s._v("/usr/local/mysql/data/")]),s._v(" 目录中，只需备份此目录即可。")]),s._v(" "),n("li",[s._v("对于 RPM 包安装的 mysql 服务，数据库默认安装到 "),n("code",[s._v("/var/lib/mysql/")]),s._v(" 目录中，只需备份此目录即可。")])])])]),s._v(" "),n("p",[s._v("如果是源码包安装的服务，则可以直接备份 "),n("code",[s._v("/usr/local/")]),s._v(" 目录，因为一般源码包服务都会安装到 "),n("code",[s._v("/usr/local/")]),s._v(" 目录中。如果是 RPM 包安装的服务，则需要具体服务具体对待，备份正确的数据。")]),s._v(" "),n("h2",{attrs:{id:"备份策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份策略"}},[s._v("#")]),s._v(" 备份策略")]),s._v(" "),n("p",[s._v("常用的备份策略有"),n("strong",[s._v("完全备份")]),s._v("和"),n("strong",[s._v("增量备份")]),s._v("，而增量备份有可细分为累计增量备份和差异增量备份。下面来分别讲述不同备份策略以及之间的区别。")]),s._v(" "),n("h3",{attrs:{id:"完全备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#完全备份"}},[s._v("#")]),s._v(" 完全备份")]),s._v(" "),n("p",[s._v("完全备份是指把所有需要备份的数据全部备份。当然，完全备份可以备份整块硬盘、整个分区或某个具体的目录。对于 Linux 操作系统来说，完全备份指的就是将根目录下的所有文件进行备份。")]),s._v(" "),n("p",[s._v("完全备份的好处是，所有数据都进行了备份，系统中任何数据丢失都能恢复，且恢复效率较高。如果完全备份备份的是整块硬盘，那么甚至不需要数据恢复，只要把备份硬盘安装上，服务器就会恢复正常。")]),s._v(" "),n("p",[s._v("完全备份的缺点也很明显，那就是需要备份的数据量较大，备份时间较长，备份了很多无用数据，占用的空间较大，所以完全备份不可能每天执行。")]),s._v(" "),n("p",[s._v("我们一般会对关键服务器进行整盘完全备份，如果出现问题，则可以很快地使用备份硬盘进行替换，从而减少损失。我们甚至会对关键服务器搭设一台一模一样的服务器，这样只要远程几个命令（或使用 Shell 脚本自动检测，自动进行服务器替换），备份服务器就会接替原本的服务器，使故障响应时间大大缩短。")]),s._v(" "),n("h3",{attrs:{id:"累计增量备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#累计增量备份"}},[s._v("#")]),s._v(" 累计增量备份")]),s._v(" "),n("p",[s._v("在一个数据量很大的业务应用中，每天对 Linux 系统进行完全备份是不现实的，这就需要用到增量备份策略。")]),s._v(" "),n("p",[s._v("累计增量备份是指先进行一次完全备份，服务器运行一段时间之后，比较当前系统和完全备份的备份数据之间的差异，只备份有差异的数据。服务器继续运行，再经过一段时间，进行第二次增量备份。在进行第二次增量备份时，当前系统和第一次增量备份的数据进行比较，也是只备份有差异的数据。第三次增量备份是和第二次增量备份的数据进行比较，以此类推。")]),s._v(" "),n("p",[s._v("因此，累计增量备份就是只备份每天增加或者变化的数据，而不备份系统中没有变动的数据。我们画一张示意图，如图8-1 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(976),alt:"累计增量备份",loading:"lazy"}})]),s._v(" "),n("p",[n("strong",[s._v("图8-1 "),n("u",[s._v("累计增量备份")])])])]),s._v(" "),n("p",[s._v("假设我们在第一天进行一次完全备份。第二天增量备份时，只会备份第二天和第一天之间的差异数据，但是第二天的总备份数据是完全备份加第一次增量备份的数据。第三天增量备份时，只会备份第三天和第二天之间的差异数据，但是第三天的总备份数据是完全备份加第一次增量备份的数据，再加第二次增量备份的数据。当然，第四天增量备份时，只会备份第四天和第三天的差异数据，但是第四天的总备份数据是完全备份加第一次增量备份的数据，加第二次增量备份的数据，再加第三次增量备份的数据。")]),s._v(" "),n("p",[s._v("采用累计增量备份的好处是，每次备份需要备份的数据较少，耗时较短，占用的空间较小；坏处是数据恢复比较麻烦，如果是图1  的例子，那么当进行数据恢复时，就要先恢复完全备份的数据，再依次恢复第一次增量备份的数据、第二次增量备份的数据和第三次增量备份的数据，最终才能恢复所有的数据。")]),s._v(" "),n("h3",{attrs:{id:"差异增量备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#差异增量备份"}},[s._v("#")]),s._v(" 差异增量备份")]),s._v(" "),n("p",[s._v("差异增量备份（后续简称差异备份）也要先进行一次完全备份，但是和累计增量备份不同的是，每次差异备份都备份和原始的完全备份不同的数据。也就是说，差异备份每次备份的参照物都是原始的完全备份，而不是上一次的差异备份。我们也画一张示意图，如图8-2 所示。")]),s._v(" "),n("div",{staticClass:"custom-block center"},[n("p",[n("img",{attrs:{src:a(977),alt:"差异增量备份",loading:"lazy"}})]),s._v(" "),n("p",[n("strong",[s._v("图8-2\t"),n("u",[s._v("差异增量备份")])])])]),s._v(" "),n("p",[s._v("假设我们在第一天也进行一次完全备份。第二天差异备份时，会备份第二天和第一天之间的差异数据，而第二天的备份数据是完全备份加第一次差异备份的数据。第三天进行差异备份时，仍和第一天的原始数据进行对比，把第二天和第三天所有的数据都备份在第二次差异备份中，第三天的备份数据是完全备份加第二次差异备份的数据。第四天进行差异备份时，仍和第一天的原始数据进行对比，把第二天、第三天和第四天所有的不同数据都备份到第三次差异备份中，第四天的备份数据是完全备份加第三次差异备份的数据。")]),s._v(" "),n("p",[s._v("相比较而言，差异备份既不像完全备份一样把所有数据都进行备份，也不像增量备份在进行数据恢复时那么麻烦，只要先恢复完全备份的数据，再恢复差异备份的数据即可。不过，随着时间的增加，和完全备份相比，变动的数据越来越多，那么差异备份也可能会变得数据量庞大、备份速度缓慢、占用空间较大。")]),s._v(" "),n("p",[s._v("一个比较的备份策略是，对于数据量不大，并且每天数据量增加不多的系统，优先选择完全备份；对于数据量巨大，每天新增数据也很多的系统，视情况选择差异备份或者增量备份。")]),s._v(" "),n("h2",{attrs:{id:"备份和恢复"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份和恢复"}},[s._v("#")]),s._v(" 备份和恢复")]),s._v(" "),n("p",[s._v("其实数据备份就是把数据复制一份保存在其他位置，如果能够压缩一下，当然就更好了。那我们使用 "),n("code",[s._v("tar")]),s._v(" 或 "),n("code",[s._v("cp")]),s._v(" 命令可以实现数据的备份吗？当然可以，不过它们只能实现完全备份，如果要实现增量备份和差异备份，就必须写 Shell 脚本来实现了。")]),s._v(" "),n("p",[s._v("作为 Linux 系统管理员，最经常使用的备份工具就是 "),n("code",[s._v("tar")]),s._v(" 和 "),n("code",[s._v("cpio")]),s._v(" 命令。前面已经学过，此处不做说明。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("tar 备份脚本示例")]),s._v(" "),n("p",[s._v("下面通过 "),n("code",[s._v("tar")]),s._v(" 命令做的一个 Web 服务器的备份脚本，详细了解 "),n("code",[s._v("tar")]),s._v(" 命令作为备份工具时的具体用法。")]),s._v(" "),n("p",[s._v("以下是一个有关 Web 服务器的备份脚本：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BAKDATE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%y%m%d"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DATA3")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3 days ago"')]),s._v(" +%y%m%d"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("osdata")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/disk1\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("userdata")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/disk2\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"backup OS data starting"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/etc.data/etc_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /etc\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/boot.data/boot_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /boot\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/home.data/home_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /home\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/root.data/root_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /root\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/usr_data/usrlocal_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /usr/local\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/var_www/www_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BAKDATE")]),s._v(".tar.gz /var/www\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/* /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/* /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Backup OS data complete!"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delete OS data 3 days ago"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/etc.data/etc_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/boot.data/boot_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/home.data/home_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/root.data/root_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/usr_data/usrlocal_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$osdata")]),s._v("/var_www/www_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/etc.data/etc_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/boot.data/boot_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/home.data/home_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/root.data/root_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/usr_data/usrlocal_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userdata")]),s._v("/var_www/www_"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATA3")]),s._v(".tar.gz\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delete cws ok!"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("p",[s._v("上面这段脚本完成的工作是，将系统和用户的备份数据分别保存在两个不同的本地磁盘 disk1 和 disk2 中，并且保留最近 3 天的数据，3 天前的数据自动删除。主要备份的数据有 "),n("code",[s._v("/etc")]),s._v(" 目录、"),n("code",[s._v("/boot")]),s._v(" 目录、"),n("code",[s._v("/home")]),s._v(" 目录、"),n("code",[s._v("/root")]),s._v(" 目录、"),n("code",[s._v("/usr/local")]),s._v(" 目录和 "),n("code",[s._v("/var/www")]),s._v(" 目录。当然这里只是举个例子，凡是存放数据的重要目录，都需要进行备份。")]),s._v(" "),n("p",[s._v("将此脚本放到系统守护进程（类似于 Windows 下的计划任务）crontab 下，设定备份时间，即可实现定时数据备份。有关 crontab 的详细介绍，请看前面的 Linux 工作管理。")])]),s._v(" "),n("h3",{attrs:{id:"dump-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dump-命令"}},[s._v("#")]),s._v(" dump 命令")]),s._v(" "),n("p",[s._v("在 Linux 中给我们准备了专用的备份和恢复命令，那就是 "),n("code",[s._v("dump")]),s._v(" 和 "),n("code",[s._v("restore")]),s._v("，它们可以轻松地实现数据备份和数据恢复，而且它们是可以直接实现增量备份和差异备份的。")]),s._v(" "),n("p",[s._v("在系统学习 "),n("code",[s._v("dump")]),s._v(" 命令之前，由于 CentOS 6.x 系统默认是没有安装此命令的，因此需要我们手动安装 "),n("code",[s._v("dump")]),s._v(" 命令，安装命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ～"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install dump")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("code",[s._v("dump")]),s._v(" 命令使用“备份级别”来实现增量备份，它支持 0～9 共 10 个备份级别。其中，0 级别指的就是完全备份，1～9 级别都是增量备份级别。")]),s._v(" "),n("p",[s._v("举个列子，当我们备份一份数据时，第一次备份应该使用 0 级别，会把所有数据完全备份一次；第二次备份就可以使用 1 级别了，它会和 0 级别进行比较，把 0 级别备份之后变化的数据进行备份；第三次备份使用 2 级别，2 级别会和 1 级别进行比较，把 1 级别备份之后变化的数据进行备份，以此类推。")]),s._v(" "),n("p",[n("u",[s._v("需要注意的是，只有在备份整个分区或整块硬盘时，才能支持 1～9 的增量备份级别；如果只是备份某个文件或不是分区的目录，则只能使用 0 级别进行完全备份。")])]),s._v(" "),n("p",[n("code",[s._v("dump")]),s._v(" 命令的基本格式如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump [选项] 备份之后的文件名 原文件或目录")]),s._v("\n选项：\n\t-level\t\t：就是我们说的 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("～9 共 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" 个备份级别\n\t-f 文件名\t：指定备份之后的文件名\n\t-u\t\t\t：备份成功之后，把备份时间、备份级别以及实施备份的文件系统等信息，都记录在 /etc/dumpdates 文件中\n\t-v\t\t\t：显示备份过程中更多的输出信息\n\t-j\t\t\t：调用 bzlib 库压缩备份文件，其实就是把备份文件压缩为 .bz2 格式，默认压缩等级是 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\t-W\t\t\t：显示允许被 dump 的分区的备份等级及备份时间\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[n("code",[s._v("dump")]),s._v(" 命令是一个较为复杂的命令，如果我们只是想要实现数据的备份与恢复，那么掌握以上几个选项就足够了。")]),s._v(" "),n("h4",{attrs:{id:"备份分区"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份分区"}},[s._v("#")]),s._v(" 备份分区")]),s._v(" "),n("p",[s._v("​")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\n文件系统\t容量\t已用\t可用\t已用%\t挂载点\n/dev/sda3\t20G\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".0G\t16G\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("%\t\t/\ntmpfs\t\t306M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\t\t306M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%\t\t/dev/shm\n/dev/sda1\t194M\t26M\t\t158M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("%\t\t/boot\n/dev/sr0\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".5G\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".5G\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%\t/mnt/cdrom\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#系统中我们就分了/分区和/boot分区。根分区太大,备份速度太慢,我们还是备份/boot分区吧")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("rootSlocalhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump -0uj -f /root/boot.bak.bz2 /boot/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份命令。先执行一次完全备份,并压缩和更新备份时间")]),s._v("\nDUMP: Date of this level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dump: Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:22 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份的级别和时间")]),s._v("\nDUMP: Dumping /dev/sdal "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/boot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to /root/boot.bak.bz2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份源和目标")]),s._v("\nDUMP: Label: none\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#分区没有卷标")]),s._v("\nDUMP: Writing "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" Kilobyte records\nDUMP: Compressing output at compression level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bzlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份时压缩")]),s._v("\nDUMP: mapping "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pass I"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("regular files"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nDUMP: mapping "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pass II"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("directories"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nDUMP: estimated "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21846")]),s._v(" blocks.\nDUMP: Volume "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" started with block "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" at： Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:22 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDUMP: dumping "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pass III"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("directories"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开始dump 备份")]),s._v("\nDUMP: dumping "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pass XV"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("regular files"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nDUMP: Closing /root/boot.bak.bz2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份结朿，生成备份文件")]),s._v("\nDUMP: Volume "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" completed at: Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:30 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDUMP: Volume "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" took "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:08\nDUMP: Volume "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" transfer rate: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2370")]),s._v(" kB/s\nDUMP: Volume "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 21930kB uncompressed, 18962kB compressed, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.157")]),s._v(":1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据容量")]),s._v("\nDUMP: 2X930 blocks "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(".42MB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" on "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" volume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDUMP: finished "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds, throughput "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3132")]),s._v(" kBytes/sec\nDUMP: Date of this level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dump: Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:22 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDUMP: Date this dump completed: Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:30 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDUMP: Average transfer rate: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2370")]),s._v(" kB/s\nDUMP: Wrote 21930kB uncompressed, 18962kB compressed, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.157")]),s._v(":1\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/dumpdates")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看备份时间文件")]),s._v("\n/dev/sdal\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\tWed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08:22 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v(" +0800\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份的分区\t备份级别\t备份曰期")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost @"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /root/boot.bak.bz2")]),s._v("\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root 19M "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03:08 /root/boot.bak.bz2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份文件生成了")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br")])]),n("p",[s._v("如果 "),n("code",[s._v("/boot")]),s._v(" 分区的内容发生了变化，则可以使用 1 级别进行增量备份。当然，如果数据会继续发生变化，则可以继续使用 2～9 级别增量备份。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /root/install.log")]),s._v("\n-rw-r--r--.1 root root 25K "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("：49 /root/install.log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看安装软件包日志的大小为25KB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp install.log /boot/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#复制日志文件到/boot分区")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump -1uj -f /root/boot.bak1.bz2 /boot/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#增量备份/boot分区，并压缩")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h boot.bak*")]),s._v("\n-rw-r--r--.1 root root 18K "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03：16 boot.bak1.bz2\n-rw-r--r--.1 root root 19M "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03：08 boot.bak.bz2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#boot.bak1.bz2压缩文件只有18KB，证明增量备份只备份了0级别以后变化的数据")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("如果备份的是整个分区，那么是可以使用 "),n("code",[s._v("dump -W")]),s._v(" 命令来查询分区的备份时间及备份级别的。不过要注意，如果备份时没有使用“-u”选项，那么 "),n("code",[s._v("dump -W")]),s._v(" 命令是不会记录备份的时间和级别的。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump -W")]),s._v("\nLast dump"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Dump "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'>'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" systems"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：\n/dev/sda3 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\t\t/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Last dump：Level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("， Date Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 02：31：50 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\n/dev/sda1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\t/boot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Last dump：Level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("， Date Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03：16：27 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/分区和/boot分区都进行过dump备份，/boot分区的最新备份级别是1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("code",[s._v("dump")]),s._v(" 命令可以非常方便地实现增量备份，但是如何实现差异备份呢？其实也很简单，先使用 0 级别完全备份一次，以后的每次备份都使用 1 级别进行备份。")]),s._v(" "),n("h4",{attrs:{id:"备份文件或目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份文件或目录"}},[s._v("#")]),s._v(" 备份文件或目录")]),s._v(" "),n("p",[n("code",[s._v("dump")]),s._v(" 命令也可以文件或目录，不过，只要不是备份分区，就只能使用 0 级别进行完全备份，而不再支持增量备份。同时，不能使用“-u”选项更新分区的备份时间，当然也不能使用 "),n("code",[s._v("dump -W")]),s._v(" 命令查询到文件或目录的备份。")]),s._v(" "),n("p",[s._v("我们说 "),n("code",[s._v("/etc/")]),s._v(" 目录是重要的配置文件目录，那么我们就备份这个目录来看看吧。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump -0j -f /root/etc.dump.bz2 /etc/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#完全备份/etc/目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /root/etc.dump.bz2")]),s._v("\n-rw-r--r--.1 root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 03：26 /root/etc.dump.bz2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看备份文件")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("不过，如果使用增量备份会怎么样呢？命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump -1j -f /root/etc.dump1.bz2 /etc/")]),s._v("\nDUMP：Only level "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dumps are allowed on a subdirectory\nDUMP：The ENTIRE dump is aborted.\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份失败了，目录备份只能使用0级别")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"restore-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#restore-命令"}},[s._v("#")]),s._v(" restore 命令")]),s._v(" "),n("p",[n("code",[s._v("restore")]),s._v(" 命令是 "),n("code",[s._v("dump")]),s._v(" 命令的配套命令，"),n("code",[s._v("dump")]),s._v(" 命令是用来备份分区和数据的，而 "),n("code",[s._v("restore")]),s._v(" 命令是用来恢复数据的。")]),s._v(" "),n("p",[n("code",[s._v("restore")]),s._v(" 命令的基本格式如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore [模式选项] [-f]")]),s._v("\n模式选项：\n\trestore 命令常用的模式有以下 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 种，这 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 种模式不能混用：\n\t-C：比较备份数据和实际数据的变化。如果实际数据中的现有数据发生了变化，那么这个选项能够检测到这个变化。\n\t\t但是如果实际数据中新增了数据，那么这个选项是不能检测到变化的\n\t-i：进入交互模式，手工选择需要恢复的文件\n\t-t：查看模式，用于查看备份文件中拥有哪些数据\n\t-r：还原模式，用于数据还原\n\t\n选项：\t\n\t-f：选项用于指定备份文件的文件名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h4",{attrs:{id:"比较备份数据和实际数据的变化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#比较备份数据和实际数据的变化"}},[s._v("#")]),s._v(" 比较备份数据和实际数据的变化")]),s._v(" "),n("p",[s._v("这里大家需要注意，数据比较只有在原有数据减少或发生变化时才能检测到变化，而新增的数据是不会被检测到的。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch /boot/abc")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在/boot/目录中新建abc文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -C -f /root/boot.bak.bz2")]),s._v("\nDump tape is compressed.\nDump date：Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 08：20：02 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDumped from：the epoch\nLevel "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dump of /boot on localhost：/dev/sda1\nLabel：none\nfilesys "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /boot\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#restore检测，没有发现任何变化（当然，因为备份数据在备份时没有abc文件，所以restore命令是不能识别新建文件的）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv /boot/vmlinuz-2.6.32-279.el6.i686 /boot/vmlinuz-2.6.32-279.el6.i686.bak")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把/boot/目录中的内核镜像文件改一个名字")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -C -f /root/boot.bak.bz2")]),s._v("\nDump tape is compressed.\nDump date：Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 08：20：02 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\nDumped from：the epoch\nLevel "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dump of /boot on localhost：/dev/sda1\nLabel：none\nfilesys "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /boot\nrestore：unable to "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" ./vmlinuz-2.6.32-279.el6.i686：No such "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory Some files were modified！ "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" compare errors\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#restore发现内核镜像文件丢失")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("这个实验比较危险，一定要记得把内核镜像文件的名字改回来，否则一旦重启，系统就会无法正常启动。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv /boot/vmlinuz-2.6.32-279.el6.i686.bak /boot/vmlinuz2.6.32-279.el6.i686")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"查看模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看模式"}},[s._v("#")]),s._v(" 查看模式")]),s._v(" "),n("p",[s._v("这种模式比较简单，就是查看备份文件中到底包含什么内容。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -t -f boot.bak.bz2")]),s._v("\nDump tape is compressed．\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份数据是压缩的")]),s._v("\nDump date：Wed Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 08：20：02 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据备份时间")]),s._v("\nDumped from：the epoch\nLevel "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" dump of /boot on localhost：/dev/sda1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份等级")]),s._v("\nLabel：none\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#分区的卷标，没有设定卷标")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" ./lost+found\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" ./grub\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" ./grub/grub.conf\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" ./grub/splash.xpm.gz\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".省略部分输出"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h4",{attrs:{id:"还原模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#还原模式"}},[s._v("#")]),s._v(" 还原模式")]),s._v(" "),n("p",[n("code",[s._v("restore")]),s._v(" 命令的还原模式既可以用于还原整个分区，也可以用于还原文件或目录。命令格式是一样的，不过要注意，如果要还原增量备份的数据，则一定要先还原完全备份的数据。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#还原boot.bak.bz2分区备份")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先还原完全备份的数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir boot.test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#建立准备解压缩的目录。当然，如果这个目录是我新建的分区，就可以直接把数据恢复到分区中")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd boot.test/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入解压缩目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost boot.test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -r -f /root/boot.bak.bz2")]),s._v("\nDump tape is compressed.\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份数据是压缩数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#解压缩")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost boot.test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看一下解压缩的文件")]),s._v("\n总用量21300\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("106611")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 config-2.6.32-279.el6.i686\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":47 efi\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":49 grub\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14708399")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":49 initrara£s-2.6.32-279.el6.i686.img\ndrwx------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":44 lost+found\n-rw-------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("47504")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:44 restoresymtable\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("175903")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 symvers-2.6.32-279.el6.i686.gz\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846041")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 System.map-2.6.32-279.el6.i686\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 02:38 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n-rwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3856608")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 vmlinuz-2.6.32-279.el6.i686\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#再还原增量备份的数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost boot.test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -r -f /root/boot.bakl.bz2")]),s._v("\nDump tape is compressed.\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#恢复增量备份的数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost boot.test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n总用量21328\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("106611")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 config-2.6.32-279.el6.i686\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":47 efi\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":49 grub\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14708399")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":49 initramfs-2.6.32-279.eX6.i686.img\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24772")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 08:20 install. log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#增量备份的install.log文件被恢复了")]),s._v("\ndrwx------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":44 lost+found\n-rw-------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("47552")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:57 restoresymtable\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("175903")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 symvers-2.6.32-279.el6.i686.gz\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846041")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 System.map-2.6.32-279.el6.i686\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 02:38 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n-rwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3856608")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":12 vmlinuz-2.6.32-279.el6.i686\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("p",[s._v("我们再来还原 "),n("code",[s._v("/etc/")]),s._v(" 目录的备份 "),n("code",[s._v("etc.dump.bz2")]),s._v("，其实还原的方法是完全一样的。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restore -r -f etc.dump.bz2")]),s._v("\nDump tape is compressed.\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#还原etc.dump.bz2备份")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -d /root/etc")]),s._v("\ndrwxr-xr-x.103 root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12288")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 07:45 /root/etc\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在root下生成了etc目录，里面的数据和/etc/目录中的数据完全一致")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"dd命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dd命令"}},[s._v("#")]),s._v(" dd命令")]),s._v(" "),n("p",[n("code",[s._v("dd")]),s._v(" 命令主要用来进行数据备份，并且可以在备份的过程中进行格式转换。其实 "),n("code",[s._v("dd")]),s._v(" 命令可以把源数据复制成目标数据，而且不管源数据是文件、分区、磁盘还是光盘，都可以进行数据备份。")]),s._v(" "),n("p",[n("code",[s._v("dd")]),s._v(" 命令的基本格式如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# dd if="输入文件" of="输出文件" bs="数据块" count="数量"')]),s._v("\n参数：\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\t\t\t：定义输入数据的文件，也可以是输入设备；\n\tof\t\t\t：定义输出数据的文件，也可以是输出设备；\n\tbs\t\t\t：指定数据块的大小，也就是定义一次性读取或写入多少字节。模式数据块大小是 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" 字节；\n\tcount\t\t：指定 bs 的数量；\n\t"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("conv")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("标志\t：依据标志转换文件。\n\t\n\t\t标志有以下这些：\n\t\tascii\t：由 EBCDIC 码转换至 ASCII 码；\n\t\tebcdic\t：由 ASCII 码转换至 EBCDIC 码；\n\t\tibm\t\t：由 ASCII 码转换至替换的 EBCDIC 码；\n\t\tblock\t：将结束字符块里的换行替换成等长的空格；\n\t\tunblock\t：将 cbs 大小的块中尾部的空格替换为一个换行符；\n\t\tlcase\t：将大写字符转换为小写；\n\t\tnotrunc\t：不截断输出文件；\n\t\tucase\t：将小写字符转换为大写；\n\t\tswab\t：交换每一对输入数据字节；\n\t\tnoerror\t：读取数据发生错误后仍然继续；\n\t\t"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\t：将每个输入数据块以 NUL 字符填满至 ibs 的大小；当配合 block 或 unblock 时，会以空格代替 NUL 字符填充；\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h4",{attrs:{id:"备份文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份文件"}},[s._v("#")]),s._v(" 备份文件")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/etc/httpd/conf/httpd.conf of=/tmp/httpd.bak")]),s._v("\n记录了67+1 的读入\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据占了写满的67个数据块，以及1个没有写满的数据块")]),s._v("\n记录了67+1 的写出\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#默认数据块大小是512字节")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("34439")]),s._v("字节"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("已复制，0.0524897 秒，656 kB/秒\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果要备份文件，那么dd命令和cp命令非常类似")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /tmp/httpd.bak")]),s._v("\n-rw-r--r--.1 root root 34K "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("：04 /tmp/httpd.bak\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看一下生成的备份文件的大小")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"备份分区为一个备份文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份分区为一个备份文件"}},[s._v("#")]),s._v(" 备份分区为一个备份文件")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\n文件系统\t容量\t已用\t可用\t已用%%\t挂载点\n/dev/sda3\t20G\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G\t17G\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("%\t\t/\ntmpfs\t\t306M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\t\t306M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%\t\t/dev/shm\n/dev/sda1\t194M\t27M\t\t157M\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("%\t\t/boot\n/dev/sr0\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".5G\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".5G\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%\t/mnt/cdrom\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看一下分区容量，我们备份/boot分区")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/sda1 of=/tmp/boot.bak")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份完成")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /tmp/boot.bak")]),s._v("\n-rw-r--r--.1 root root 200M "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("：14 /tmp/boot.bak\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看生成的备份文件")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果需要恢复，则执行以下命令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/tmp/boot.bak of=/dev/sda1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果想要把分区直接备份成另一个分区，就需要生成一个新的分区，")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这个分区的大小不能比源分区小，只能和源分区大小一致或比它大。命令如下：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/sda1 of=/dev/sdb1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果需要恢复，则只需把输入项和输出项反过来即可，命令如下：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/sdb1 of=/dev/sda1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h4",{attrs:{id:"整盘备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整盘备份"}},[s._v("#")]),s._v(" 整盘备份")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/sda of=/dev/sdb")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把磁盘a备份到磁盘b")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/sda of=/tmp/disk.bak")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把磁盘a备份成文件disk.bak")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份恢复")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果要备份到另一块硬盘上，那么，当源硬盘数据损坏时，只需用备份硬盘替换源硬盘即可")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果要备份成文件，那么在恢复时需要把备份数据复制到其他Linux中，然后把新硬盘安装到这台Linux")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务器上，再把磁盘备份数据复制到新硬盘中。命令如下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/tmp/disk.bak of=/dev/sdb")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"复制软盘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复制软盘"}},[s._v("#")]),s._v(" 复制软盘")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/fd0 of=/tmp/fd.bak")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在Linux中软盘的设备文件名是/dev/fd0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这条命令先把软盘中的数据保存为临时数据文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/tmp/fd.bak of=/dev/fd0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#然后更换新的软盘，把数据备份复制到新软盘中，就实现了软盘的复制")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"复制光盘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复制光盘"}},[s._v("#")]),s._v(" 复制光盘")]),s._v(" "),n("p",[s._v("如果需要备份的是光盘，那么在 Linux 中就是使用 "),n("code",[s._v("dd")]),s._v(" 命令制作光盘的 ISO 镜像的。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#制作光盘ISO镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/cdrom of=/tmp/cd.iso")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把光盘中所有的数据制作成ISO镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~J "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /mnt/cd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#建立一个新的挂载点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -o loop /tmp/cd.iso /mnt/cd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#挂栽ISO文件到挂载点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /mnt/cd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入挂栽点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost cd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nCentOS_BuildTag images RELEASE-NOTES-en-tJS.html RPM-GPG-KEY-CentOS-Debug-6 TRANS.TBL\nEULA    isolinux repodata   RPM-GPG-KEY-CentOS-Security-6\nGPL Packages RPM-GPG-KEY-CentOS-6 RPM-GPG-KEY-CentOS-Testing-6\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据是光盘当中的数据,这个ISO镜像是可以被当作真正的光盘使用的")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h4",{attrs:{id:"其他"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),n("p",[s._v("我们有时需要制作指定大小的文件，比如，在增加 swap 分区时，就需要建立指定大小的文件，这时也使用 "),n("code",[s._v("dd")]),s._v(" 命令。命令如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/zero of=/tmp/testfile bs=1M count=10")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据输入项是/dev/zero会向目标文件中不停地写入二进制的0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定数据块大小是1MB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定生成10个数据块。也就是定义输出的文件大小为10MB")]),s._v("\n记录了10+0 的读入\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示数据占满了10个数据块")]),s._v("\n记录了10+0 的写出\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不过这里数据块的大小已经是1MB了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10485760")]),s._v("字节"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" MB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("已复制，0.00709902 秒，1.5 GB/秒\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /tmp/testfile")]),s._v("\n-rw-r--r--.1 root root 10M "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("：46 /tmp/testfile\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成的testfile文件的大小刚好是10MB")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[n("code",[s._v("dd")]),s._v(" 命令在进行整盘复制时，类似于 GHOST 工具的功能，不过通过 "),n("code",[s._v("dd")]),s._v(" 命令复制出来的硬盘数据要比 GHOST 复制出来的硬盘数据稳定得多。虽然 "),n("code",[s._v("dd")]),s._v(" 命令功能强大，不过也有一个明显的缺点，就是复制的时间较长，复制 100GB 的数据需要 15～25 分钟（根据服务器的性能不同而不同）。")]),s._v(" "),n("p",[s._v("实现数据备份还有非常多的方法和工具，比如 "),n("code",[s._v("tar")]),s._v(" 和 "),n("code",[s._v("cpio")]),s._v(" 命令。至于网络复制工具，如 rsync 和 scp 等，需要较完善的网络知识才能够学习，这里不再介绍。")])])}),[],!1,null,null,null);t.default=e.exports},976:function(s,t,a){s.exports=a.p+"assets/img/bk1.3a51e758.jpg"},977:function(s,t,a){s.exports=a.p+"assets/img/bk2.a26379a1.jpg"}}]);