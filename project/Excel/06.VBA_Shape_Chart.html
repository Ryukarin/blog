<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.36" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://ryukarin.github.io/blog/blog/project/Excel/06.VBA_Shape_Chart.html"><meta property="og:site_name" content="KARIN"><meta property="og:title" content="VBA 之 Shape、Chart 对象"><meta property="og:type" content="article"><meta property="og:image" content="https://ryukarin.github.io/blog/blog/"><meta property="og:locale" content="zh-CN"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="VBA 之 Shape、Chart 对象"><meta property="article:tag" content="Excel"><meta property="article:published_time" content="2021-07-02T00:00:00.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><title>VBA 之 Shape、Chart 对象 | KARIN</title><meta name="description" content="KARIN的学习笔记">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/blog/assets/style.5f3eb3a7.css">
    <link rel="modulepreload" href="/blog/assets/app.893f8b81.js"><link rel="modulepreload" href="/blog/assets/06.VBA_Shape_Chart.html.16c0eef4.js"><link rel="modulepreload" href="/blog/assets/06.VBA_Shape_Chart.html.5733db97.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/blog/" class="home-link"><img class="logo" src="/blog/logo.png" alt="KARIN"><!----><span class="site-name hide-in-pad">KARIN</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" arialabel="博客主页"><i class="icon iconfont icon-home"></i>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/project.html" class="nav-link" arialabel="项目总览"><i class="icon iconfont icon-folder"></i>项目总览<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/IT" class="nav-link" arialabel="知识要点"><i class="icon iconfont icon-edit"></i>知识要点<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/operate" class="nav-link" arialabel="捣鼓折腾"><i class="icon iconfont icon-operate"></i>捣鼓折腾<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="linux"><span class="title"><i class="icon iconfont icon-linux"></i>linux</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/project/Linux/Linux_basic" class="nav-link" arialabel="linux基础知识"><i class="icon iconfont icon-linux"></i>linux基础知识<!----></a></li><li class="dropdown-item"><a href="/blog/project/Linux/Linux_manage" class="nav-link" arialabel="linux系统管理"><i class="icon iconfont icon-linux"></i>linux系统管理<!----></a></li><li class="dropdown-item"><a href="/blog/project/Linux/Linux_mix" class="nav-link" arialabel="linux大杂烩"><i class="icon iconfont icon-linux"></i>linux大杂烩<!----></a></li><li class="dropdown-item"><a href="/blog/project/Linux/Shell" class="nav-link" arialabel="shell脚本笔记"><i class="icon iconfont icon-shell"></i>shell脚本笔记<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/blog/project/Git" class="nav-link" arialabel="Git笔记"><i class="icon iconfont icon-hot"></i>Git笔记<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/project/Excel" class="nav-link active" arialabel="Excel修炼秘籍"><i class="icon iconfont icon-table"></i>Excel修炼秘籍<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/Ryukarin/blog" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" arialabelledby="outlook"><title id="outlook" lang="en">outlook icon</title><g fill="currentColor"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></g></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索文档" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/blog/" class="nav-link sidebar-link sidebar-page" arialabel="博客主页"><i class="icon iconfont icon-home"></i>博客主页<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project.html" class="nav-link sidebar-link sidebar-page" arialabel="项目总览"><i class="icon iconfont icon-folder"></i>项目总览<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-edit"></i><span class="title">知识要点</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-operate"></i><span class="title">捣鼓折腾</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-linux"></i><span class="title">Linux</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-hot"></i><span class="title">Docker笔记</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-git"></i><span class="title">Git笔记</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><i class="icon iconfont icon-table"></i><span class="title">Excel修炼秘籍</span><span class="arrow down"></span></button><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/blog/project/Excel/" class="nav-link sidebar-link sidebar-page" arialabel="Excel 笔记介绍"><!---->Excel 笔记介绍<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/01.Excel_hotkey.html" class="nav-link sidebar-link sidebar-page" arialabel="Excel 快捷键"><!---->Excel 快捷键<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/02.Excel_function.html" class="nav-link sidebar-link sidebar-page" arialabel="Excel 函数"><!---->Excel 函数<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/03.VBA_Range.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 Range 对象"><!---->VBA 之 Range 对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/04.VBA_Sheet.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 Sheet 对象"><!---->VBA 之 Sheet 对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/05.VBA_Workbook.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 Workbook 对象"><!---->VBA 之 Workbook 对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="VBA 之 Shape、Chart 对象"><!---->VBA 之 Shape、Chart 对象<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_53、在工作表中添加图形" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="53、在工作表中添加图形"><!---->53、在工作表中添加图形<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_54、导出工作表中的图片" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="54、导出工作表中的图片"><!---->54、导出工作表中的图片<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_55、在工作表中添加艺术字" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="55、在工作表中添加艺术字"><!---->55、在工作表中添加艺术字<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_56、遍历工作表中的图形" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="56、遍历工作表中的图形"><!---->56、遍历工作表中的图形<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_57、移动、旋转图片" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="57、移动、旋转图片"><!---->57、移动、旋转图片<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_58、工作表中自动插入图片" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="58、工作表中自动插入图片"><!---->58、工作表中自动插入图片<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_59、固定工作表中图形的位置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="59、固定工作表中图形的位置"><!---->59、固定工作表中图形的位置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_60、使用-vba-自动生成图表" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="60、使用 VBA 自动生成图表"><!---->60、使用 VBA 自动生成图表<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_61、使用独立窗口显示图表" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="61、使用独立窗口显示图表"><!---->61、使用独立窗口显示图表<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_62、导出工作表中的图表" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="62、导出工作表中的图表"><!---->62、导出工作表中的图表<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_63、多图表制作" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="63、多图表制作"><!---->63、多图表制作<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/07.VBA_Application.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 Application 对象"><!---->VBA 之 Application 对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/08.VBA_dialog.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 使用对话框"><!---->VBA 之 使用对话框<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/09.VBA_menu_toolbar.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 菜单和工具栏"><!---->VBA 之 菜单和工具栏<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/10.VBA_controls_form_1.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 控件与用户窗体1"><!---->VBA 之 控件与用户窗体1<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/11.VBA_controls_form_2.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 控件与用户窗体2"><!---->VBA 之 控件与用户窗体2<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/12.VBA_controls_form_3.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 控件与用户窗体3"><!---->VBA 之 控件与用户窗体3<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/13.VBA_function.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 函数的使用"><!---->VBA 之 函数的使用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/project/Excel/14.VBA_fso.html" class="nav-link sidebar-link sidebar-page" arialabel="VBA 之 文件操作"><!---->VBA 之 文件操作<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->VBA 之 Shape、Chart 对象</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://ryukarin.github.io/blog/" target="_blank" rel="noopener noreferrer">karin</a></span><span property="author" content="karin"></span></span><!----><span class="date-info" arialabel="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2021年7月2日</span><meta property="datePublished" content="2021-07-02T00:00:00.000Z"></span><span class="category-info" arialabel="分类🌈" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" arialabelledby="category"><title id="category" lang="en">category icon</title><g fill="currentColor"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></g></svg><ul class="categories-wrapper"><li class="category category8 clickable" role="navigation">笔记</li><meta property="articleSection" content="笔记"></ul></span><span arialabel="标签🏷" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" arialabelledby="tag"><title id="tag" lang="en">tag icon</title><g fill="currentColor"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></g></svg><ul class="tags-wrapper"><li class="tag tag5 clickable" role="navigation">Excel</li></ul><meta property="keywords" content="Excel"></span><span class="reading-time-info" arialabel="阅读时间⌛" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" arialabelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>大约 28 分钟</span><meta property="timeRequired" content="PT28M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_53、在工作表中添加图形" class="router-link-active router-link-exact-active toc-link level2">53、在工作表中添加图形</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_54、导出工作表中的图片" class="router-link-active router-link-exact-active toc-link level2">54、导出工作表中的图片</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_55、在工作表中添加艺术字" class="router-link-active router-link-exact-active toc-link level2">55、在工作表中添加艺术字</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_56、遍历工作表中的图形" class="router-link-active router-link-exact-active toc-link level2">56、遍历工作表中的图形</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_57、移动、旋转图片" class="router-link-active router-link-exact-active toc-link level2">57、移动、旋转图片</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_58、工作表中自动插入图片" class="router-link-active router-link-exact-active toc-link level2">58、工作表中自动插入图片</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_59、固定工作表中图形的位置" class="router-link-active router-link-exact-active toc-link level2">59、固定工作表中图形的位置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_60、使用-vba-自动生成图表" class="router-link-active router-link-exact-active toc-link level2">60、使用 VBA 自动生成图表</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_61、使用独立窗口显示图表" class="router-link-active router-link-exact-active toc-link level2">61、使用独立窗口显示图表</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_62、导出工作表中的图表" class="router-link-active router-link-exact-active toc-link level2">62、导出工作表中的图表</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/project/Excel/06.VBA_Shape_Chart.html#_63、多图表制作" class="router-link-active router-link-exact-active toc-link level2">63、多图表制作</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h2 id="_53、在工作表中添加图形" tabindex="-1"><a class="header-anchor" href="#_53、在工作表中添加图形" aria-hidden="true">#</a> 53、在工作表中添加图形</h2><p>如果需要在工作表中添加图形对象，可以使用 AddShape 方法，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> AddShape<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myShape <span class="token keyword">As</span> Shape
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span><span class="token string">&quot;myShape&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">Set</span> myShape <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">.</span>AddShape<span class="token punctuation">(</span>msoShapeRectangle<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> myShape
		<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;myShape&quot;</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>Characters
			<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;单击将选择Sheet2!&quot;</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>Font
				<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;华文行楷&quot;</span>
				<span class="token punctuation">.</span>FontStyle <span class="token operator">=</span> <span class="token string">&quot;常规&quot;</span>
				<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">22</span>
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">7</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>TextFrame	
			<span class="token punctuation">.</span>HorizontalAlignment <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4108</span>
			<span class="token punctuation">.</span>VerticalAlignment <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4108</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token punctuation">.</span>Placement <span class="token operator">=</span> <span class="token number">3</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	myShape<span class="token punctuation">.</span><span class="token keyword">Select</span>
	<span class="token keyword">With</span> Selection<span class="token punctuation">.</span>ShapeRange
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Line
			<span class="token punctuation">.</span>Weight <span class="token operator">=</span> <span class="token number">1</span>
			<span class="token punctuation">.</span>DashStyle <span class="token operator">=</span> msoLineSolid
			<span class="token punctuation">.</span>Style <span class="token operator">=</span> msoLineSingle
			<span class="token punctuation">.</span>Transparency <span class="token operator">=</span> <span class="token number">0</span>
			<span class="token punctuation">.</span>Visible <span class="token operator">=</span> msoTrue
			<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>SchemeColor <span class="token operator">=</span> <span class="token number">40</span>
			<span class="token punctuation">.</span>BackColor<span class="token punctuation">.</span>RGB <span class="token operator">=</span> RGB<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Fill
			<span class="token punctuation">.</span>Transparency <span class="token operator">=</span> <span class="token number">0</span>
			<span class="token punctuation">.</span>Visible <span class="token operator">=</span> msoTrue
			<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>SchemeColor <span class="token operator">=</span> <span class="token number">41</span>
			<span class="token punctuation">.</span>OneColorGradient <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.23</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
	Sheet1<span class="token punctuation">.</span>Hyperlinks<span class="token punctuation">.</span>Add Anchor<span class="token punctuation">:</span><span class="token operator">=</span>myShape<span class="token punctuation">,</span> Address<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
		SubAddress<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Sheet2!A1&quot;</span><span class="token punctuation">,</span> ScreenTip<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;选择Sheet2!&quot;</span>
	<span class="token keyword">Set</span> myShape <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>代码解析：</p><p>AddShape 过程在工作表中添加一个矩形并设置其外观等属性。</p><p>第 2 行代码声明变量 myShape 的对象类型。</p><p>第 3、4 行代码删除可能存在的名称为“myShape”的图形对象。</p><p>第 5 行代码使用 AddShape 方法在工作表中添加一个矩形。当该方法应用于 Shapes 对象时，返回一个 Shape 对象，该对象代表工作表中的新自选图形，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>AddShape<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Top<span class="token punctuation">,</span> Width<span class="token punctuation">,</span> Height<span class="token punctuation">)</span>

参数expression是必需的，返回一个Shapes对象。
参数<span class="token keyword">Type</span>是必需的，指定要创建的自选图形的类型。
参数Left和Top是必需的，以磅为单位给出自选图形边框左上角的位置。
参数Width和Height是必需的，以磅为单位给出自选图形边框的宽度和高度。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>第 7 行代码将新建图形命名为“myShape”，向 Shapes 集合添加新的图形时，将对新添加的图形赋以默认的名称，若要为图形指定更有意义的名称，可指定其 Name 属性。</p><p>第 8 行到第 16 行代码为矩形添加文字，并设定其格式。</p><p>其中第 8 行代码使用 TextFrame 属性和 Characters 方法返回该矩形的字符区域。应用于 Shape 对象的 TextFrame 属性返回一个 TextFrame 对象，该对象包含指定图形对象的对齐和定位属性；Characters 方法返回一个 Characters 对象，该对象代表某个图形的文本框中的字符区域，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Characters<span class="token punctuation">(</span>Start<span class="token punctuation">,</span> Length<span class="token punctuation">)</span>

参数expression是必需的，返回一个指定文本框内Characters对象的表达式。
参数Start是可选的，表示将要返回的第一个字符，如果此参数设置为 <span class="token number">1</span> 或被忽略，则Characters方法会返回以第一个字符为起始字符的字符区域。
参数Length是可选的，表示要返回的字符个数。如果此参数被忽略，则Characters方法会返回该字符串的剩余部分（由Start参数指定的字符以后的所有字符）。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>第 9 行代码为矩形添加文字，应用于 Characters 对象的 Text 属性返回或设置对象的文本，为可读写的 String 类型。</p><p>第 10 行到第 15 行代码设置矩形中文字的属性，应用于 Characters 对象 Font 属性返回一个 Font 对象，该对象代表指定对象的字体属性（字体名称、字体大小、字体颜色等），第 11 行代码设置字体名称，第 12 行代码设置字体样式，第 13 行代码设置字体大小，第 14 行代码颜色。</p><p>第 17 行到第 20 行代码设定矩形中文字的对齐方式。应用于 TextFrame 对象的 HorizontalAlignment 属性返回或设置指定对象的水平对齐方式，可为表格 53-1 所示的 XlHAlign常量之一。</p><p><u>表格 53-1</u> HorizontalAlignment 属性的 XlHAlign 常量</p><table><thead><tr><th>常量</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>xlHAlignCenter</td><td>-4108</td><td>居中</td></tr><tr><td>xlHAlignCenterAcrossSelection</td><td>7</td><td>靠左</td></tr><tr><td>xlHAlignDistributed</td><td>-4117</td><td>分散对齐</td></tr><tr><td>xlHAlignFill</td><td>5</td><td>分散对齐</td></tr><tr><td>xlHAlignGeneral</td><td>1</td><td>靠左</td></tr><tr><td>xlHAlignJustify</td><td>-4130</td><td>两端对齐</td></tr><tr><td>xlHAlignLeft</td><td>-4131</td><td>靠左</td></tr><tr><td>xlHAlignRight</td><td>-4152</td><td>靠右</td></tr></tbody></table><p>应用于 TextFrame 对象的 VerticalAlignment 属性返回或设置指定对象的垂直对齐方式，可为表格 53-2 所示的 XlHAlign 常量之一。</p><p><u>表格 53-2</u> VerticalAlignment 属性的 XlHAlign 常量</p><table><thead><tr><th>常量</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>xlVAlignCenter</td><td>-4108</td><td>居中</td></tr><tr><td>xlVAlignJustify</td><td>-4130</td><td>两端对齐</td></tr><tr><td>xlVAlignBottom</td><td>-4107</td><td>靠下</td></tr><tr><td>xlVAlignDistributed</td><td>-4117</td><td>分散对齐</td></tr><tr><td>xlVAlignTop</td><td>-4160</td><td>靠上</td></tr></tbody></table><p>第 21 行代码设置矩形大小和位置不随单元格而变，应用于 Shape 对象的 Placement 属性返回或设置对象与所在的单元格之间的附属关系，可为表格 53-3 所示的 XlPlacement 常量之一。</p><p><u>表格 53-3</u> XlPlacement 常量</p><table><thead><tr><th>常量</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>xlFreeFloating</td><td>3</td><td>大小、位置均固定</td></tr><tr><td>xlMove</td><td>2</td><td>大小固定、位置随单元格而变</td></tr><tr><td>xlMoveAndSize</td><td>1</td><td>大小、位置随单元格而变</td></tr></tbody></table><p>第 24 行到第 32 行代码设置矩形的边框线条格式，应用于 ShapeRange 集合的 Line 属性返回一个 LineFormat 对象，该对象包含指定图形的线条格式属性。</p><p>其中第 26 行代码设置矩形线条粗细，第 27 行代码设置矩形线条的虚线样式，第 28 行代码设置矩形填充的透明度，第 29 行代码设置矩形为可见，第 30 行代码设置矩形的前景色，第 31 行代码设置矩形填充背景的颜色。</p><p>第 33 行到第 38 行代码设置矩形的内部填充格式，应用于 ShapeRange 集合的 Fill 属性返回 FillFormat 对象，该对象包含指定的图表或图形的填充格式属性。</p><p>其中第 35 行代码设置矩形内部的透明度，第 36 行代码设置矩形内部为可见，第 37 行代码设置矩形内部的前景色，第 38 行代码将矩形内部指定填充设为单色渐变，应用于 FillFormat 对象的 OneColorGradient 方法将指定填充设为单色渐变，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>OneColorGradient<span class="token punctuation">(</span>Style<span class="token punctuation">,</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> Degree<span class="token punctuation">)</span>

其中参数Style是必需的，底纹样式，可为表格 <span class="token number">54</span><span class="token operator">-</span><span class="token number">1</span>所示的MsoGradientStyle常量之一。
参数<span class="token keyword">Variant</span>是必需的，渐变变量。取值范围为 <span class="token number">1</span> 到 <span class="token number">4</span> 之间，分别与<span class="token string">“填充效果”</span>对话框中<span class="token string">“渐变”</span>选项卡的四个渐变变量相对应。如果GradientStyle 设为 msoGradientFromCenter，则<span class="token keyword">Variant</span>参数只能设为 <span class="token number">1</span> 或 <span class="token number">2</span>。
参数Degree是必需的，灰度。取值范围为 <span class="token number">0.0</span>（表示最深）到 <span class="token number">1.0</span>（表示最浅）之间。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><u>表格 53-4</u> MsoGradientStyle 常量</p><table><thead><tr><th>常量</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>msoGradientDiagonalDown</td><td>4</td><td>斜下</td></tr><tr><td>msoGradientDiagonalUp</td><td>3</td><td>斜上</td></tr><tr><td>msoGradientFromCenter</td><td>7</td><td>无</td></tr><tr><td>msoGradientFromCorner</td><td>5</td><td>角部幅射</td></tr><tr><td>msoGradientFromTitle</td><td>6</td><td>中心幅射</td></tr><tr><td>msoGradientHorizontal</td><td>1</td><td>水平</td></tr><tr><td>msoGradientMixed</td><td>-2</td><td>无</td></tr><tr><td>msoGradientVertical</td><td>2</td><td>垂直</td></tr></tbody></table><p>第 42、43 行代码为矩形对象添加超链接，应用于 Hyperlinks 对象的 Add 方法向指定的区域或图形添加超链接，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Anchor<span class="token punctuation">,</span> Address<span class="token punctuation">,</span> SubAddress<span class="token punctuation">,</span> ScreenTip<span class="token punctuation">,</span> TextToDisplay<span class="token punctuation">)</span>

参数expression是必需的，返回一个Hyperlinks对象。
参数Anchor是必需的，超链接的位置。可为Range对象或Shape对象。
参数Address是必需的，超链接的地址。
参数SubAddress是必需的，超链接的子地址。
参数ScreenTip是可选的，当鼠标指针停留在超链接上时所显示的屏幕提示。
参数TextToDisplay是可选的，要显示的超链接的文本。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>运行 AddShape 过程结果如图 53-1 所示。</p><div class="custom-container center"><p><img src="/blog/assets/53-1.342eb5c7.png" alt="" loading="lazy"></p><p><u>图 53-1</u> 在工作表中添加图形</p></div><h2 id="_54、导出工作表中的图片" tabindex="-1"><a class="header-anchor" href="#_54、导出工作表中的图片" aria-hidden="true">#</a> 54、导出工作表中的图片</h2><p>有时需要将工作表中的图形对象保存为单独的图像文件，可以使用 Export 方法将工作表中的图片以文件形式导出，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ExportShp<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Shp <span class="token keyword">As</span> Shape
	<span class="token keyword">Dim</span> FileName <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Shp <span class="token keyword">In</span> Sheet1<span class="token punctuation">.</span>Shapes
		<span class="token keyword">If</span> Shp<span class="token punctuation">.</span><span class="token keyword">Type</span> <span class="token operator">=</span> msoPicture <span class="token keyword">Then</span>
			FileName <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\&quot;</span> <span class="token operator">&amp;</span> Shp<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">&quot;.gif&quot;</span>
			Shp<span class="token punctuation">.</span>Copy
			<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Shp<span class="token punctuation">.</span>Width <span class="token operator">+</span> <span class="token number">28</span><span class="token punctuation">,</span> Shp<span class="token punctuation">.</span>Height <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Chart
				<span class="token punctuation">.</span>Paste
				<span class="token punctuation">.</span>Export FileName<span class="token punctuation">,</span> <span class="token string">&quot;gif&quot;</span>
				<span class="token punctuation">.</span>Parent<span class="token punctuation">.</span>Delete
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>代码解析：</p><p>ExportShp 过程将 Sheet1 工作表的所有图片以文件形式导出到同一目录中。</p><p>第 4 行代码使用 For Each...Next 语句遍历 Sheet1 工作表中的所有图形。</p><p>第 5 行代码判断图形的类型是否为图片，应用于 Shape 对象的 Type 属性返回或设置图形类型，可以为表格 54-1 所示的 MsoShapeType 常量之一。</p><p><u>表格 54-1</u> MsoShapeType 常量</p><table><thead><tr><th>常量</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>msoShapeTypeMixed</td><td>-2</td><td>混合型图形</td></tr><tr><td>msoAutoShape</td><td>1</td><td>自选图形</td></tr><tr><td>msoCallout</td><td>2</td><td>没有边框线的标注</td></tr><tr><td>msoChart</td><td>3</td><td>图表</td></tr><tr><td>msoComment</td><td>4</td><td>批注</td></tr><tr><td>msoFreeform</td><td>5</td><td>任意多边形</td></tr><tr><td>msoGroup</td><td>6</td><td>图形组合</td></tr><tr><td>msoFormControl</td><td>8</td><td>窗体控件</td></tr><tr><td>msoLine</td><td>9</td><td>线条</td></tr><tr><td>msoLinkedOLEObject</td><td>10</td><td>链接式或内嵌OLE对象</td></tr><tr><td>msoLinkedPicture</td><td>11</td><td>剪贴画或图片</td></tr><tr><td>msoOLEControlObject</td><td>12</td><td>ActiveX 控件</td></tr><tr><td>msoPicture</td><td>13</td><td>图片</td></tr><tr><td>msoTextEffect</td><td>15</td><td>艺术字</td></tr><tr><td>msoTextBox</td><td>17</td><td>文本框</td></tr><tr><td>msoDiagram</td><td>21</td><td>组织结构图或其他图示</td></tr></tbody></table><p>第 6 行代码使用字符串变量 FileName 记录需导出图形的路径和名称。</p><p>第 7 行代码复制图形，应用于 Shape 对象的 Copy 方法将对象复制到剪贴板。</p><p>第 8 行代码使用 Add 方法在工作表中添加一个图表，应用于 ChartObjects 对象的 Add 方法创建新的嵌入图表，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Left<span class="token punctuation">,</span> Top<span class="token punctuation">,</span> Width<span class="token punctuation">,</span> Height<span class="token punctuation">)</span>

参数expression是必需的，返回一个ChartObjects对象。
参数Left、参数Top是必需的，以磅为单位给出新对象的初始坐标，该坐标是相对于工作表上单元格A1的左上角或图表的左上角的坐标。
参数Width、参数Height是必需的，以磅为单位给出新对象的初始大小。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>第 9 行代码使用 Paste 方法将图形粘贴到新的嵌入图表中，应用于 Chart 对象的 Paste 方法将剪贴板中的图表数据粘贴到指定的图表中，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Paste<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">)</span>

参数expression是必需的，返回一个Chart对象。
参数<span class="token keyword">Type</span>是可选的的，如果剪贴板中有图表，本参数指定要粘贴的图表信息。可为以下XlPasteType常量之一：xlFormats、xlFormulas或xlAll。默认值为xlAll，如果剪贴板中是数据不是图表，则不能使用本参数。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>第 10 行代码使用 Export 方法将图表导出到同一目录中，应用于 Chart 对象的 Export 方法以图形格式导出图表，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Export<span class="token punctuation">(</span>Filename<span class="token punctuation">,</span> FilterName<span class="token punctuation">,</span> Interactive<span class="token punctuation">)</span>

其中参数Filename是必需的，被导出的文件的名称。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第 10 行代码删除新建的图表。因为 Chart 对象是不能使用 Delete 方法直接删除的，应先使用 Parent 属性返回指定对象的父对象，然后使用 Delete 方法删除。</p><h2 id="_55、在工作表中添加艺术字" tabindex="-1"><a class="header-anchor" href="#_55、在工作表中添加艺术字" aria-hidden="true">#</a> 55、在工作表中添加艺术字</h2><p>在工作表中插入艺术字，可以使用 AddTextEffect 方法，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> TextEffect<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myShape <span class="token keyword">As</span> Shape
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span><span class="token string">&quot;myShape&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	<span class="token keyword">Set</span> myShape <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">.</span>AddTextEffect <span class="token operator">_</span>
			<span class="token punctuation">(</span>PresetTextEffect<span class="token punctuation">:</span><span class="token operator">=</span>msoTextEffect15<span class="token punctuation">,</span> <span class="token operator">_</span>
			Text<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;我爱 Excel Home&quot;</span><span class="token punctuation">,</span> FontName<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> FontSize<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token operator">_</span>
			FontBold<span class="token punctuation">:</span><span class="token operator">=</span>msoFalse<span class="token punctuation">,</span> FontItalic<span class="token punctuation">:</span><span class="token operator">=</span>msoFalse<span class="token punctuation">,</span> <span class="token operator">_</span>
			Left<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> Top<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> myShape
		<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;myShape&quot;</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Fill
			<span class="token punctuation">.</span>Solid
			<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>SchemeColor <span class="token operator">=</span> <span class="token number">55</span>
			<span class="token punctuation">.</span>Transparency <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">With</span> <span class="token punctuation">.</span>Line
			<span class="token punctuation">.</span>Weight <span class="token operator">=</span> <span class="token number">1.5</span>
			<span class="token punctuation">.</span>DashStyle <span class="token operator">=</span> msoLineSolid
			<span class="token punctuation">.</span>Style <span class="token operator">=</span> msoLineSingle
			<span class="token punctuation">.</span>Transparency <span class="token operator">=</span> <span class="token number">0</span>
			<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>SchemeColor <span class="token operator">=</span> <span class="token number">12</span>
			<span class="token punctuation">.</span>BackColor<span class="token punctuation">.</span>RGB <span class="token operator">=</span> RGB<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> myShape <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>代码解析：</p><p>TextEffect 过程在工作表中插入艺术字并设置其格式。</p><p>第 3、4 行代码删除工作表中可能存在的艺术字，以免重复添加。</p><p>第 5 行到第 9 行代码使用 AddTextEffect 方法在工作表中插入艺术字，AddTextEffect 方法创建艺术字对象。返回一个 Shape 对象，该对象代表新建的艺术字对象，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>AddTextEffect<span class="token punctuation">(</span>PresetTextEffect<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> FontName<span class="token punctuation">,</span> FontSize<span class="token punctuation">,</span> FontBold<span class="token punctuation">,</span> FontItalic<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Top<span class="token punctuation">)</span>

参数expression是必需的，返回一个Shapes对象。
参数PresetTextEffect是必需的，艺术字预置文本效果，可为MsoPresetTextEffect 常量之一，等同于在工作表中插入艺术字时的样式选项卡，如图<span class="token number">55</span><span class="token operator">-</span><span class="token number">1</span>所示。
参数Text是必需的，艺术字对象中的文字。
参数FontName是必需的，艺术字对象中所用的字体名称。
参数FontSize是必需的，以磅为单位给出艺术字对象中所用的字体大小。
参数FontBold是必需的，在艺术字中要加粗的字体。
参数FontItalic是必需的，在艺术字中要倾斜的字体。
参数Left和参数Top是必需的，相对于文档的左上角、顶部，以磅为单位给出艺术字对象边框左上角的位置。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-container center"><p><img src="/blog/assets/55-1.910780af.png" alt="" loading="lazy"></p><p><u>图 55-1</u> 艺术字样式</p></div><p>第 11 行代码将艺术字对象重命名为“myShape”。</p><p>第 12 行到第 16 行代码设置艺术字对象的填充格式。其中第 13 行代码将填充格式设置为均一的颜色，应用于 FillFormat 对象的 Solid 方法将指定的填充格式设置为均一的颜色，可用本方法将带有渐进色、纹理、图案或背景的填充格式转换为单色的填充格式。第 14 行代码设置填充的颜色。第 15 行代码设置填充的透明度。</p><p>第 17 行到第 24 行代码设置艺术字对象的线条格式属性。其中第 18 行代码设置线条粗细，第 19 行代码设置线条虚线样式，第 20 行代码设置线条区域的样式，第 21 行代码设置线条的透明度，第 22 行代码设置前景色，第 23 行代码设置填充背景的颜色。</p><p>运行 TextEffect 过程工作表中如图 55-2 所示。</p><div class="custom-container center"><p><img src="/blog/assets/55-2.0c98d184.png" alt="" loading="lazy"></p><p><u>图 55-2</u> 工作表中插入艺术字</p></div><h2 id="_56、遍历工作表中的图形" tabindex="-1"><a class="header-anchor" href="#_56、遍历工作表中的图形" aria-hidden="true">#</a> 56、遍历工作表中的图形</h2><p>工作表中的多个图形，如果使用系统缺省名称，如“文本框1”、“文本框2”这样前面是固定的字符串，后面是序号的，可以使用 For...Next 语句遍历图形，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ErgShapes_1<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">4</span>
		Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span><span class="token string">&quot;文本框 &quot;</span> <span class="token operator">&amp;</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>Characters<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>代码解析：</p><p>ErgShapes_1 过程清除工作表中四个图形文本框中的文字。</p><p>第 3 行到第 5 行代码，使用 Shapes 属性在工作表上的三个图形文本框中循环。</p><p>Shapes 属性返回 Shapes 对象，代表工作表或图形工作表上的所有图形，可以使用Shapes（index）返回单个的 Shape 对象，其中index是图形的名称或索引号。</p><p>返回单个的 Shape 对象后使用 TextFrame 属性和 Characters 方法清除文本框中的字符，关于 Shape 对象的 TextFrame 属性和 Characters 方法请参阅 53 。</p><p>如果图形的名称没有规律，可以使用 For Each...Next 语句循环遍历所有图形，根据 Type 属性返回的图形类型进行相应的操作，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ErgShapes_2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myShape <span class="token keyword">As</span> Shape
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	i <span class="token operator">=</span> <span class="token number">1</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> myShape <span class="token keyword">In</span> Sheet1<span class="token punctuation">.</span>Shapes
		<span class="token keyword">If</span> myShape<span class="token punctuation">.</span><span class="token keyword">Type</span> <span class="token operator">=</span> msoTextBox <span class="token keyword">Then</span>
			myShape<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>Characters<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;这是第&quot;</span> <span class="token operator">&amp;</span> i <span class="token operator">&amp;</span> <span class="token string">&quot;个文本框&quot;</span>
			i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>代码解析：</p><p>ErgShapes_2 过程在工作表中的所有图形文本框中写入文本。</p><p>第 5 行代码使用 For Each...Next 语句循环遍历工作表中所有的图形对象。</p><p>第 6 行到第 9 行代码如果图形对象是文本框则在文本框中写入文本。其中第 6 行代码根据 Type 属性判断图形对象是否为文本框，应用于 Shape 对象的 Type 属性返回或设置图形类型， MsoShapeType 类型，请参阅表格 54-1 。</p><p>第 7 行代码根据返回的 Type 属性值在所有的文本框内写入相应的文本，如图 56-1 所示。</p><div class="custom-container center"><p><img src="/blog/assets/56-1.a69dfa19.png" alt="" loading="lazy"></p><p><u>图 56-1</u> 遍历所有的文本框</p></div><h2 id="_57、移动、旋转图片" tabindex="-1"><a class="header-anchor" href="#_57、移动、旋转图片" aria-hidden="true">#</a> 57、移动、旋转图片</h2><p>工作表中的图片可以移动、旋转，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> MoveShape<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">Dim</span> j <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">3000</span> <span class="token keyword">Step</span> <span class="token number">5</span>
		 <span class="token punctuation">.</span>Top <span class="token operator">=</span> Sin<span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3.1416</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">100</span>
		 <span class="token punctuation">.</span>Left <span class="token operator">=</span> Cos<span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3.1416</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">100</span>
		 <span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>ForeColor<span class="token punctuation">.</span>RGB <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">100</span>
			<span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
				<span class="token punctuation">.</span>IncrementRotation <span class="token operator">-</span><span class="token number">2</span>
				DoEvents
			<span class="token keyword">Next</span>
		<span class="token keyword">Next</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>代码解析：</p><p>MoveShape 过程移动、旋转工作表中的图片并不断改变其填充的前景色。</p><p>第 6 行代码设置图片的 Top 属性值，应用于 Shape 对象的 Top 属性设置图形的顶端到工作表顶端的距离。在循环的过程中使用 Sin 函数将 Top 属性值设置为一个圆形的弧度值。Sin 函数返回指定参数的正弦值，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Sin<span class="token punctuation">(</span>number<span class="token punctuation">)</span>

参数number表示一个以弧度为单位的角。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Sin 函数取一角度为参数值，并返回角的对边长度除以斜边长度的比值，将角度除以 180 后即能角度转换为弧度。</p><p>第 7 行代码设置图片的 Left 属性值，应用于 Shape 对象的 Left 属性设置图形从左边界至 A 列左边界（在工作表中）或图表区左边界（在图表工作表中）的距离。在循环的过程中使用 Cos 函数将 Left 属性值设置为一个圆形的弧度值。Cos 函数返回指定一个角的余弦值，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>Cos<span class="token punctuation">(</span>number<span class="token punctuation">)</span>

参数number表示一个以弧度为单位的角。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Cos 函数的 number 参数为一个角，并返回直角三角形两边的比值，该比值为角的邻边长度除以斜边长度之商，将角度除以 180 后即能角度转换为弧度。</p><p>第 8 行代码设置图片填充的前景色随着循环的过程不断的变化。使用Fill属性返回一个 FillFormat 对象，FillFormat 对象代表图形的填充格式，其 ForeColor 属性设置对象填充的前景色。</p><p>第 9 行到第 11 行代码在图形移动的过程中使用 IncrementRotation 方法设置图形绕 z 轴的转角，IncrementRotation 方法以指定的度数为增量，更改指定的图形绕 z 轴的转角，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>IncrementRotation<span class="token punctuation">(</span>Increment<span class="token punctuation">)</span>

参数expression是必需的，返回一个Shape对象。
参数Increment是必需的，以度为单位指定图形在水平方向的旋转量，正值使图形按顺时针方向旋转，负值使图形按逆时针方向旋转。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中第 11 行是关键的代码，使用 DoEvents 函数转让控制权，否则达不到预计的视觉效果。</p><p>运行 MoveShape 过程，工作表的图形在自身进行逆时针方向旋转的同时沿着一个圆形的弧度进行移动，并不断改变其填充的颜色。</p><h2 id="_58、工作表中自动插入图片" tabindex="-1"><a class="header-anchor" href="#_58、工作表中自动插入图片" aria-hidden="true">#</a> 58、工作表中自动插入图片</h2><p>在日常工作中经常需要在工作表中插入大量图片，比如在如图 58-1 所示的工作表中需要根据 A 列的名称在 C 列插入保存在同一目录中的相应的图片，如果使用手工插入不仅非常繁琐且极易出错，而使用 VBA 代码可以很好的完成操作。</p><div class="custom-container center"><p><img src="/blog/assets/58-1.8722889b.png" alt="" loading="lazy"></p><p><u>图 58-1</u> 需插入图片的工作表</p></div><p>示例代码如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> insertPic<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> FilPath <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Dim</span> rng <span class="token keyword">As</span> Range
	<span class="token keyword">Dim</span> s <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">With</span> Sheet1
		<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">To</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
			FilPath <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text <span class="token operator">&amp;</span> <span class="token string">&quot;.jpg&quot;</span>
			<span class="token keyword">If</span> Dir<span class="token punctuation">(</span>FilPath<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
				<span class="token punctuation">.</span>Pictures<span class="token punctuation">.</span>Insert<span class="token punctuation">(</span>FilPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
				<span class="token keyword">Set</span> rng <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
				<span class="token keyword">With</span> Selection
					<span class="token punctuation">.</span>Top <span class="token operator">=</span> rng<span class="token punctuation">.</span>Top <span class="token operator">+</span> <span class="token number">1</span>
					<span class="token punctuation">.</span>Left <span class="token operator">=</span> rng<span class="token punctuation">.</span>Left <span class="token operator">+</span> <span class="token number">1</span>
					<span class="token punctuation">.</span>Width <span class="token operator">=</span> rng<span class="token punctuation">.</span>Width <span class="token operator">-</span> <span class="token number">1</span>
					<span class="token punctuation">.</span>Height <span class="token operator">=</span> rng<span class="token punctuation">.</span>Height <span class="token operator">-</span> <span class="token number">1</span>
				<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">Else</span>
				s <span class="token operator">=</span> s <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text
			<span class="token keyword">End</span> <span class="token keyword">If</span>
		<span class="token keyword">Next</span>
		<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">If</span> s <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
		MsgBox s <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;没有照片!&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>代码解析：</p><p>insertPic 过程使用 Insert 方法在工作表中插入图片。</p><p>第 7 行代码开始 For...Next 循环，循环的终值由工作表中 A 列单元格的行数所决定。</p><p>第 8 行代码字符串变量FilPath保存A列名称单元格所对应的图片文件的路径和文件名，本例中图片文件的文件名应和A列中的名称一致。</p><p>第 9 行到第 11 行代码使用 Dir 函数在同一文件夹中查找与 A 列单元格中的名称相对应的图片文件，如果对应的图片文件存在则使用 Insert 方法将图片插入到工作表中，并将 C 列的单元格赋给变量 rng。</p><p>Dir 函数返回一个 String，用以表示一个文件名、目录名或文件夹名称，它必须与指定的模式或文件属性、或磁盘卷标相匹配。如果已没有合乎条件的文件，则 Dir 函数会返回一个零长度字符串 （&quot;&quot;）。</p><p>第 12 行到第 17 行代码，当图片片插入到工作表时其实是插入到活动单元格的，此时需设置图片的 Top 属性和 Left 属性将图片移动到 C 列所对应的单元格中，并设置其 Width 属性和 Height 属性使其适应所在单元格的大小。</p><p>第 18、19 行代码如果在同一文件夹中没有与 A 列单元格对应的图片文件，则使用字符串变量 s 保存没有图片文件的名称。</p><p>第 24 行到第 26 行代码如果字符串变量s不等于空白说明文件夹中缺少图片文件，使用消息框提示。</p><p>运行 insertPic 过程工作表如图 58-2 所示。</p><div class="custom-container center"><p><img src="/blog/assets/58-2.1b75c3a0.png" alt="" loading="lazy"></p><p><u>图 58-2</u> 插入图片后的工作表</p></div><p>如果文件夹中缺少对应的图片文件，则会进行提示，如图 58-3 所示。</p><div class="custom-container center"><p><img src="/blog/assets/58-3.0c43069c.png" alt="" loading="lazy"></p><p><u>图 58-3</u> 缺少图片文件提示</p></div><h2 id="_59、固定工作表中图形的位置" tabindex="-1"><a class="header-anchor" href="#_59、固定工作表中图形的位置" aria-hidden="true">#</a> 59、固定工作表中图形的位置</h2><p>工作表中插入的图片，一般都是固定的尺寸和固定的单元格区域中的，但在实际使用中可能因一些人为的因素导致图片位置偏移或尺寸变化，此时可以使用 VBA 代码进行调整，如下面的代码所示。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShapeAddress<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> rng <span class="token keyword">As</span> Range
	<span class="token keyword">Set</span> rng <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;B4:E22&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span><span class="token string">&quot;Picture 1&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Rotation <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token punctuation">.</span><span class="token keyword">Select</span>
		<span class="token keyword">With</span> Selection
			<span class="token punctuation">.</span>Top <span class="token operator">=</span> rng<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Top <span class="token operator">+</span> <span class="token number">1</span>
			<span class="token punctuation">.</span>Left <span class="token operator">=</span> rng<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Left <span class="token operator">+</span> <span class="token number">1</span>
			<span class="token punctuation">.</span>Width <span class="token operator">=</span> rng<span class="token punctuation">.</span>Width <span class="token operator">-</span> <span class="token number">0.5</span>
			<span class="token punctuation">.</span>Height <span class="token operator">=</span> rng<span class="token punctuation">.</span>Height <span class="token operator">-</span> <span class="token number">0.5</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>代码解析：</p><p>ShapeAddress 过程调整指定图形在工作表中的位置。</p><p>第 3 行代码变量 rng 保存工作表中插入图片的单元格区域。。</p><p>第 5 行代码设置图片的转角，应用于 Shape 对象 Rotation 属性以度为单位返回或设置图形的转角，设置为正值向右偏转，设置为负值向左偏转，设置为零图片则保持 90 度垂直。</p><p>第 7 行到第 12 行代码设置图片的 Top 属性和 Left 属性将图片移动到变量 rng 所保存的单元格区域中，并设置其 Width 属性和 Height 属性使其适应所在单元格区域的大小。</p><p>第 14 行代码选择 <code>A1</code> 单元格，不然图片会处于选中状态。</p><p>经过以上设置，工作表中的图片“Picture 1”不管处于什么状态都可以一键恢复其原来的大小、位置。</p><h2 id="_60、使用-vba-自动生成图表" tabindex="-1"><a class="header-anchor" href="#_60、使用-vba-自动生成图表" aria-hidden="true">#</a> 60、使用 VBA 自动生成图表</h2><p>在实际工作中我们常用图表来表现数据间的某种相对关系，一般采用手工插入的方式，而使用 VBA 代码可以在工作表中自动生成图表，如下面的示例代码。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ChartAdd<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myRange <span class="token keyword">As</span> Range
	<span class="token keyword">Dim</span> myChart <span class="token keyword">As</span> ChartObject
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">With</span> Sheet1
		<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Delete
		R <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
		<span class="token keyword">Set</span> myRange <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token string">&quot;:B&quot;</span> <span class="token operator">&amp;</span> R<span class="token punctuation">)</span>
		<span class="token keyword">Set</span> myChart <span class="token operator">=</span> <span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span>
		<span class="token keyword">With</span> myChart<span class="token punctuation">.</span>Chart
			<span class="token punctuation">.</span>ChartType <span class="token operator">=</span> xlColumnClustered
			<span class="token punctuation">.</span>SetSourceData Source<span class="token punctuation">:</span><span class="token operator">=</span>myRange<span class="token punctuation">,</span> PlotBy<span class="token punctuation">:</span><span class="token operator">=</span>xlColumns
			<span class="token punctuation">.</span>ApplyDataLabels ShowValue<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span>
			<span class="token punctuation">.</span>HasTitle <span class="token operator">=</span> <span class="token boolean">True</span>
			<span class="token punctuation">.</span>ChartTitle<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;图表制作示例&quot;</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>ChartTitle<span class="token punctuation">.</span>Font
				<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">20</span>
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">3</span>
				<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;华文新魏&quot;</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>ChartArea<span class="token punctuation">.</span>Interior
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">8</span>
				<span class="token punctuation">.</span>PatternColorIndex <span class="token operator">=</span> <span class="token number">1</span>
				<span class="token punctuation">.</span>Pattern <span class="token operator">=</span> xlSolid
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>PlotArea<span class="token punctuation">.</span>Interior
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">35</span>
				<span class="token punctuation">.</span>PatternColorIndex <span class="token operator">=</span> <span class="token number">1</span>
				<span class="token punctuation">.</span>Pattern <span class="token operator">=</span> xlSolid
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>DataLabels<span class="token punctuation">.</span>Delete
			<span class="token keyword">With</span> <span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>DataLabels<span class="token punctuation">.</span>Font
				<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">10</span>
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">5</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Set</span> myRange <span class="token operator">=</span> <span class="token boolean">Nothing</span>
	<span class="token keyword">Set</span> myChart <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>代码解析：</p><p>ChartAdd 过程在工作表中自动生成图表，图表类型为簇状柱形图。</p><p>第 6 行代码使用 Delete 方法删除工作表中已经存在的图表，而 ChartObjects 方法返回代表工作表中单个嵌入图表（ChartObject 对象）或所有嵌入图表的集合（ChartObjects 对象）的对象，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">(</span>Index<span class="token punctuation">)</span>

其中参数Index是可选的，指定图表的名称或号码。该参数可以是数组，用于指定多个图表，因为示例中只有一个图表，所以无需指定其Index参数。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第 8 行代码指定图表的数据源。</p><p>第 9 行代码使用 Add 方法创建一个新图表，应用于 ChartObjects 对象的 Add 方法创建新的嵌入图表，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Left<span class="token punctuation">,</span> Top<span class="token punctuation">,</span> Width<span class="token punctuation">,</span> Height<span class="token punctuation">)</span>

参数Left、Top是必需的，以磅为单位给出新对象的初始坐标，该坐标是相对于工作表上单元格A1的左上角或图表的左上角的坐标。
参数Width、Height是必需，以磅为单位给出新对象的初始大小。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>第 10 行代码使用 Chart 属性返回新创建的图表，应用于 ChartObject 对象的 Chart 属性返回一个 Chart 对象，该对象代表指定对象所包含的图表。</p><p>第 11 行代码指定新创建图表的图表类型，应用于 Chart 对象的 ChartType 属性返回或设置图表的类型，可以为 XlChartType 常量之一，具体请参阅 VBA 帮助。本例中设置为 xlColumnClustered 即图表类型为簇状柱形图。</p><p>第 12 行代码指定图表的数据源和绘图方式，应用于 Chart 对象的 SetSourceData 方法为指定图表设置源数据区域，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>SetSourceData<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> PlotBy<span class="token punctuation">)</span>

参数expression是必需的，该表达式返回一个Chart对象。
参数Source是可选的，源数据的区域。
参数PlotBy是可选的，指定数据绘制方式，可为xlColumns（系列产生在列）或xlRows（系列产生在行）。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>第 13 行代码使用 ApplyDataLabels 方法使图表显示数据标签和数据点的值，应用于 Chart 对象的 ApplyDataLabels 方法将数据标签应用于图表中的某一数据点、某一数据系列或所有数据系列，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>ApplyDataLabels<span class="token punctuation">(</span><span class="token keyword">Type</span><span class="token punctuation">,</span> LegendKey<span class="token punctuation">,</span> AutoText<span class="token punctuation">,</span> HasLeaderLines<span class="token punctuation">,</span> ShowSeriesName<span class="token punctuation">,</span> ShowCategoryName<span class="token punctuation">,</span> ShowValue<span class="token punctuation">,</span> ShowPercentage<span class="token punctuation">,</span> ShowBubbleSize<span class="token punctuation">,</span> Separator<span class="token punctuation">)</span>

参数expression是必需的，该表达式返回一个Chart对象。
参数<span class="token keyword">Type</span>是可选的，要应用的数据标签的类型，可为表格 <span class="token number">60</span><span class="token operator">-</span><span class="token number">1</span>所列的XlDataLabelsType 常量之一。
参数LegendKey是可选的，如果该值为<span class="token boolean">True</span>，则显示数据点旁的图例项标示。默认值为<span class="token boolean">False</span>。
参数AutoText是可选的，如果对象根据内容自动生成正确的文字，则该值为<span class="token boolean">True</span>。
参数HasLeaderLines是可选的，如果数据系列具有引导线，则该值为<span class="token boolean">True</span>。
参数ShowSeriesName是可选的，数据标签的系列名称。
参数ShowCategoryName是可选的，数据标签的分类名称。
参数ShowValue是可选的，数据标签的值。
参数ShowPercentage是可选的，数据标签的百分比。
参数ShowBubbleSize是可选的，数据标签的气泡尺寸。
参数Separator是可选的，数据标签的分隔符。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><u>表格 60-1</u> XlDataLabelsType 常量</p><table><thead><tr><th>常量</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>xlDataLabelsShowBubbleSizes</td><td>6</td><td>无</td></tr><tr><td>xlDataLabelsShowLabelAndPercent</td><td>5</td><td>占总数的百分比及数据点所属的分类。仅用于饼图或圆环图。</td></tr><tr><td>xlDataLabelsShowPercent</td><td>3</td><td>占总数的百分比。仅用于饼图或圆环图。</td></tr><tr><td>xlDataLabelsShowLabel</td><td>4</td><td>数据点所属的分类。</td></tr><tr><td>xlDataLabelsShowNone</td><td>-4142</td><td>无数据标签。</td></tr><tr><td>xlDataLabelsShowValue</td><td>2</td><td>数据点的值，若未指定本参数，默认使用此设置。</td></tr></tbody></table><p>第 14、15 行代码设置新创建的图表有可见的标题并设置图表标题的文字。应用于 Chart 对象的 HasTitle 属性，如果坐标轴或图表有可见标题，则该值为 True，而 ChartTitle 属性返回一个 ChartTitle 对象，代表指定图表的标题。</p><p>第 16 行到第 20 行代码设置图表标题文字的格式。</p><p>第 21 行到第 25 行代码设置图表区的颜色。</p><p>第 26 行到第 30 行代码设置绘图区的颜色。</p><p>第 31 行代码删除图表上第一个数据系列中的数据标签。SeriesCollection 方法返回图表或图表组中单个数据系列（Series 对象)或所有数据系列的集合（SeriesCollection 集合)的对象，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">(</span>Index<span class="token punctuation">)</span>

可选的Index参数指定数据系列的名称或编号。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>而 DataLabels 方法则返回代表数据系列中的单个数据标签（DataLabel 对象）或所有数据标签的集合（DataLabels 集合）的对象，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>DataLabels<span class="token punctuation">(</span>Index<span class="token punctuation">)</span>

可选的Index参数指定数据系列中的数据标签的编号。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第 32 行到第 36 行代码设置图表上第二个数据系列中的数据标签的字体格式。</p><p>运行 ChartAdd 过程，在工作表中创建簇状柱形图，如图 60-1 所示。</p><div class="custom-container center"><p><img src="/blog/assets/60-1.4fc277ee.png" alt="" loading="lazy"></p><p><u>图 60-1</u> 创建簇状柱形图</p></div><h2 id="_61、使用独立窗口显示图表" tabindex="-1"><a class="header-anchor" href="#_61、使用独立窗口显示图表" aria-hidden="true">#</a> 61、使用独立窗口显示图表</h2><p>如果需要将工作表中嵌入的图表显示在独立的窗口中，可以使用下面的代码。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ChartShow<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Sheet1<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span>Activate
		<span class="token punctuation">.</span>Chart<span class="token punctuation">.</span>ShowWindow <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">With</span> ActiveWindow
		<span class="token punctuation">.</span>Top <span class="token operator">=</span> <span class="token number">50</span>
		<span class="token punctuation">.</span>Left <span class="token operator">=</span> <span class="token number">50</span>
		<span class="token punctuation">.</span>Width <span class="token operator">=</span> <span class="token number">400</span>
		<span class="token punctuation">.</span>Height <span class="token operator">=</span> <span class="token number">280</span>
		<span class="token punctuation">.</span>Caption <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Name
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>代码解析：</p><p>ChartShow 过程，将工作表中嵌入的图表显示在独立的窗口中。</p><p>第 2 行到第 5 行代码将工作表中指定图表的 ShowWindow 属性设置为 True，使用独立的窗口显示该图表。</p><p>第 7、8 行代码指定活动窗口显示的位置。</p><p>第 9、10 行代码调整活动窗口的大小使之适应图表的大小。</p><p>第 11 行代码指定活动窗口标题栏中显示的标题。</p><p>运行 ChartShow 过程结果如图 61-1 所示。</p><div class="custom-container center"><p><img src="/blog/assets/61-1.96eef653.png" alt="" loading="lazy"></p><p><u>图 61-1</u> 使用独立窗口显示图表</p></div><h2 id="_62、导出工作表中的图表" tabindex="-1"><a class="header-anchor" href="#_62、导出工作表中的图表" aria-hidden="true">#</a> 62、导出工作表中的图表</h2><p>如果需要将工作表中的图表保存为单独的图像文件，可以使用 Export 方法以图形文件格式导出图表，示例代码如下。</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ExportChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myChart <span class="token keyword">As</span> Chart
	<span class="token keyword">Dim</span> myFileName <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">Set</span> myChart <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Chart
	myFileName <span class="token operator">=</span> <span class="token string">&quot;myChart.jpg&quot;</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	Kill ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;\&quot;</span> <span class="token operator">&amp;</span> myFileName
	myChart<span class="token punctuation">.</span>Export Filename<span class="token punctuation">:</span><span class="token operator">=</span>ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">_</span>
		<span class="token operator">&amp;</span> <span class="token string">&quot;\&quot;</span> <span class="token operator">&amp;</span> myFileName<span class="token punctuation">,</span> Filtername<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;JPG&quot;</span>
	MsgBox <span class="token string">&quot;图表已保存在[&quot;</span> <span class="token operator">&amp;</span> ThisWorkbook<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">&quot;]文件夹中!&quot;</span>
	<span class="token keyword">Set</span> myChart <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码解析：</p><p>ExportChart 过程使用 Export 方法将工作表中的图表以图形文件的形式导出。</p><p>第 4 行代码指定工作表中的图表对象。</p><p>第 5 行代码指定图形文件保存的文件名。</p><p>第 6、7 行代码使用 Kill 语句删除文件夹中原有的图形文件。当文件夹中指定删除的文件不存在时 Kill 语句会出错所以需要使用 On Error 语句忽略错误。</p><p>第 8、9 行代码使用 Export 方法将图表导出到同一目录中，应用于 Chart 对象的 Export 方法以图形文件格式导出图表，语法如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Export<span class="token punctuation">(</span>Filename<span class="token punctuation">,</span> FilterName<span class="token punctuation">,</span> Interactive<span class="token punctuation">)</span>

其中参数Filename是必需的，被导出的文件的名称，示例中加上了文件保存的路径。
参数FilterName是可选的，被导出的文件的图形格式，示例中文件以JPG文件格式保存。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_63、多图表制作" tabindex="-1"><a class="header-anchor" href="#_63、多图表制作" aria-hidden="true">#</a> 63、多图表制作</h2><p>如果需要，我们可以为工作表中的每一个数据区域创建一张图表，在如图 63-1 所示的工作表区域中，需要为每一个员工的全年数据创建一张图表。</p><div class="custom-container center"><p><img src="/blog/assets/63-1.eb84c954.png" alt="" loading="lazy"></p><p><u>图 63-1</u> 数据区域</p></div><p>示例代码如下：</p><div class="language-vb ext-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ChartsAdd<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> myChart <span class="token keyword">As</span> ChartObject
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> m <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	R <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row <span class="token operator">-</span> <span class="token number">1</span>
	m <span class="token operator">=</span> Abs<span class="token punctuation">(</span>Int<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>R <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	Sheet2<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Delete
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> R
		<span class="token keyword">Set</span> myChart <span class="token operator">=</span> Sheet2<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add <span class="token operator">_</span>
			<span class="token punctuation">(</span>Left<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Mod</span> m<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">350</span> <span class="token operator">-</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token operator">_</span>
			Top<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">\</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">220</span> <span class="token operator">-</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token operator">_</span>
			Width<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">330</span><span class="token punctuation">,</span> Height<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">)</span>
		<span class="token keyword">With</span> myChart<span class="token punctuation">.</span>Chart
			<span class="token punctuation">.</span>ChartType <span class="token operator">=</span> xlColumnClustered
			<span class="token punctuation">.</span>SetSourceData Source<span class="token punctuation">:</span><span class="token operator">=</span>Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;B2:M2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
			PlotBy<span class="token punctuation">:</span><span class="token operator">=</span>xlRows
			<span class="token keyword">With</span> <span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span>XValues <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;B1:M1&quot;</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span>Name <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span>ApplyDataLabels AutoText<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ShowValue<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span>
				<span class="token punctuation">.</span>DataLabels<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">10</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token punctuation">.</span>HasLegend <span class="token operator">=</span> <span class="token boolean">False</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>ChartTitle
				<span class="token punctuation">.</span>Left <span class="token operator">=</span> <span class="token number">5</span>
				<span class="token punctuation">.</span>Top <span class="token operator">=</span> <span class="token number">1</span>
				<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">14</span>
				<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;华文行楷&quot;</span>
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token keyword">With</span> <span class="token punctuation">.</span>PlotArea<span class="token punctuation">.</span>Interior
				<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">2</span>
				<span class="token punctuation">.</span>PatternColorIndex <span class="token operator">=</span> <span class="token number">1</span>
				<span class="token punctuation">.</span>Pattern <span class="token operator">=</span> xlSolid
			<span class="token keyword">End</span> <span class="token keyword">With</span>
			<span class="token punctuation">.</span>Axes<span class="token punctuation">(</span>xlCategory<span class="token punctuation">)</span><span class="token punctuation">.</span>TickLabels<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">10</span>
			<span class="token punctuation">.</span>Axes<span class="token punctuation">(</span>xlValue<span class="token punctuation">)</span><span class="token punctuation">.</span>TickLabels<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">10</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Next</span>
	Sheet2<span class="token punctuation">.</span><span class="token keyword">Select</span>
	<span class="token keyword">Set</span> myChart <span class="token operator">=</span> <span class="token boolean">Nothing</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>代码解析：</p><p>ChartsAdd 过程根据数据工作表 A 列的人数在图表工作表中创建图表并分 4 行排列整齐。</p><p>第 6 行代码取得数据工作表中需要创建图表的人数。</p><p>第 7 行代码计算图表工作表每行需要排列的图表数目，共分 4 行排列。使用 Int 函数返回图表数目除 4 行后的整数部分，使用负值是为了向上取整数，最后使用 Abs 函数返回绝对值，将负值转化为正值。</p><p>第 8 行代码使用 Delete 方法删除图表工作表中存在的所有图表。</p><p>第 9 行代码开始 For...Next 循环，循环的终值由需要创建的图表数目决定。</p><p>第 10 行到第 13 行代码使用 Add 方法在图表工作表中创建嵌入的图表，关于应用于 ChartObjects 对象的 Add 方法请参阅 60 。其中第 11、12 行代码根据循环计数器的数值设置新创建图表的 Left 和 To p属性使之依次排列。第 13 行代码设置图表的大小。</p><p>第 15 行代码设置新创建图表的类型。</p><p>第 16、17 行代码根据循环计数器的数值分别设置新创建图表的数据源。</p><p>第 18 行到第 23 行代码设置图表第一个数据系列的名称、数据标签和字体格式。</p><p>第 24 行代码删除图表中的图例。</p><p>第 25 行到第 30 行代码设置图表的标题。</p><p>第 31 行到第 35 行代码设置图表的绘图区。</p><p>第 36、37 行代码设置图表坐标轴的字体大小。</p><p>关于图表的设置请参阅 60 。</p><p>运行 ChartsAdd 过程如图 63-2 所示。</p><div class="custom-container center"><p><img src="/blog/assets/63-2.bba3fb69.png" alt="" loading="lazy"></p><p><u>图 63-2</u> 图表工作表</p></div><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/Ryukarin/blog/edit/main/project/Excel/06.VBA_Shape_Chart.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><!----><!----></footer><nav class="page-nav"><a href="/blog/project/Excel/05.VBA_Workbook.html" class="nav-link prev" arialabel="VBA 之 Workbook 对象"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->VBA 之 Workbook 对象</div></a><a href="/blog/project/Excel/07.VBA_Application.html" class="nav-link next" arialabel="VBA 之 Application 对象"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">VBA 之 Application 对象<!----></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><!----></div><!----></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed</div><div class="copyright">Copyright © 2022 karin</div></footer></div><!--]--><!----><!--[--><!-- Root element of PhotoSwipe. Must have class pswp. --><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><!-- Background of PhotoSwipe. 
    It’s a separate element, as animating opacity is faster than rgba().--><div class="pswp__bg"></div><!-- Slides wrapper with overflow:hidden. --><div class="pswp__scroll-wrap"><!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. --><div class="pswp__container"><!-- don’t modify these 3 pswp__item elements, data is added later on --><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. --><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><!--  Controls are self-explanatory. Order can be changed. --><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="关闭"></button><button class="pswp__button pswp__button--share" title="分享"></button><button class="pswp__button pswp__button--fs" title="切换全屏"></button><button class="pswp__button pswp__button--zoom" title="缩放"></button><!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR --><!-- element will get class pswp__preloader--active when preloader is running --><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="上一个 (左箭头)"></button><button class="pswp__button pswp__button--arrow--right" title="下一个 (右箭头)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><!--]--><!--]--></div>
    <script type="module" src="/blog/assets/app.893f8b81.js" defer></script>
  </body>
</html>
