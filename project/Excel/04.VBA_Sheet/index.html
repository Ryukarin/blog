<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA 之 Sheet 对象 | KARIN</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://vuepress-theme-hope-demo.mrhope.site/blog/atom.xml" title="KARIN Atom Feed">
    <link rel="alternate" type="application/json" href="https://vuepress-theme-hope-demo.mrhope.site/blog/feed.json" title="KARIN JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://vuepress-theme-hope-demo.mrhope.site/blog/rss.xml" title="KARIN RSS Feed">
    <link rel="icon" href="/favicon.png">
    <link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192">
    <link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png">
    <meta name="description" content="KARIN的学习笔记">
    <meta property="og:url" content="/blog/project/Excel/04.VBA_Sheet.html">
    <meta property="og:site_name" content="KARIN">
    <meta property="og:title" content="VBA 之 Sheet 对象">
    <meta property="og:description" content="21、引用工作表的方式 VBA 中，在不同的工作表之间转换或者对不同工作表中的单元格区域进行操作时，需要指定引用的工作表，通常有下面几种方法： 1）使用工作表的名称 工作表名称是指显示在工作表标签中的文本，工作表名称可以使用 WorkSheets 集合和 Sheets 集合两种引用方式，如下面的代码所示。 第 2、3 行代码都激活工作簿中名称为“sheet1">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="KARIN">
    <meta property="article:author" content="karin">
    <meta property="article:tag" content="Excel">
    <meta property="article:published_time" content="2021-07-02T00:00:00.000Z">
    <meta name="theme-color" content="#46bd87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/blog/assets/css/0.styles.5649bb21.css" as="style"><link rel="preload" href="/blog/assets/js/app.9f9c9b81.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Layout.79b66223.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.efafecdd.js" as="script"><link rel="preload" href="/blog/assets/js/page-VBA之Sheet对象.40acafa7.js" as="script"><link rel="prefetch" href="/blog/assets/js/122.7ad47f04.js"><link rel="prefetch" href="/blog/assets/js/123.ae4a39df.js"><link rel="prefetch" href="/blog/assets/js/124.2715123b.js"><link rel="prefetch" href="/blog/assets/js/125.a4234a33.js"><link rel="prefetch" href="/blog/assets/js/126.8fa2f32c.js"><link rel="prefetch" href="/blog/assets/js/127.9bf5c918.js"><link rel="prefetch" href="/blog/assets/js/128.0c398c07.js"><link rel="prefetch" href="/blog/assets/js/layout-Blog.8dd576a3.js"><link rel="prefetch" href="/blog/assets/js/layout-Layout.3729e73b.js"><link rel="prefetch" href="/blog/assets/js/layout-NotFound.f1d2f2e6.js"><link rel="prefetch" href="/blog/assets/js/layout-Slide.7ed7d0aa.js"><link rel="prefetch" href="/blog/assets/js/page--3d4f54c7.4eab0894.js"><link rel="prefetch" href="/blog/assets/js/page-Docker数据管理.143b7f4f.js"><link rel="prefetch" href="/blog/assets/js/page-Excel函数.22369a36.js"><link rel="prefetch" href="/blog/assets/js/page-Excel快捷键.8fdc623f.js"><link rel="prefetch" href="/blog/assets/js/page-Excel笔记介绍.57c3fe06.js"><link rel="prefetch" href="/blog/assets/js/page-FTP笔记.2b8526c8.js"><link rel="prefetch" href="/blog/assets/js/page-Git介绍.82a25571.js"><link rel="prefetch" href="/blog/assets/js/page-Git分支管理.4f9c0210.js"><link rel="prefetch" href="/blog/assets/js/page-Git创建仓库.cabea66e.js"><link rel="prefetch" href="/blog/assets/js/page-Git基本操作.4e1f4734.js"><link rel="prefetch" href="/blog/assets/js/page-Git安装.cf6d44b4.js"><link rel="prefetch" href="/blog/assets/js/page-Git工作区、暂存区和版本库.5d561956.js"><link rel="prefetch" href="/blog/assets/js/page-Git工作流程.d2b8995f.js"><link rel="prefetch" href="/blog/assets/js/page-Git服务器搭建.7f6986af.js"><link rel="prefetch" href="/blog/assets/js/page-Git查看提交历史.40ff21ea.js"><link rel="prefetch" href="/blog/assets/js/page-Git标签.8f2c2cb6.js"><link rel="prefetch" href="/blog/assets/js/page-Git笔记.5e6ddcdf.js"><link rel="prefetch" href="/blog/assets/js/page-Git远程仓库（GitHub）.c8505cba.js"><link rel="prefetch" href="/blog/assets/js/page-Git配置.f141007c.js"><link rel="prefetch" href="/blog/assets/js/page-IT基础.e088bf26.js"><link rel="prefetch" href="/blog/assets/js/page-LAMP和LNMP环境搭建.adf92a39.js"><link rel="prefetch" href="/blog/assets/js/page-Markdown语法.76ecc03f.js"><link rel="prefetch" href="/blog/assets/js/page-SELinux管理.4075242b.js"><link rel="prefetch" href="/blog/assets/js/page-SFTP笔记.cdcf4d77.js"><link rel="prefetch" href="/blog/assets/js/page-Shell函数.775b51bc.js"><link rel="prefetch" href="/blog/assets/js/page-Shell变量.cda63b20.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对文件的操作---sed命令.cd166768.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对文本的搜索---grep命令.6083e37d.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对输出流的处理---awk命令.0d48e00c.js"><link rel="prefetch" href="/blog/assets/js/page-Shell数组.4b8667ee.js"><link rel="prefetch" href="/blog/assets/js/page-Shell格式化输入.bf1e7958.js"><link rel="prefetch" href="/blog/assets/js/page-Shell格式化输出.6607e3e6.js"><link rel="prefetch" href="/blog/assets/js/page-Shell正则表达式.ebfdf1ff.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---case分支语句.332bd80e.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---for循环语句.de1b1b0b.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---if判断语句.b0532849.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---until循环语句.e7c9c7f3.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---while循环语句.09fcf551.js"><link rel="prefetch" href="/blog/assets/js/page-Shell监控脚本.214dbdf6.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本---lamp环境安装.02e925e4.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本介绍.a9743a4a.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本笔记.333fc9cf.js"><link rel="prefetch" href="/blog/assets/js/page-Shell语法.af36ce2b.js"><link rel="prefetch" href="/blog/assets/js/page-Shell运算.2f6e1b67.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Application对象.dc3d863e.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Range对象.aff14b9e.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Shape、Chart对象.c8437d84.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Workbook对象.4b6ac3e5.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之使用对话框.32011bcc.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之函数的使用.60f6a8be.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体1.b004969b.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体2.0ca5f6c7.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体3.d9a20920.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之文件操作.5f150c21.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之菜单和工具栏.ec98d91f.js"><link rel="prefetch" href="/blog/assets/js/page-linux三剑客.e71431d8.js"><link rel="prefetch" href="/blog/assets/js/page-linux介绍.eae8610d.js"><link rel="prefetch" href="/blog/assets/js/page-linux关机和重启命令.13f93679.js"><link rel="prefetch" href="/blog/assets/js/page-linux其他权限管理命令.cedaf338.js"><link rel="prefetch" href="/blog/assets/js/page-linux压缩、解压缩命令.6908caa3.js"><link rel="prefetch" href="/blog/assets/js/page-linux基本操作命令.e8f72eb0.js"><link rel="prefetch" href="/blog/assets/js/page-linux大杂烩.9f8cdc5c.js"><link rel="prefetch" href="/blog/assets/js/page-linux帮助命令.4fdeff8c.js"><link rel="prefetch" href="/blog/assets/js/page-linux常用网络命令.8169fd78.js"><link rel="prefetch" href="/blog/assets/js/page-linux搜索命令.8d223c34.js"><link rel="prefetch" href="/blog/assets/js/page-linux数据备份与恢复.f202f4a1.js"><link rel="prefetch" href="/blog/assets/js/page-linux文件系统管理.859d9e24.js"><link rel="prefetch" href="/blog/assets/js/page-linux文件系统结构.a7348129.js"><link rel="prefetch" href="/blog/assets/js/page-linux文本编辑器.fa0a4df9.js"><link rel="prefetch" href="/blog/assets/js/page-linux权限管理命令.be5e8ebf.js"><link rel="prefetch" href="/blog/assets/js/page-linux用户和用户组管理.4079bdf7.js"><link rel="prefetch" href="/blog/assets/js/page-linux的管理建议.82f61a78.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统启动管理.96ebf1d7.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统工作管理.3c407e77.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统日志管理.72ca77b7.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统服务管理.46ae7426.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统进程管理.d56234ab.js"><link rel="prefetch" href="/blog/assets/js/page-linux软件安装.cc84e331.js"><link rel="prefetch" href="/blog/assets/js/page-linux高级文件系统管理.9e3c9bf6.js"><link rel="prefetch" href="/blog/assets/js/page-【MSG1500】刷机.c9407606.js"><link rel="prefetch" href="/blog/assets/js/page-【OpenWRT】固件编译.0ef4cd6f.js"><link rel="prefetch" href="/blog/assets/js/page-【Padavan】固件编译.d2a97584.js"><link rel="prefetch" href="/blog/assets/js/page-【RM2100】刷机救转.c6946098.js"><link rel="prefetch" href="/blog/assets/js/page-【VuePress】博客搭建.11c20d91.js"><link rel="prefetch" href="/blog/assets/js/page-【bootimg】解包打包.9ffb0b1e.js"><link rel="prefetch" href="/blog/assets/js/page-【openwrt】编译F大N1固件.49fa444e.js"><link rel="prefetch" href="/blog/assets/js/page-【squashfs】解包打包.58587e3c.js"><link rel="prefetch" href="/blog/assets/js/page-【小娱C1C5】刷机.4e341876.js"><link rel="prefetch" href="/blog/assets/js/page-【小娱C1C5】改造计划.ce3479e5.js"><link rel="prefetch" href="/blog/assets/js/page-【斐讯N1】Armbian.3bec83f3.js"><link rel="prefetch" href="/blog/assets/js/page-【斐讯N1】开机第一屏logo替换.57e2b6fa.js"><link rel="prefetch" href="/blog/assets/js/page-【贝壳云】改造计划.89b5027b.js"><link rel="prefetch" href="/blog/assets/js/page-【魔百合Q5】改造计划.510447e8.js"><link rel="prefetch" href="/blog/assets/js/page-个人信息.60959644.js"><link rel="prefetch" href="/blog/assets/js/page-主要功能与配置演示.90c45f63.js"><link rel="prefetch" href="/blog/assets/js/page-使用Dockerfile创建镜像.39abbd05.js"><link rel="prefetch" href="/blog/assets/js/page-使用Docker镜像.f46cc3e5.js"><link rel="prefetch" href="/blog/assets/js/page-初识Docker与容器.03017897.js"><link rel="prefetch" href="/blog/assets/js/page-博客主页.ee0b8fe8.js"><link rel="prefetch" href="/blog/assets/js/page-常用网站.40b6c65e.js"><link rel="prefetch" href="/blog/assets/js/page-幻灯片页.d2d94e64.js"><link rel="prefetch" href="/blog/assets/js/page-操作Docker容器.fca5b876.js"><link rel="prefetch" href="/blog/assets/js/page-核心概念与安装配置.bf9114e2.js"><link rel="prefetch" href="/blog/assets/js/page-瞎折腾.1dfcca6f.js"><link rel="prefetch" href="/blog/assets/js/page-端口映射与容器互联.44a4b5aa.js"><link rel="prefetch" href="/blog/assets/js/page-虚拟化的发展.7ac33b9a.js"><link rel="prefetch" href="/blog/assets/js/page-访问Docker仓库.71b3e000.js"><link rel="prefetch" href="/blog/assets/js/page-项目主页.24aa2c8e.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.eb5798cd.js"><link rel="prefetch" href="/blog/assets/js/vendors~mermaid.f1e52241.js"><link rel="prefetch" href="/blog/assets/js/vendors~photo-swipe.46d64c2d.js"><link rel="prefetch" href="/blog/assets/js/vendors~reveal.3f88bab1.js"><link rel="prefetch" href="/blog/assets/js/vendors~waline.8e39946b.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5649bb21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="KARIN" class="logo"> <!----> <span class="site-name can-hide">KARIN</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">主题色:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">主题模式:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  博客主页
</a></div><div class="nav-item"><a href="/blog/project/" class="nav-link router-link-active active"><i class="iconfont icon-folder"></i>
  项目总览
</a></div><div class="nav-item"><a href="/blog/IT/" class="nav-link"><i class="iconfont icon-blog"></i>
  知识要点
</a></div><div class="nav-item"><a href="/blog/operate/" class="nav-link"><i class="iconfont icon-operate"></i>
  捣鼓折腾
</a></div></nav> <!----> <a rel="noopener noreferrer" href="https://github.com/Ryukarin/blog" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="/blog/logo.png" class="avatar round"> <div property="name" class="name">karin</div> <meta property="url" content="/blog/intro/"></div> <div class="num-wrapper"><div><div class="num">106</div> <div>文章</div></div> <div><div class="num">14</div> <div>分类</div></div> <div><div class="num">18</div> <div>标签</div></div> <div><div class="num">105</div> <div>时间轴</div></div></div> <div class="media-links-wrapper"><a href="https://gitee.com/ryuukarin" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a><a href="https://github.com/Ryukarin" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  博客主页
</a></div><div class="nav-item"><a href="/blog/project/" class="nav-link router-link-active active"><i class="iconfont icon-folder"></i>
  项目总览
</a></div><div class="nav-item"><a href="/blog/IT/" class="nav-link"><i class="iconfont icon-blog"></i>
  知识要点
</a></div><div class="nav-item"><a href="/blog/operate/" class="nav-link"><i class="iconfont icon-operate"></i>
  捣鼓折腾
</a></div> <a rel="noopener noreferrer" href="https://github.com/Ryukarin/blog" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/blog/" aria-current="page" class="sidebar-link"><i class="iconfont icon-home"></i>博客主页</a></li><li><a href="/blog/project/" aria-current="page" class="sidebar-link"><i class="iconfont icon-folder"></i>项目主页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-blog"></i> <span class="title">知识要点</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-operate"></i> <span class="title">捣鼓折腾</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-linux"></i> <span class="title">Linux基础知识</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-linux"></i> <span class="title">Linux系统管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-linux"></i> <span class="title">Linux大杂烩</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-shell"></i> <span class="title">Shell笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-geometry"></i> <span class="title">Docker笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-git"></i> <span class="title">Git笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable open"><i class="iconfont icon-note"></i> <span class="title">Excel修炼秘籍</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/project/Excel/" aria-current="page" class="sidebar-link">Excel 笔记介绍</a></li><li><a href="/blog/project/Excel/01.Excel_hotkey/" class="sidebar-link">Excel 快捷键</a></li><li><a href="/blog/project/Excel/02.Excel_function/" class="sidebar-link">Excel 函数</a></li><li><a href="/blog/project/Excel/03.VBA_Range/" class="sidebar-link">VBA 之 Range 对象</a></li><li><a href="/blog/project/Excel/04.VBA_Sheet/" aria-current="page" class="active sidebar-link">VBA 之 Sheet 对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_21、引用工作表的方式" class="sidebar-link">21、引用工作表的方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_1-使用工作表的名称" class="sidebar-link heading3">1）使用工作表的名称</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_2-使用工作表的索引号" class="sidebar-link heading3">2）使用工作表的索引号</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_3-使用工作表的代码名称" class="sidebar-link heading3">3）使用工作表的代码名称</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_4-使用-activesheet-属性引用活动工作表" class="sidebar-link heading3">4）使用 ActiveSheet 属性引用活动工作表</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_22、选择工作表的方法" class="sidebar-link">22、选择工作表的方法</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_23、遍历工作表的方法" class="sidebar-link">23、遍历工作表的方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_1-使用-for-next-语句" class="sidebar-link heading3">1）使用 For...Next 语句</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_2-使用-for-each-next-语句" class="sidebar-link heading3">2）使用 For Each...Next 语句</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_24、在工作表中上下翻页" class="sidebar-link">24、在工作表中上下翻页</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_25、工作表的添加与删除" class="sidebar-link">25、工作表的添加与删除</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_26、禁止删除指定工作表" class="sidebar-link">26、禁止删除指定工作表</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_27、自动建立工作表目录" class="sidebar-link">27、自动建立工作表目录</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_28、工作表的深度隐藏" class="sidebar-link">28、工作表的深度隐藏</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_29、防止更改工作表的名称" class="sidebar-link">29、防止更改工作表的名称</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_30、工作表中一次插入多行" class="sidebar-link">30、工作表中一次插入多行</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_31、删除工作表中的空行" class="sidebar-link">31、删除工作表中的空行</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_32、删除工作表的重复行" class="sidebar-link">32、删除工作表的重复行</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_33、定位删除特定内容所在的行" class="sidebar-link">33、定位删除特定内容所在的行</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_34、判断是否选中整行" class="sidebar-link">34、判断是否选中整行</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_35、限制工作表的滚动区域" class="sidebar-link">35、限制工作表的滚动区域</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_36、复制自动筛选后的数据区域" class="sidebar-link">36、复制自动筛选后的数据区域</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_37、使用高级筛选获得不重复记录" class="sidebar-link">37、使用高级筛选获得不重复记录</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_38、工作表的保护与解除保护" class="sidebar-link">38、工作表的保护与解除保护</a></li><li class="sidebar-sub-header"><a href="/blog/project/Excel/04.VBA_Sheet/#_39、奇偶页打印" class="sidebar-link">39、奇偶页打印</a></li></ul></li><li><a href="/blog/project/Excel/05.VBA_Workbook/" class="sidebar-link">VBA 之 Workbook 对象</a></li><li><a href="/blog/project/Excel/06.VBA_Shape_Chart/" class="sidebar-link">VBA 之 Shape、Chart 对象</a></li><li><a href="/blog/project/Excel/07.VBA_Application/" class="sidebar-link">VBA 之 Application 对象</a></li><li><a href="/blog/project/Excel/08.VBA_dialog/" class="sidebar-link">VBA 之 使用对话框</a></li><li><a href="/blog/project/Excel/09.VBA_menu_toolbar/" class="sidebar-link">VBA 之 菜单和工具栏</a></li><li><a href="/blog/project/Excel/10.VBA_controls_form_1/" class="sidebar-link">VBA 之 控件与用户窗体1</a></li><li><a href="/blog/project/Excel/11.VBA_controls_form_2/" class="sidebar-link">VBA 之 控件与用户窗体2</a></li><li><a href="/blog/project/Excel/12.VBA_controls_form_3/" class="sidebar-link">VBA 之 控件与用户窗体3</a></li><li><a href="/blog/project/Excel/13.VBA_function/" class="sidebar-link">VBA 之 函数的使用</a></li><li><a href="/blog/project/Excel/14.VBA_fso/" class="sidebar-link">VBA 之 文件操作</a></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav display="true" class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/blog/project/" property="item" typeof="WebPage" class="router-link-active"><i class="iconfont icon-folder"></i> <span property="name">项目主页</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/blog/project/Excel/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">Excel 笔记介绍</span></a> <meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/blog/project/Excel/04.VBA_Sheet/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">VBA 之 Sheet 对象</span></a> <meta property="position" content="3"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">VBA 之 Sheet 对象</span></h1> <div class="page-info"><!----> <span aria-label="作者🖊" data-balloon-pos="down" categoryPath="/category/$category/" tagPath="/tag/$tag/"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">karin</span></span><span aria-label="访问量🔢" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 0 0-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/blog/project/Excel/04.VBA_Sheet/" data-flag-title="VBA 之 Sheet 对象" class="leancloud_visitors waline-visitor-count"><span class="leancloud-visitors-count">...</span></span></span><span aria-label="写作日期📅" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-07-02 </span></span><!----><span aria-label="标签🏷" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">Excel</span></li></ul> <meta property="keywords" content="Excel"></span><span aria-label="阅读时间⌛" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>大约 33 分钟</span> <meta property="timeRequired" content="PT33M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_21、引用工作表的方式" class="anchor-link heading2"><div>21、引用工作表的方式</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_1-使用工作表的名称" class="anchor-link heading3"><div>1）使用工作表的名称</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_2-使用工作表的索引号" class="anchor-link heading3"><div>2）使用工作表的索引号</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_3-使用工作表的代码名称" class="anchor-link heading3"><div>3）使用工作表的代码名称</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_4-使用-activesheet-属性引用活动工作表" class="anchor-link heading3"><div>4）使用 ActiveSheet 属性引用活动工作表</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_22、选择工作表的方法" class="anchor-link heading2"><div>22、选择工作表的方法</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_23、遍历工作表的方法" class="anchor-link heading2"><div>23、遍历工作表的方法</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_1-使用-for-next-语句" class="anchor-link heading3"><div>1）使用 For...Next 语句</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_2-使用-for-each-next-语句" class="anchor-link heading3"><div>2）使用 For Each...Next 语句</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_24、在工作表中上下翻页" class="anchor-link heading2"><div>24、在工作表中上下翻页</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_25、工作表的添加与删除" class="anchor-link heading2"><div>25、工作表的添加与删除</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_26、禁止删除指定工作表" class="anchor-link heading2"><div>26、禁止删除指定工作表</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_27、自动建立工作表目录" class="anchor-link heading2"><div>27、自动建立工作表目录</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_28、工作表的深度隐藏" class="anchor-link heading2"><div>28、工作表的深度隐藏</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_29、防止更改工作表的名称" class="anchor-link heading2"><div>29、防止更改工作表的名称</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_30、工作表中一次插入多行" class="anchor-link heading2"><div>30、工作表中一次插入多行</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_31、删除工作表中的空行" class="anchor-link heading2"><div>31、删除工作表中的空行</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_32、删除工作表的重复行" class="anchor-link heading2"><div>32、删除工作表的重复行</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_33、定位删除特定内容所在的行" class="anchor-link heading2"><div>33、定位删除特定内容所在的行</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_34、判断是否选中整行" class="anchor-link heading2"><div>34、判断是否选中整行</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_35、限制工作表的滚动区域" class="anchor-link heading2"><div>35、限制工作表的滚动区域</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_36、复制自动筛选后的数据区域" class="anchor-link heading2"><div>36、复制自动筛选后的数据区域</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_37、使用高级筛选获得不重复记录" class="anchor-link heading2"><div>37、使用高级筛选获得不重复记录</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_38、工作表的保护与解除保护" class="anchor-link heading2"><div>38、工作表的保护与解除保护</div></a></li><li class="anchor"><a href="/blog/project/Excel/04.VBA_Sheet/#_39、奇偶页打印" class="anchor-link heading2"><div>39、奇偶页打印</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="_21、引用工作表的方式"><a href="#_21、引用工作表的方式" class="header-anchor">#</a> 21、引用工作表的方式</h2> <p>VBA 中，在不同的工作表之间转换或者对不同工作表中的单元格区域进行操作时，需要指定引用的工作表，通常有下面几种方法：</p> <h3 id="_1-使用工作表的名称"><a href="#_1-使用工作表的名称" class="header-anchor">#</a> 1）使用工作表的名称</h3> <p>工作表名称是指显示在工作表标签中的文本，工作表名称可以使用 WorkSheets 集合和 Sheets 集合两种引用方式，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShActivate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">(</span><span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
	Sheets<span class="token punctuation">(</span><span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>第 2、3 行代码都激活工作簿中名称为“sheet1”的工作表，激活后的“sheet1”工作表将成为活动工作表。</p> <p>WorkSheets 集合包含所有的工作表，而 Sheets 集合不仅包含工作表集合 WorkSheets，还包含图表集合 Charts、宏表集合 Excel4MacroSheets 与 MS Excel 5.0 对话框集合 DialogSheets 等。</p> <p>任何时刻工作簿中只有一个工作表是活动工作表。</p> <h3 id="_2-使用工作表的索引号"><a href="#_2-使用工作表的索引号" class="header-anchor">#</a> 2）使用工作表的索引号</h3> <p>工作表索引号是指工作表在工作簿中的位置，Excel 根据工作表在工作表标签中的位置以 1 开始从左向右进行编号。下面的代码选中并激活当前工作簿中第 1 个工作表：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>单个 WorkSheet 对象的 Select 方法与 Activate 方法的主要区别在于 Select 方法要求工作表可视。</p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>当工作簿包括工作表、宏表、图表等时，使用索引号引用工作表如 Sheets(1) 与 WorkSheets(1) 引用的可能不是同一个表。</p></div> <p>使用 Worksheet 对象的 Index 属性可以返回工作表的索引号，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShInde<span class="token punctuation">(</span><span class="token punctuation">)</span>
	MsgBox Worksheets<span class="token punctuation">(</span><span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Index
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-使用工作表的代码名称"><a href="#_3-使用工作表的代码名称" class="header-anchor">#</a> 3）使用工作表的代码名称</h3> <p>使用 Worksheet 对象的 CodeName 属性可以返回工作表的代码名称，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShCodeName<span class="token punctuation">(</span><span class="token punctuation">)</span>
	MsgBox Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CodeName
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>工作表的代码名称显示在 VBE 工程资源管理器窗口中，在属性窗口中能够修改工作表代码名称，如图 21-1 所示。在 VBA 中能够直接使用工作表的代码名称引用工作表，即使工作表的名称被修改，代码仍然能够正常运行。</p> <div class="custom-block center"><p><img src="/blog/assets/img/21-1.7158bede.png" alt="" loading="lazy"></p> <p><u>图 21-1</u>	工作表的代码名称</p></div> <h3 id="_4-使用-activesheet-属性引用活动工作表"><a href="#_4-使用-activesheet-属性引用活动工作表" class="header-anchor">#</a> 4）使用 ActiveSheet 属性引用活动工作表</h3> <p>使用 ActiveSheet 属性可以返回活动工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
	MsgBox ActiveSheet<span class="token punctuation">.</span>Name
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ActiveSheet 属性应用于 AppActivate 对象、Window 对象和 Workbook 对象时，如果未给出对象识别符，返回活动工作簿中的活动工作表。</p> <h2 id="_22、选择工作表的方法"><a href="#_22、选择工作表的方法" class="header-anchor">#</a> 22、选择工作表的方法</h2> <p>在 VBA 中需要激活或者选择某个工作表时使用 Select 方法或 Activate 方法，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> SelectSh<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> ActivateSh<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>代码解析：</p> <p>SelectSh 过程使用 Select 方法选择“Sheet2”工作表，而 ActivateSh 过程则使用 Activate 方法选择“Sheet2”工作表，从表面看两者的作用是相同的，但是如果“Sheet2”工作表是隐藏的，Activate 方法可以正常运行，而 Select 方法将会出现错误，如图 22-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/22-1.d61638eb.png" alt="" loading="lazy"></p> <p><u>图 22-1</u>	Select 方法无效提示</p></div> <p>如果需要同时选中工作簿中的所有工作表，则只能使用 Select 方法而不能使用 Activate 方法，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> SelectShs<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Shs <span class="token keyword">As</span> Worksheet
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Shs <span class="token keyword">In</span> Worksheets
		Shs<span class="token punctuation">.</span><span class="token keyword">Select</span> <span class="token boolean">False</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> SelectSheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">.</span><span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> ArraySheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Worksheets<span class="token punctuation">(</span>Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码解析：</p> <p>SelectShs 过程遍历工作表并使用带参数的 Select 方法选中所有工作表。应用于 Worksheet 对象的 Select 方法的语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Select</span><span class="token punctuation">(</span>Replace<span class="token punctuation">)</span>

参数Replace是可选的。
如果该值为<span class="token boolean">True</span>，则用指定对象替代当前选定对象。
如果该值为<span class="token boolean">False</span>，则延伸当前选定对象以包括任何以前选定的对象。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>SelectSheets 过程使用 Worksheets 集合的 Select 方法选中集合中所有的对象。</p> <p>ArraySheets 过程使用 Array 函数返回工作簿中的前三张工作表并使用 Worksheets 集合的 Select 方法选中前三张工作表。</p> <h2 id="_23、遍历工作表的方法"><a href="#_23、遍历工作表的方法" class="header-anchor">#</a> 23、遍历工作表的方法</h2> <p>在 Excel 应用中经常需要遍历工作簿中所有的工作表，有以下两种方法可以实现。</p> <h3 id="_1-使用-for-next-语句"><a href="#_1-使用-for-next-语句" class="header-anchor">#</a> 1）使用 For...Next 语句</h3> <p>使用 For...Next 语句遍历工作簿中所有的工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShCount1<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> c <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> s <span class="token keyword">As</span> <span class="token keyword">String</span>
	c <span class="token operator">=</span> Worksheets<span class="token punctuation">.</span>Count
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> c
		s <span class="token operator">=</span> s <span class="token operator">&amp;</span> Worksheets<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
	<span class="token keyword">Next</span>
	MsgBox <span class="token string">&quot;工作簿中含有以下工作表:&quot;</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> s
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>代码解析：</p> <p>ShCount1 过程使用 For...Next 语句遍历工作簿中所有的工作表，并用消息框显示所有的工作表名称。
第 5 行代码根据 Worksheets 对象的 Count 属性返回工作簿中工作表的数量赋给变量 c。应用于Worksheets 对象的 Count 属性返回 Worksheets 集合中工作表的数量，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Count
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第 6 行代码开始 For...Next 语句循环。For...Next 语句以指定次数来重复执行一组语句，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">For</span> counter <span class="token operator">=</span> start <span class="token keyword">To</span> <span class="token keyword">end</span> [<span class="token keyword">Step</span> <span class="token keyword">step</span>]
	[statements]
	[<span class="token keyword">Exit</span> <span class="token keyword">For</span>]
	[statements]
<span class="token keyword">Next</span> [counter]

参数counter是必需的，用做循环计数器的数值变量。
参数start是必需的，循环计数器的初值。
参数<span class="token keyword">end</span>是必需的，循环计数器的终值。
参数<span class="token keyword">step</span>是可选的，环计数器的步长，缺省值为<span class="token number">1</span>。
参数statements是可选的，放在<span class="token keyword">For</span>和<span class="token keyword">Next</span>之间的一条或多条语句，它们将被执行指定的次数。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>第 7 行代码在 For...Next 循环中根据工作表的索引号取得所有工作表的名称赋给字符串变量 s。</p> <p>运行 ShCount 过程结果如图 23-1 所示。</p> <div class="custom-block center"><p><img src="data:image/png;base64,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" alt="" loading="lazy"></p> <p><u>图 23-1</u>	取得所有工作表名称</p></div> <h3 id="_2-使用-for-each-next-语句"><a href="#_2-使用-for-each-next-语句" class="header-anchor">#</a> 2）使用 For Each...Next 语句</h3> <p>使用 For Each...Next 语句遍历工作簿中所有的工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShCount2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">Dim</span> s <span class="token keyword">As</span> <span class="token keyword">String</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Sh <span class="token keyword">In</span> Worksheets
		s <span class="token operator">=</span> s <span class="token operator">&amp;</span> Sh<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
	<span class="token keyword">Next</span>
	MsgBox <span class="token string">&quot;工作簿中含有以下工作表:&quot;</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> s
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码解析：</p> <p>ShCount2 过程使用 For Each...Next 语句遍历工作簿中所有的工作表，并用消息框显示所有工作表名称。</p> <p>第 4 行代码使用 For Each...Next 语句遍历 Worksheets 集合中所有元素。For Each...Next 语句针对一个数组或集合中的每个元素，重复执行一组语句，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">For</span> <span class="token keyword">Each</span> element <span class="token keyword">In</span> Group
	[statements]
	[<span class="token keyword">Exit</span> <span class="token keyword">For</span>]
	[statements]
<span class="token keyword">Next</span> [element]

参数element是必需的，用来遍历集合或数组中所有元素的变量。
参数group是必需的，对象集合或数组的名称。
参数statements是可选的，针对对象集合或数组中的每一项执行的一条或多条语句。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>第 5 行代码将返回的工作表的名称赋给字符串变量s。</p> <p>运行 ShCount2 过程结果如图 23-1 所示。</p> <h2 id="_24、在工作表中上下翻页"><a href="#_24、在工作表中上下翻页" class="header-anchor">#</a> 24、在工作表中上下翻页</h2> <p>如果需要在工作簿的工作表中进行上下翻页，可以使用下面的代码。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DownSheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	i <span class="token operator">=</span> Worksheets<span class="token punctuation">.</span>Count
	<span class="token keyword">If</span> ActiveSheet<span class="token punctuation">.</span>Index <span class="token operator">&lt;</span> i <span class="token keyword">Then</span>
		Worksheets<span class="token punctuation">(</span>ActiveSheet<span class="token punctuation">.</span>Index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
	<span class="token keyword">Else</span>
		Worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> UpSheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	i <span class="token operator">=</span> Worksheets<span class="token punctuation">.</span>Count
	<span class="token keyword">If</span> ActiveSheet<span class="token punctuation">.</span>Index <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
		Worksheets<span class="token punctuation">(</span>ActiveSheet<span class="token punctuation">.</span>Index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
	<span class="token keyword">Else</span>
		Worksheets<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Activate
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>代码解析：</p> <p>DownSheet 过程向下翻页，第 3、12 行代码使用 Worksheets 对象的 Count 属性取得工作表的数目，第 4 行到第 7 行代码根据 Index 属性判断活动工作表是否是工作簿中的最后一张工作表。如果活动工作表不是最后一张工作表则激活活动工作表的下一张工作表，否则激活第一张工作表。</p> <p>UpSheet 过程向上翻页，第 13 行到第 16 行代码根据 Index 属性判断活动工作表是否是工作簿中的第一张工作表。如果活动工作表不是第一张工作表则激活活动工作表的上一张工作表，否则激活最后一张工作表。</p> <h2 id="_25、工作表的添加与删除"><a href="#_25、工作表的添加与删除" class="header-anchor">#</a> 25、工作表的添加与删除</h2> <p>在工作簿中添加工作表使用 Add 方法，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Addsh<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">With</span> Worksheets
		<span class="token keyword">Set</span> Sh <span class="token operator">=</span> <span class="token punctuation">.</span>Add<span class="token punctuation">(</span>after<span class="token punctuation">:</span><span class="token operator">=</span>Worksheets<span class="token punctuation">(</span><span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span>
		Sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;数据&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>代码解析：</p> <p>Addsh 过程使用 Add 方法在工作簿中新建“数据”工作表。</p> <p>第 2 行代码声明变量 Sh 为工作表对象。</p> <p>第 4 行代码使用 Add 方法在工作簿的最后新建“数据”工作表。</p> <p>Add 方法应用于 Sheets 和 Worksheets 对象时新建工作表、图表或宏表，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Before<span class="token punctuation">,</span> After<span class="token punctuation">,</span> Count<span class="token punctuation">,</span> <span class="token keyword">Type</span><span class="token punctuation">)</span>

参数Before是可选的，指定工作表对象，新建的工作表将置于此工作表之前。
参数After是可选的，指定工作表对象，新建的工作表将置于此工作表之后。
如果Before和After两者均省略，则新建的工作表将插入到活动工作表之前。
参数Count可选，要新建的工作表的数目。默认值为<span class="token number">1</span>。
参数<span class="token keyword">Type</span>可选，指定新建的工作表类型。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>第 5 行代码将添加的工作表重命名为“数据”。</p> <p>如果需要在工作簿中批量添加工作表，可以使用下面的代码。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Addsh_2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
		<span class="token keyword">Set</span> sh <span class="token operator">=</span> Sheets<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>after<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>Sheets<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span>
		sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> i
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码解析：</p> <p>Addsh_2 过程使用 For...Next 语句和 Add 方法在工作簿中添加 10 张工作表并将添加的工作表依次重命名。</p> <p>在使用以上代码往工作簿中添加工作表时，如果工作簿中已存在相同名称的工作表，运行时会发生错误，代码中断，如图 25-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/25-1.1ac8e468.png" alt="" loading="lazy"></p> <p><u>图 25-1</u>	运行错误提示</p></div> <p>为了避免此错误的发生，可以在添加前先删除所有的工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Delsh<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">For</span> <span class="token keyword">Each</span> sh <span class="token keyword">In</span> ThisWorkbook<span class="token punctuation">.</span>Sheets
		<span class="token keyword">If</span> sh<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;工作表的添加与删除&quot;</span> <span class="token keyword">Then</span>
			Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">False</span>
			sh<span class="token punctuation">.</span>Delete
			Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">True</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>代码解析：</p> <p>Delsh 过程使用 Delete 方法删除工作簿中除了“工作表的添加与删除”工作表以外所有的工作表。</p> <p>第 3 行代码使用 For Each...Next 语句遍历代码所在工作簿中所有的工作表。</p> <p>第 4 行到第 7 行代码判断工作表名称是否为“工作表的添加与删除”，如果不是则使用 Delete 方法删除。其中第 5 行代码将 Application 对象的 DisplayAlerts 属性设置为 False，使删除时不显示如图 25-2 所示系统警告对话框。</p> <div class="custom-block center"><p><img src="/blog/assets/img/25-2.f3716cd9.png" alt="" loading="lazy"></p> <p><u>图 25-2</u>	系统警告对话框</p></div> <p>第 6 行代码使用 Delete 方法删除工作表，应用于工作表对象的 Delete 方法删除指定的对象，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Delete

参数expression是必需的，该表达式返回<span class="token string">“应用于”</span>列表中的对象之一。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在运行添加工作表代码前先删除工作簿中的工作表虽然可以避免同名错误，但也可能误删除有用的工作表，因此更为严谨的方法是在添加前先判断工作簿中是否存在相同名称的工作表，然后再进行下一步的操作。</p> <p>对于单张工作表可以使用下面的代码。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Addsh_3<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> Sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">For</span> <span class="token keyword">Each</span> Sh <span class="token keyword">In</span> Worksheets
		<span class="token keyword">If</span> Sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;数据&quot;</span> <span class="token keyword">Then</span>
			MsgBox <span class="token string">&quot;工作簿中已有&quot;&quot;数据&quot;&quot;工作表,不能重复添加!&quot;</span>
			<span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
	<span class="token keyword">With</span> Worksheets
		<span class="token keyword">Set</span> Sh <span class="token operator">=</span> <span class="token punctuation">.</span>Add<span class="token punctuation">(</span>after<span class="token punctuation">:</span><span class="token operator">=</span>Worksheets<span class="token punctuation">(</span><span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span>
		Sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;数据&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>代码解析：</p> <p>Addsh_3 过程在使用 Add 方法在工作簿中新建“数据”工作表时首先判断工作簿中是否存在“数据”工作表，如果已存在“数据”工作表则不运行添加工作表的代码而只显示一个消息框进行提示，如图 25-3 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/25-3.3bded54c.png" alt="" loading="lazy"></p> <p><u>图 25-3</u>	工作表同名提示</p></div> <p>还可以使用错误处理语句来绕过错误，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Addsh_4<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> line
	<span class="token keyword">With</span> Worksheets
		<span class="token keyword">Set</span> sh <span class="token operator">=</span> <span class="token punctuation">.</span>Add<span class="token punctuation">(</span>after<span class="token punctuation">:</span><span class="token operator">=</span>Worksheets<span class="token punctuation">(</span><span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span>
		sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;数据&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
line<span class="token punctuation">:</span>
	MsgBox <span class="token string">&quot;工作簿中已有&quot;&quot;数据&quot;&quot;工作表,不能重复添加!&quot;</span>
	Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">False</span>
	Worksheets<span class="token punctuation">(</span>Worksheets<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
	Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>代码解析：</p> <p>Addsh_4 过程是先使用 Add 方法在工作簿中新建“数据”工作表，如果工作簿中已存在同名的工作表则使用 GoTo 语句转移到指定的 line 行处进行提示并删除已添加还没有重命名的工作表，也就是工作簿中最后一张工作表。</p> <p>如果是批量添加工作表，使用上述方法时，添加工作表和已有工作表重名时，后面即使没有重名的工作表也不能添加，所以应先使用错误处理语句忽略错误，待全部添加好以后再删除多余的工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Addsh_5<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> arr
	<span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	arr <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
		<span class="token keyword">With</span> Worksheets
			<span class="token keyword">Set</span> sh <span class="token operator">=</span> <span class="token punctuation">.</span>Add<span class="token punctuation">(</span>after<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span><span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span>
			sh<span class="token punctuation">.</span>Name <span class="token operator">=</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">End</span> <span class="token keyword">With</span>
	<span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">False</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> sh <span class="token keyword">In</span> Worksheets
		<span class="token keyword">If</span> sh<span class="token punctuation">.</span>Name <span class="token keyword">Like</span> <span class="token string">&quot;Sheet*&quot;</span> <span class="token keyword">Then</span> sh<span class="token punctuation">.</span>Delete
	<span class="token keyword">Next</span>
	Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>代码解析：</p> <p>Addsh_5 过程使用 Add 方法在工作簿中添加 10 张工作表并重新命名为 1 到 10，如果工作簿中已有相同名称的工作表则不添加。</p> <p>第 4 行代码错误处理语句，当发生重名错误时忽略错误，继续添加工作表。</p> <p>第 5 行到第 11 行代码在工作簿中添加 10 张工作表并重新命名为 1 到 10，如果工作簿中已有相同名称的工作表则忽略错误重命名时发生的错误，此时工作簿中添加的工作表会以系统赋与的名称命名，如“Sheet1”。</p> <p>第 12 行到第 15 行代码使用 For Each...Next 语句遍历工作簿中所有的工作表，将工作簿中凡是以“Sheet”开头的工作表删除。</p> <h2 id="_26、禁止删除指定工作表"><a href="#_26、禁止删除指定工作表" class="header-anchor">#</a> 26、禁止删除指定工作表</h2> <p>在工作表事件中是没有工作表删除事件的，为了防止用户误删除重要的工作表，除了使用保护工作簿方法外，还可以使用下面的代码。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Public</span> Ctl <span class="token keyword">As</span> CommandBarControl
<span class="token keyword">Sub</span> DelSht<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> Ctl <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>FindControl<span class="token punctuation">(</span>ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">847</span><span class="token punctuation">)</span>
	Ctl<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;MyDelSht&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> ResSht<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Set</span> Ctl <span class="token operator">=</span> Application<span class="token punctuation">.</span>CommandBars<span class="token punctuation">.</span>FindControl<span class="token punctuation">(</span>ID<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">847</span><span class="token punctuation">)</span>
	Ctl<span class="token punctuation">.</span>OnAction <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> MyDelSht<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">If</span> VBA<span class="token punctuation">.</span>UCase<span class="token operator">$</span><span class="token punctuation">(</span>ActiveSheet<span class="token punctuation">.</span>CodeName<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;SHEET2&quot;</span> <span class="token keyword">Then</span>
		MsgBox <span class="token string">&quot;禁止删除&quot;</span> <span class="token operator">&amp;</span> ActiveSheet<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">&quot;工作表!&quot;</span>
	<span class="token keyword">Else</span>
		ActiveSheet<span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>代码解析：</p> <p>DelSht 过程将工作表标签右键菜单中的“删除工作表”菜单的 OnAction 属性设置为“MyDelSht”。</p> <p>第 3 行代码使用 Set 语句将工作表标签右键菜单中的“删除工作表”菜单赋给变量 Ctl，并将其 OnAction 属性设置为 MyDelSht 过程，该菜单被单击时将运行“MyDelSht”过程而不是系统默认的设置。OnAction 属性返回或设置一个 VBA 的过程名，该过程在用户单击或更改某命令栏控件的值时运行。</p> <p>ResSht 过程将工作表标签右键菜单中的“删除工作表”菜单的 OnAction 属性恢复为默认设置。</p> <p>MyDelSht 过程判断所要删除的工作表的代码名称是否是“SHEET2”，如果是则禁止删除该表而只显示一个提示消息框。</p> <p>为了不影响其他工作簿的使用，在 VBE 中双击 ThisWorkbook 写入下面的代码。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Activate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Call</span> DelSht
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Deactivate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Call</span> ResSht
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>代码解析：</p> <p>工作簿的 Activate 事件和 Deactivate 事件代码，在工作簿激活时运行 DelSht 过程，在关闭或打开其他工作簿时运行 ResSht 过程，这样只禁止删除本工作簿中“SHEET2”工作表，并不影响其他工作簿。</p> <p>当删除本工作簿中的“SHEET2”工作表时，并不会显示如图 26-1 所示的消息框，而只会显示如图 26-2 所示的禁止删除工作表的消息框。</p> <div class="custom-block center"><p><img src="data:image/png;base64,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" alt="" loading="lazy"></p> <p><u>图 26-1</u>	工作表同名提示</p> <p><img src="data:image/png;base64,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" alt="" loading="lazy"></p> <p><u>图 26-2</u>	禁止删除工作表</p></div> <h2 id="_27、自动建立工作表目录"><a href="#_27、自动建立工作表目录" class="header-anchor">#</a> 27、自动建立工作表目录</h2> <p>如果在工作簿中有许多工作表，使用时往往会建立一张目录表并插入超链接以方便选择工作表。但是如果工作簿中的工作表经常添加和删除，使用手工建立目录很不方便，此时可以使用工作表的 Activate 事件自动建立工作表的目录，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Activate<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
	<span class="token keyword">Dim</span> a <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	R <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>[A65536]<span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
	a <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token keyword">If</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
		Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A2:A&quot;</span> <span class="token operator">&amp;</span> R<span class="token punctuation">)</span><span class="token punctuation">.</span>ClearContents
	<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> sh <span class="token keyword">In</span> Worksheets
		<span class="token keyword">If</span> sh<span class="token punctuation">.</span>CodeName <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;Sheet1&quot;</span> <span class="token keyword">Then</span>
			Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> sh<span class="token punctuation">.</span>Name
			a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>代码解析：</p> <p>工作表的 Activate 事件，在“目录”工作表激活时自动建立工作簿中除“目录”工作表外所有工作表的目录。</p> <p>第 2、3、4 行代码声明变量类型。</p> <p>第 5 行代码取得A列最后非空单元格的行号。</p> <p>第 6 行代码设置变量 a 的初始值为 2，从 <code>A2</code> 单元格开始建立工作表目录。</p> <p>第 7 行到第 9 行代码判断是否存在工作表目录，如果存在先清空原来的目录，以便更新目录。</p> <p>第 10 行到第 15 代码遍历工作簿的所有工作表，将除“目录”工作表外所有工作表的名称写入到 A 列单元格中。</p> <p>为了建立到各工作表的链接，使用工作表的 SelectionChange 事件，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	R <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>[A65500]<span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Count <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
		<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
			<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Row <span class="token operator">&lt;</span><span class="token operator">=</span> R <span class="token keyword">Then</span>
				Sheets<span class="token punctuation">(</span>Target<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
			<span class="token keyword">End</span> <span class="token keyword">If</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码解析：</p> <p>工作表的 SelectionChange 事件，当选择 A 列工作表目录中工作表名称时自动选择该单元格所对应的工作表。</p> <p>第 5、6、7 行代码限制该事件触发的条件。</p> <p>第 8 行代码选择单元格所对应的工作表。</p> <p>“目录”工作表激活后自动在 A 列建立工作簿中除“目录”工作表以外所有表的目录，如图 27-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/27-1.026c9465.png" alt="" loading="lazy"></p> <p><u>图 27-1</u>	自动建立工作表目录</p></div> <h2 id="_28、工作表的深度隐藏"><a href="#_28、工作表的深度隐藏" class="header-anchor">#</a> 28、工作表的深度隐藏</h2> <p>在使用 VBA 开发的工作簿文件完成交与用户使用后，我们往往希望用户在打开工作簿时启用宏，此时除了使用“禁用宏则关闭工作簿”的功能外，还可以隐藏所有有数据的工作表，如果用户在打开工作簿时禁用宏则只显示一张空白的工作表，达到强制启用宏的效果，代码如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Dim</span> sh <span class="token keyword">As</span> Worksheet
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_BeforeClose<span class="token punctuation">(</span>Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
	Sheet1<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> sh <span class="token keyword">In</span> ThisWorkbook<span class="token punctuation">.</span>Sheets
		<span class="token keyword">If</span> sh<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;空白&quot;</span> <span class="token keyword">Then</span>
			sh<span class="token punctuation">.</span>Visible <span class="token operator">=</span> xlSheetVeryHidden
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
	ActiveWorkbook<span class="token punctuation">.</span>Save
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> <span class="token keyword">Each</span> sh <span class="token keyword">In</span> ThisWorkbook<span class="token punctuation">.</span>Sheets
		<span class="token keyword">If</span> sh<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;空白&quot;</span> <span class="token keyword">Then</span>
			sh<span class="token punctuation">.</span>Visible <span class="token operator">=</span> xlSheetVisible
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
	Sheet1<span class="token punctuation">.</span>Visible <span class="token operator">=</span> xlSheetVeryHidden
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>代码解析：</p> <p>第 2 行到第 10 行代码是工作簿的 BeforeClose 事件过程，在工作簿关闭前隐藏除“空白”表以外的所有的工作表。</p> <p>第 3 行代码将“空白”表的 Visible 属性设置为 True，使其可见。</p> <p>应用于 Charts 和 Worksheets 对象的 Visible 属性决定对象是否可见，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Visible

参数expression是必需的，该表达式返回上面的对象之一。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Visible 属性可以设置为表格 28-1 所示的 XlSheetVisibility 常量之一。</p> <p><u>表格 28-1</u>	XlSheetVisibility 常量</p> <table><thead><tr><th>常量</th> <th></th> <th>描述</th></tr></thead> <tbody><tr><td>xlSheetHidden</td> <td>0</td> <td>隐藏对象，可以通过“格式”→“工作表”→“取消隐藏”菜单使对象重新可见，等同于设置为False。</td></tr> <tr><td>xlSheetVisible</td> <td>-1</td> <td>使对象重新可见，等同于设置为True。</td></tr> <tr><td>xlSheetVeryHidden</td> <td>2</td> <td>隐藏对象，使该对象重新可见的唯一方法是将此属性设置为True或xlSheetVisible。</td></tr></tbody></table> <p>第 4 行到第 8 行代码使用 For Each...Next 语句遍历工作簿中所有的工作表，将除“空白”表以外的所有工作表的 Visible 属性设置为 xlSheetVeryHidden，使之隐藏。</p> <p>Visible 属性设置为 xlSheetVeryHidden 后工作表不能通过“格式”→“工作表”→“取消隐藏”菜单来显示隐藏的工作表。</p> <p>第 9 行代码使用 Save 方法保存代码所在工作簿的更改，在关闭工作簿时不显示如图 28-1 所示的消息框。</p> <div class="custom-block center"><p><img src="/blog/assets/img/28-1.3d597e7f.png" alt="" loading="lazy"></p> <p><u>图 28-1</u>	工作簿保存提示</p></div> <p>第 10 行到第 18 行代码是工作簿的 Open 事件过程，在打开工作簿时将除“空白”表以外的所有工作表的 Visible 属性设置为 xlSheetVisible，取消隐藏。如果打开工作簿时禁用宏，则工作簿中除了“空白”表以外，其他的工作表还处于深度隐藏的状态，如图 28-2 所示，这样就达到强制用户启用宏的效果，当然这还需要 VBA 工程保护的配合。</p> <div class="custom-block center"><p><img src="data:image/png;base64,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" alt="" loading="lazy"></p> <p><u>图 28-2</u>	工作簿保存提示</p></div> <h2 id="_29、防止更改工作表的名称"><a href="#_29、防止更改工作表的名称" class="header-anchor">#</a> 29、防止更改工作表的名称</h2> <p>工作表的名称显示在工作表标签上，除了在相应的功能菜单中可以对其进行重命名操作外，在工作表标签上双击鼠标也能修改工作表名称。一旦修改了工作表名称，可能就会产生一连串的问题，例如在其他工作簿中对该工作表的引用将会失效，通过工作表名称引用工作表的代码也将出错。</p> <p>Excel 没有提供修改工作表名称的相关事件，要禁止用户修改工作表名称，需采取其他一些技巧。比如在工作表 BeforeClose 事件中检验工作表名称，如果工作表名称不是指定的字符串，则将其修改为指定字符串，即保持工作表名称不变，代码如下。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_BeforeClose<span class="token punctuation">(</span>Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
	<span class="token keyword">If</span> Sheet1<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;Excel Home&quot;</span> <span class="token keyword">Then</span> Sheet1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;Excel Home&quot;</span>
	ThisWorkbook<span class="token punctuation">.</span>Save
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>代码解析：</p> <p>工作簿的 BeforeClose 事件过程，在关闭当前工作簿时判断 Sheet1 工作表名称，如果不是指定的字符串“Excel Home”，则将其恢复为“Excel Home”后保存工作簿，从而避免更改 Sheet1 工作表名称。</p> <h2 id="_30、工作表中一次插入多行"><a href="#_30、工作表中一次插入多行" class="header-anchor">#</a> 30、工作表中一次插入多行</h2> <p>在工作表的中插入多行空行，需要使用 Insert 方法，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> InSertRows_1<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">3</span>
		Sheet1<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>代码解析：</p> <p>InSertRows_1 过程使用 Insert 方法在如图 30-1 所示的数据区域的第 2 行和第 3 行之间插入三行空行。</p> <div class="custom-block center"><p><img src="data:image/png;base64,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" alt="" loading="lazy"></p> <p><u>图 30-1</u>	数据区域</p></div> <p>Insert 方法应用于 Range 对象时在工作表或宏表中插入一个单元格或单元格区域，其他单元格作相应移位以腾出空间，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Insert<span class="token punctuation">(</span>Shift<span class="token punctuation">,</span> CopyOrigin<span class="token punctuation">)</span>

参数expression是必需的，该表达式返回一个Range对象。
参数Shift是可选的，指定单元格的移动方向。可为以下XlInsertShiftDirection常量之一：xlShiftToRight或xlShiftDown。如果省略本参数，Microsoft Excel将依据该区域的形状决定移动方向。
参数CopyOrigin是可选的，复制的起点。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>还可以使用引用多行的方法，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> InSertRows_2<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet2<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>EntireRow<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>代码解析：</p> <p>InSertRows_2 过程通过引用多行区域的方法实现一次插入多行。</p> <p>第 2 行代码中的 Range(“A3”).EntireRow 属性返回 Range(“A3”) 单元格所在的一整行，然后使用 Resize 属性调整行数后插入三行空行。</p> <p>也可以直接指定相应行再调整行数后插入空行，如下面的示例代码：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> InSertRows_3<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet3<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>运行以上过程，工作表中如图 30-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/30-2.8985660e.png" alt="" loading="lazy"></p> <p><u>图 30-2</u>	插入三行空行</p></div> <h2 id="_31、删除工作表中的空行"><a href="#_31、删除工作表中的空行" class="header-anchor">#</a> 31、删除工作表中的空行</h2> <p>如果需要删除如图 31-1 所示的工作表中所有的空行，可以使用下面的代码。</p> <div class="custom-block center"><p><img src="/blog/assets/img/31-1.ea781359.png" alt="" loading="lazy"></p> <p><u>图 31-1</u>	需删除空行的工作表区域</p></div> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DelBlankRow<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> rRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">Dim</span> LRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
	rRow <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>Row
	LRow <span class="token operator">=</span> rRow <span class="token operator">+</span> Sheet1<span class="token punctuation">.</span>UsedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> LRow <span class="token keyword">To</span> rRow <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
		<span class="token keyword">If</span> Application<span class="token punctuation">.</span>WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span>Rows<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
			Rows<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码解析：</p> <p>DelBlankRow 过程删除工作表中已使用的区域的所有空行。</p> <p>第 5 行代码获得工作表中已使用区域的首行行号，其中使用 UsedRange 属性返回工作表中已使用的区域。</p> <p>第 6 行代码获得工作表中已使用区域的最后一行行号。</p> <p>第 7 行到第 11 行代码从最大行数至最小行数循环判断指定行是否为空行，若为空行则删除该行。</p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>此处一定要从最大行数至最小行数开始循环判断，因为如果工作表中存在两行及两行以上的相邻空行，从最小行数开始循环删除的话，当第一行空行被删除后，被删除行下面的一行会往上移位，而此时 For...Next 循环的计数器已经加 1，所以会出现漏删除的现象。</p></div> <p>其中第 8、9 行代码使用工作表 CountA 函数判断当前行已使用单元格的数量，如果为零说明此行是空行则使用 Delete 删除。</p> <p>应用于 Range 对象的 Delete 方法删除对象，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Delete<span class="token punctuation">(</span>Shift<span class="token punctuation">)</span>

参数expression是必需的，返回一个Range对象。
参数Shift是可选的，指定删除单元格时替补单元格的移位方式。可为以下 XlDeleteShiftDirection常量之一：xlShiftToLeft或xlShiftUp。如果省略该参数，则Microsoft Excel将根据区域的图形决定移位方式。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>运行 DelBlankRow 过程工作表区域如图 31-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/31-2.b6a11f60.png" alt="" loading="lazy"></p> <p><u>图 31-2</u>	删除空行的工作表区域</p></div> <h2 id="_32、删除工作表的重复行"><a href="#_32、删除工作表的重复行" class="header-anchor">#</a> 32、删除工作表的重复行</h2> <p>在实际应用中，可能需要删除如图 32-1 所示的工作表中 A 列的重复内容而只保留一行，那么可以借助工作表 CountIf 函数来完成，如下面的代码所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/32-1.281b9813.png" alt="" loading="lazy"></p> <p><u>图 32-1</u>	需删除重复行的工作表区域</p></div> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> DeleteRow<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">With</span> Sheet1
		R <span class="token operator">=</span> <span class="token punctuation">.</span>[a65536]<span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
		<span class="token keyword">For</span> i <span class="token operator">=</span> R <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
			<span class="token keyword">If</span> WorksheetFunction<span class="token punctuation">.</span>CountIf<span class="token punctuation">(</span><span class="token punctuation">.</span>Columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
				<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
			<span class="token keyword">End</span> <span class="token keyword">If</span>
		<span class="token keyword">Next</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码解析：</p> <p>DeleteRow 过程删除工作表 A 列重复单元格所在的整行内容，只保留一行。</p> <p>第 5 行代码取得工作表中 A 列的最后一个非空单元格的行号。</p> <p>第 6 行到第 10 行代码从最大行数至最小行数循环判断A列单元格内容是否重复并删除重复单元格所在的整行。此处 For...Next 循环也要从最大行数至最小行数开始循环判断，否则可能会删除不净。其中第 7、8 行代码使用工作表 CountIf 函数判断单元格内容是否重复，如果重复则删除该单元格所在的行。</p> <p>运行 DeleteRow 过程工作表区域如图 32-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/32-2.e556a1a4.png" alt="" loading="lazy"></p> <p><u>图 32-2</u>	删除重复行的工作表区域</p></div> <h2 id="_33、定位删除特定内容所在的行"><a href="#_33、定位删除特定内容所在的行" class="header-anchor">#</a> 33、定位删除特定内容所在的行</h2> <p>如果需要删除如图 33-1 所示的工作表区域中特定内容所在的行，可以使用定位的方法快速删除，无需使用 For...Next 循环对单元格逐个进行判断。</p> <div class="custom-block center"><p><img src="/blog/assets/img/33-1.863728fc.png" alt="" loading="lazy"></p> <p><u>图 33-1</u>	需删除的工作表区域</p></div> <p>示例代码如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> SpecialDelete<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> R <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">With</span> Sheet1
		R <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a65536&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
		<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a2:a&quot;</span> <span class="token operator">&amp;</span> R<span class="token punctuation">)</span><span class="token punctuation">.</span>Replace <span class="token string">&quot;Excel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span>
		<span class="token punctuation">.</span>Columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SpecialCells<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>EntireRow<span class="token punctuation">.</span>Delete
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码解析：</p> <p>SpecialDelete 过程删除工作表A列单元格中显示为“Excel”的行。</p> <p>第 5 行代码使用 Replace 方法将工作表A列中显示为“Excel”的单元格内容替换成空白。</p> <p>第 6 行代码使用 SpecialCells 方法定位到工作表 A 列中所有的空单元格，使用 Range 对象的 EntireRow 属性返回其所在的整个行一次性删除。</p> <p>运行 SpecialDelete 过程工作表区域如图 33-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/33-2.2659a3b9.png" alt="" loading="lazy"></p> <p><u>图 33-2</u>	删除后的工作表区域</p></div> <h2 id="_34、判断是否选中整行"><a href="#_34、判断是否选中整行" class="header-anchor">#</a> 34、判断是否选中整行</h2> <p>通过当前选择的单元格区域的单元格数目与行数或列数相比较，判断用户是否选中了整行或整列，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
	<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
		<span class="token keyword">If</span> Target<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count <span class="token operator">=</span> <span class="token number">256</span> <span class="token keyword">Then</span>
			MsgBox <span class="token string">&quot;您选中了整行,当前行号&quot;</span> <span class="token operator">&amp;</span> Target<span class="token punctuation">.</span>Row
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>代码解析：</p> <p>工作表的 SelectionChange 事件，判断用户是否选中了工作表中一整行单元格区域。</p> <p>第 2 行代码中的 Target.Rows.Count 返回目标区域的行数，确定用户当前选择区域的总行数是否为 1。</p> <p>第 3 行代码中的 Target.Columns.Count 返回目标区域的列数，确定用户当前选择区域总列数是否为 256。</p> <p>第 4 行代码当用户选中一整行时显示一个消息框，提示用户当前选择的行号，如图 34-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/34-1.1a45d402.png" alt="" loading="lazy"></p> <p><u>图 34-1</u>	判断用户是否选中整行</p></div> <p>如果需要判断是否选中了整列，只需将上面代码中的总行数修改为 65536，总列数修改为 1。</p> <h2 id="_35、限制工作表的滚动区域"><a href="#_35、限制工作表的滚动区域" class="header-anchor">#</a> 35、限制工作表的滚动区域</h2> <p>如果希望限制工作表中滚动的区域，可以通过设置 WorkSheet 对象的 ScrollArea 属性来实现。 ScrollArea 属性使用以A1样式的区域引用形式（字符串类型）返回或设置工作表允许滚动的区域。当设置了工作表滚动区域之后，用户不能选定滚动区域之外的单元格，但仍然可以选定区域之外的其他对象（例如图形、按钮等），同时工作表的一些相应功能可能被禁止（例如工作表全选、选中整行或整列等）。</p> <p>在 VBE 中的工程管理窗口选择相应工作表对象，然后在其属性窗口中设置 ScrollArea 属性，即可限制工作表中滚动的区域，如图 35-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/35-1.cd434097.png" alt="" loading="lazy"></p> <p><u>图 35-1</u>	设置 ScrollArea 属性</p></div> <p>但是 Excel 不会记忆该项设置，当再次打开该工作簿时，ScrollArea 属性将被重置，用户必须重新设置 ScrollArea 属性才能限制工作表中的滚动区域，解决方法是使用代码在工作簿打开时对 ScrollArea 属性进行设置，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Workbook_Open<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet1<span class="token punctuation">.</span>ScrollArea <span class="token operator">=</span> <span class="token string">&quot;B4:H12&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>代码解析：</p> <p>工作簿的 Open 事件，在打开该工作簿时设置 Sheet1 工作表的滚动区域为“B4:H12”单元格区域。</p> <p>如果需要取消滚动区域的限制，可以将 ScrollArea 属性值设置为空，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>Sheet1<span class="token punctuation">.</span>ScrollArea <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_36、复制自动筛选后的数据区域"><a href="#_36、复制自动筛选后的数据区域" class="header-anchor">#</a> 36、复制自动筛选后的数据区域</h2> <p>用户在对如图 36-1 所示的数据列表进行自动筛选后，往往希望将自动筛选的结果复制到其它地方。</p> <div class="custom-block center"><p><img src="/blog/assets/img/36-1.d19cb259.png" alt="" loading="lazy"></p> <p><u>图 36-1</u>	筛选结果</p></div> <p>这时可以通过获取该列表区域中可见单元格的方法得到筛选结果的单元格区域，并复制到工作表 Sheet2 中，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> CopyFilter<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet2<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Clear
	<span class="token keyword">With</span> Sheet1
		<span class="token keyword">If</span> <span class="token punctuation">.</span>FilterMode <span class="token keyword">Then</span>
			<span class="token punctuation">.</span>AutoFilter<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>SpecialCells<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Copy Sheet2<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码解析：</p> <p>CopyFilter 过程将 Sheet1 表中的筛选结果复制到工作表 Sheet2 中。</p> <p>第 2 行代码清除 Sheet2 表中数据。</p> <p>第 4 行代码判断 Sheet1 表是否处于自动筛选状态。FilterMode 属性返回工作表是否处于筛选模式，如果指定工作表中包含已筛选序列且该序列中含有隐藏行，则该值为 True。</p> <p>第 5 行代码通过 AutoFilter 对象的 Range 属性返回工作表的自动筛选列表区域，再使用 SpecialCells 方法获取该列表区域中可见单元格，得到筛选结果的单元格区域，然后使用 Copy 方法将结果区域复制到工作表 Sheet2 中，应用于 Range 对象的 Copy 方法将单元格区域复制到指定的区域或剪贴板中，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Copy<span class="token punctuation">(</span>Destination<span class="token punctuation">)</span>

参数expression是必需的，该表达式返回一个Range对象。
参数Destination是可选的，指定区域要复制到的目标区域。如果省略该参数，则将该区域复制到剪贴板中。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>运行 CopyFilter 过程工作表 Sheet2 如图 36-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/36-2.cb697740.png" alt="" loading="lazy"></p> <p><u>图 36-2</u>	复制筛选区域</p></div> <h2 id="_37、使用高级筛选获得不重复记录"><a href="#_37、使用高级筛选获得不重复记录" class="header-anchor">#</a> 37、使用高级筛选获得不重复记录</h2> <p>在如图 37-1 所示的数据列表中，如果要将其中不重复的记录复制到另一工作表中，则可以通过高级筛选功能实现。</p> <div class="custom-block center"><p><img src="/blog/assets/img/37-1.40e93791.png" alt="" loading="lazy"></p> <p><u>图 37-1</u>	数据列表</p></div> <p>示例代码如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> Filter<span class="token punctuation">(</span><span class="token punctuation">)</span>
	Sheet1<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CurrentRegion<span class="token punctuation">.</span>AdvancedFilter <span class="token operator">_</span>
		Action<span class="token punctuation">:</span><span class="token operator">=</span>xlFilterCopy<span class="token punctuation">,</span> Unique<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token operator">_</span>
		CopyToRange<span class="token punctuation">:</span><span class="token operator">=</span>Sheet2<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>代码解析：</p> <p>Filter 过程使用 AdvancedFilter 方法对单元格 <code>A1</code> 的当前区域筛选不重复的记录，并将筛选结果复制到工作表 Sheet2 中。应用于 Range 集合的 AdvancedFilter 方法语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>AdvancedFilter<span class="token punctuation">(</span>Action<span class="token punctuation">,</span> CriteriaRange<span class="token punctuation">,</span> CopyToRange<span class="token punctuation">,</span> Unique<span class="token punctuation">)</span>

参数Action是必需的，可以为表格<span class="token number">37</span><span class="token operator">-</span><span class="token number">1</span>所列的XlFilterAction常量之一。
参数CriteriaRange指定高级筛选操作的条件区域，缺省时表示没有条件限制。
参数CopyToRange表示指定被复制行的目标区域，仅当Action为xlFilterCopy时有效，否则忽略本参数。
参数Unique指示是否选择不重复的记录，如果其值为<span class="token boolean">True</span>，则重复出现的记录仅保留一条；如果其值为<span class="token boolean">False</span>（默认值），则筛选出所有符合条件的记录。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>表格 37-1	XlFilterAction 常量</p> <table><thead><tr><th>XlFilterAction 常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>xlFilterCopy</td> <td>2</td> <td>将筛选结果复制到其他位置</td></tr> <tr><td>xlFilterInPlace</td> <td>1</td> <td>在原有区域显示筛选结果</td></tr></tbody></table> <p>运行 FilterUnique 过程，结果如图 37-2 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/37-2.f1b53a65.png" alt="" loading="lazy"></p> <p><u>图 37-2</u>	得到不重复记录结果</p></div> <h2 id="_38、工作表的保护与解除保护"><a href="#_38、工作表的保护与解除保护" class="header-anchor">#</a> 38、工作表的保护与解除保护</h2> <p>在实际应用中，Excel 编制的报表、表格、程序等，往往在单元格中设置了公式、函数、自定义格式等，为了防止在使用过程中修改或无意中修改这些设置，一般使用 Excel 的工作表保护功能来保护这些设置。</p> <p>但是程序中可能会使用代码对受保护的工作表进行操作，此时如果没有解除工作表保护，运行出现错误，如图 38-1 所示。</p> <div class="custom-block center"><p><img src="/blog/assets/img/38-1.7130c810.png" alt="" loading="lazy"></p> <p><u>图 38-1</u>	运行错误提示</p></div> <p>解决方法是在运行操作工作表的代码前先使用代码解除工作表保护，待操作完毕后再保护工作表，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> ShProtect<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">With</span> Sheet1
		<span class="token punctuation">.</span>Unprotect Password<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;12345&quot;</span>
		<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">100</span>
		<span class="token punctuation">.</span>Protect Password<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;12345&quot;</span>
	<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>代码解析：</p> <p>ShProtect 过程在受保护的工作表中对单元格进行操作，其中第 3 行代码使用 Unprotect 方法解除工作表的保护。应用于 Worksheet 对象的 Unprotect 方法解除工作表的保护，如果工作表不是受保护的，则此方法不起作用，所以在解除之前无需判断工作表是否受保护，其语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Unprotect<span class="token punctuation">(</span>Password<span class="token punctuation">)</span>

参数expression是必需的，该表达式返回一个Worksheet 对象。
参数Password是可选的，指定用于解除工作表的保护的密码，此密码是区分大小写的。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>第 4、5 行代码在单元格录入数据后使用 Protect 方法重新保护工作表。应用于 Worksheet 对象的 Protect 方法保护工作表使其不至被修改，语法如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code>expression<span class="token punctuation">.</span>Protect<span class="token punctuation">(</span>Password<span class="token punctuation">,</span> DrawingObjects<span class="token punctuation">,</span> Contents<span class="token punctuation">,</span> Scenarios<span class="token punctuation">,</span> UserInterfaceOnly<span class="token punctuation">,</span> AllowFormattingCells<span class="token punctuation">,</span> AllowFormattingColumns<span class="token punctuation">,</span> AllowFormattingRows<span class="token punctuation">,</span> AllowInsertingColumns<span class="token punctuation">,</span> AllowInsertingRows<span class="token punctuation">,</span> AllowInsertingHyperlinks<span class="token punctuation">,</span> AllowDeletingColumns<span class="token punctuation">,</span> AllowDeletingRows<span class="token punctuation">,</span> AllowSorting<span class="token punctuation">,</span> AllowFiltering<span class="token punctuation">,</span> AllowUsingPivotTables<span class="token punctuation">)</span> 

参数expression是必需的，该表达式返回一个Worksheet对象。
参数Password是可选的，为一个字符串，该字符串为工作表指定区分大小写的密码。
其他参数都是可选参数，其功能等同于如图<span class="token number">38</span><span class="token operator">-</span><span class="token number">2</span>所示的工作表保护对话框中的各项选项，具体请参阅VBA帮助。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block center"><p><img src="/blog/assets/img/38-2.24ef5112.png" alt="" loading="lazy"></p> <p><u>图 38-2</u>	工作表保护选项</p></div> <p>如果一个 Excel 文件使用时间过长，忘记了工作表保护时设置的密码，那么也可以使用 VBA 解除工作表的保护，代码如下：</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> RemoveShProtect<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> i1 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i2 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i3 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i4 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i5 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i6 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i7 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i8 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i9 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">Dim</span> i10 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i11 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> i12 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
	<span class="token keyword">If</span> ActiveSheet<span class="token punctuation">.</span>ProtectContents <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token keyword">Then</span>
		MsgBox <span class="token string">&quot;该工作表没有保护密码！&quot;</span>
		<span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
	<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">For</span> i1 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i2 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i3 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span>
	<span class="token keyword">For</span> i4 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i5 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i6 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span>
	<span class="token keyword">For</span> i7 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i8 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i9 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span>
	<span class="token keyword">For</span> i10 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i11 <span class="token operator">=</span> <span class="token number">65</span> <span class="token keyword">To</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i12 <span class="token operator">=</span> <span class="token number">32</span> <span class="token keyword">To</span> <span class="token number">126</span>
		ActiveSheet<span class="token punctuation">.</span>Unprotect Chr<span class="token punctuation">(</span>i1<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i2<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i3<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i4<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i5<span class="token punctuation">)</span> <span class="token operator">_</span>
		<span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i6<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i7<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i8<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i9<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i10<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i11<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Chr<span class="token punctuation">(</span>i12<span class="token punctuation">)</span>
		<span class="token keyword">If</span> ActiveSheet<span class="token punctuation">.</span>ProtectContents <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token keyword">Then</span>
			MsgBox <span class="token string">&quot;已经解除了工作表保护！&quot;</span>
			<span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
		<span class="token keyword">End</span> <span class="token keyword">If</span>
	<span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span>
	<span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span><span class="token punctuation">:</span> <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>代码解析：</p> <p>RemoveShProtect 过程解除工作表的保护。</p> <p>其中第 7 行到第 10 行代码判断工作表是否受保护，ProtectContents 属性返回工作表的保护状态，如果工作表的内容处于保护状态，则该值为 True。</p> <p>第 11 行到第 22 行代码使用 For...Next 语句和 Chr 函数来返回指定字符码所代表的字符串组合不断地尝试解除工作表保护，一旦工作表的 ProtectContents 属性返回 False 说明已经解除工作表保护。</p> <h2 id="_39、奇偶页打印"><a href="#_39、奇偶页打印" class="header-anchor">#</a> 39、奇偶页打印</h2> <p>在 Excel 中却没有提供打印奇数页和偶数页的功能，用户可以使用 VBA 在 Excel 中实现该功能，如下面的代码所示。</p> <div class="language-vb line-numbers-mode"><pre class="language-vb"><code><span class="token keyword">Sub</span> PrintOddPage<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">Dim</span> TotalPg <span class="token keyword">As</span> <span class="token keyword">Integer</span>
	TotalPg <span class="token operator">=</span> ExecuteExcel4Macro<span class="token punctuation">(</span><span class="token string">&quot;GET.DOCUMENT(50)&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> TotalPg <span class="token keyword">Step</span> <span class="token number">2</span>
		ActiveSheet<span class="token punctuation">.</span>PrintOut From<span class="token punctuation">:</span><span class="token operator">=</span>i<span class="token punctuation">,</span> <span class="token keyword">To</span><span class="token punctuation">:</span><span class="token operator">=</span>i
	<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>代码解析：</p> <p>第 3 行代码使用 Excel 4.0 宏表函数获取总页数，通过该函数获取总页数而无需判断分页符。</p> <p>第 4 行到第 6 行代码逐页打印所有奇数页，其中第 5 行代码中的参数 From 和 To 指定打印的开始页数和结束页数。</p> <p>将第 4 行代码中的数值改为 2，则实现偶数页的打印。</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/Ryukarin/blog/edit/main/project/Excel/04.VBA_Sheet.md" target="_blank" rel="noopener noreferrer">编辑此页</a></div> <div class="meta-item update-time"><span class="label">上次编辑于:</span> <span class="info">2022年1月26日 14:11</span></div> <div class="meta-item contributors"><span class="label">贡献者: </span> <span class="info"><span title="email: ryuukaringo@gmail.com" class="contributor">
          ryuukarin
        </span> <!----></span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog/project/Excel/03.VBA_Range/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        VBA 之 Range 对象
      </a></span> <span class="next"><a href="/blog/project/Excel/05.VBA_Workbook/">
        VBA 之 Workbook 对象
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <div class="comments-wrapper"><div class="waline-wrapper"><div id="waline-comment"></div></div></div> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://gitee.com/ryuukarin" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a><a href="https://github.com/Ryukarin" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div> <div class="footer">MIT Licensed</div> <div class="copyright">Copyright © 2022 karin</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="关闭" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">该应用可以安装在您的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。</p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>详情</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        安装 <span></span></button> <button class="cancel-button">
        取消
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="关闭" aria-label="关闭" class="pswp__button pswp__button--close"></button> <button title="分享" aria-label="分享" class="pswp__button pswp__button--share"></button> <button title="切换全屏" aria-label="切换全屏" class="pswp__button pswp__button--fs"></button> <button title="缩放" aria-label="缩放" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="上一个 (左箭头)" aria-label="上一个 (左箭头)" class="pswp__button pswp__button--arrow--left"></button> <button title="下一个 (右箭头)" aria-label="下一个 (右箭头)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/blog/assets/js/app.9f9c9b81.js" defer></script><script src="/blog/assets/js/vendors~layout-Layout.79b66223.js" defer></script><script src="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.efafecdd.js" defer></script><script src="/blog/assets/js/page-VBA之Sheet对象.40acafa7.js" defer></script>
  </body>
</html>
