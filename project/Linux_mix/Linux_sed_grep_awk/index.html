<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>linux三剑客 | KARIN</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://vuepress-theme-hope-demo.mrhope.site/blog/atom.xml" title="KARIN Atom Feed">
    <link rel="alternate" type="application/json" href="https://vuepress-theme-hope-demo.mrhope.site/blog/feed.json" title="KARIN JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://vuepress-theme-hope-demo.mrhope.site/blog/rss.xml" title="KARIN RSS Feed">
    <link rel="icon" href="/favicon.png">
    <link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192">
    <link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png">
    <meta name="description" content="KARIN的学习笔记">
    <meta property="og:url" content="/blog/project/Linux_mix/Linux_sed_grep_awk.html">
    <meta property="og:site_name" content="KARIN">
    <meta property="og:title" content="linux三剑客">
    <meta property="og:description" content="grep 命令 很多时候，我们并不需要列出文件的全部内容，而是从文件中找到包含指定信息的那些行，要实现这个目的，可以使用 grep 命令。 grep 命令作为 Linux 文本处理三剑客的一员，另外两个是 sed 和 awk。 grep 命令的由来可以追溯到 UNIX 诞生的早期，在 UNIX 系统中，搜索的模式（patterns）被称为正则表达式（regu">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="KARIN">
    <meta property="article:author" content="karin">
    <meta property="article:tag" content="linux">
    <meta property="article:published_time" content="2021-04-09T00:00:00.000Z">
    <meta name="theme-color" content="#46bd87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/blog/assets/css/0.styles.5649bb21.css" as="style"><link rel="preload" href="/blog/assets/js/app.9f9c9b81.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Layout.79b66223.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.efafecdd.js" as="script"><link rel="preload" href="/blog/assets/js/page-linux三剑客.e71431d8.js" as="script"><link rel="prefetch" href="/blog/assets/js/122.7ad47f04.js"><link rel="prefetch" href="/blog/assets/js/123.ae4a39df.js"><link rel="prefetch" href="/blog/assets/js/124.2715123b.js"><link rel="prefetch" href="/blog/assets/js/125.a4234a33.js"><link rel="prefetch" href="/blog/assets/js/126.8fa2f32c.js"><link rel="prefetch" href="/blog/assets/js/127.9bf5c918.js"><link rel="prefetch" href="/blog/assets/js/128.0c398c07.js"><link rel="prefetch" href="/blog/assets/js/layout-Blog.8dd576a3.js"><link rel="prefetch" href="/blog/assets/js/layout-Layout.3729e73b.js"><link rel="prefetch" href="/blog/assets/js/layout-NotFound.f1d2f2e6.js"><link rel="prefetch" href="/blog/assets/js/layout-Slide.7ed7d0aa.js"><link rel="prefetch" href="/blog/assets/js/page--3d4f54c7.4eab0894.js"><link rel="prefetch" href="/blog/assets/js/page-Docker数据管理.143b7f4f.js"><link rel="prefetch" href="/blog/assets/js/page-Excel函数.22369a36.js"><link rel="prefetch" href="/blog/assets/js/page-Excel快捷键.8fdc623f.js"><link rel="prefetch" href="/blog/assets/js/page-Excel笔记介绍.57c3fe06.js"><link rel="prefetch" href="/blog/assets/js/page-FTP笔记.2b8526c8.js"><link rel="prefetch" href="/blog/assets/js/page-Git介绍.82a25571.js"><link rel="prefetch" href="/blog/assets/js/page-Git分支管理.4f9c0210.js"><link rel="prefetch" href="/blog/assets/js/page-Git创建仓库.cabea66e.js"><link rel="prefetch" href="/blog/assets/js/page-Git基本操作.4e1f4734.js"><link rel="prefetch" href="/blog/assets/js/page-Git安装.cf6d44b4.js"><link rel="prefetch" href="/blog/assets/js/page-Git工作区、暂存区和版本库.5d561956.js"><link rel="prefetch" href="/blog/assets/js/page-Git工作流程.d2b8995f.js"><link rel="prefetch" href="/blog/assets/js/page-Git服务器搭建.7f6986af.js"><link rel="prefetch" href="/blog/assets/js/page-Git查看提交历史.40ff21ea.js"><link rel="prefetch" href="/blog/assets/js/page-Git标签.8f2c2cb6.js"><link rel="prefetch" href="/blog/assets/js/page-Git笔记.5e6ddcdf.js"><link rel="prefetch" href="/blog/assets/js/page-Git远程仓库（GitHub）.c8505cba.js"><link rel="prefetch" href="/blog/assets/js/page-Git配置.f141007c.js"><link rel="prefetch" href="/blog/assets/js/page-IT基础.e088bf26.js"><link rel="prefetch" href="/blog/assets/js/page-LAMP和LNMP环境搭建.adf92a39.js"><link rel="prefetch" href="/blog/assets/js/page-Markdown语法.76ecc03f.js"><link rel="prefetch" href="/blog/assets/js/page-SELinux管理.4075242b.js"><link rel="prefetch" href="/blog/assets/js/page-SFTP笔记.cdcf4d77.js"><link rel="prefetch" href="/blog/assets/js/page-Shell函数.775b51bc.js"><link rel="prefetch" href="/blog/assets/js/page-Shell变量.cda63b20.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对文件的操作---sed命令.cd166768.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对文本的搜索---grep命令.6083e37d.js"><link rel="prefetch" href="/blog/assets/js/page-Shell对输出流的处理---awk命令.0d48e00c.js"><link rel="prefetch" href="/blog/assets/js/page-Shell数组.4b8667ee.js"><link rel="prefetch" href="/blog/assets/js/page-Shell格式化输入.bf1e7958.js"><link rel="prefetch" href="/blog/assets/js/page-Shell格式化输出.6607e3e6.js"><link rel="prefetch" href="/blog/assets/js/page-Shell正则表达式.ebfdf1ff.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---case分支语句.332bd80e.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---for循环语句.de1b1b0b.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---if判断语句.b0532849.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---until循环语句.e7c9c7f3.js"><link rel="prefetch" href="/blog/assets/js/page-Shell流程控制---while循环语句.09fcf551.js"><link rel="prefetch" href="/blog/assets/js/page-Shell监控脚本.214dbdf6.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本---lamp环境安装.02e925e4.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本介绍.a9743a4a.js"><link rel="prefetch" href="/blog/assets/js/page-Shell脚本笔记.333fc9cf.js"><link rel="prefetch" href="/blog/assets/js/page-Shell语法.af36ce2b.js"><link rel="prefetch" href="/blog/assets/js/page-Shell运算.2f6e1b67.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Application对象.dc3d863e.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Range对象.aff14b9e.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Shape、Chart对象.c8437d84.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Sheet对象.40acafa7.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之Workbook对象.4b6ac3e5.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之使用对话框.32011bcc.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之函数的使用.60f6a8be.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体1.b004969b.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体2.0ca5f6c7.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之控件与用户窗体3.d9a20920.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之文件操作.5f150c21.js"><link rel="prefetch" href="/blog/assets/js/page-VBA之菜单和工具栏.ec98d91f.js"><link rel="prefetch" href="/blog/assets/js/page-linux介绍.eae8610d.js"><link rel="prefetch" href="/blog/assets/js/page-linux关机和重启命令.13f93679.js"><link rel="prefetch" href="/blog/assets/js/page-linux其他权限管理命令.cedaf338.js"><link rel="prefetch" href="/blog/assets/js/page-linux压缩、解压缩命令.6908caa3.js"><link rel="prefetch" href="/blog/assets/js/page-linux基本操作命令.e8f72eb0.js"><link rel="prefetch" href="/blog/assets/js/page-linux大杂烩.9f8cdc5c.js"><link rel="prefetch" href="/blog/assets/js/page-linux帮助命令.4fdeff8c.js"><link rel="prefetch" href="/blog/assets/js/page-linux常用网络命令.8169fd78.js"><link rel="prefetch" href="/blog/assets/js/page-linux搜索命令.8d223c34.js"><link rel="prefetch" href="/blog/assets/js/page-linux数据备份与恢复.f202f4a1.js"><link rel="prefetch" href="/blog/assets/js/page-linux文件系统管理.859d9e24.js"><link rel="prefetch" href="/blog/assets/js/page-linux文件系统结构.a7348129.js"><link rel="prefetch" href="/blog/assets/js/page-linux文本编辑器.fa0a4df9.js"><link rel="prefetch" href="/blog/assets/js/page-linux权限管理命令.be5e8ebf.js"><link rel="prefetch" href="/blog/assets/js/page-linux用户和用户组管理.4079bdf7.js"><link rel="prefetch" href="/blog/assets/js/page-linux的管理建议.82f61a78.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统启动管理.96ebf1d7.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统工作管理.3c407e77.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统日志管理.72ca77b7.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统服务管理.46ae7426.js"><link rel="prefetch" href="/blog/assets/js/page-linux系统进程管理.d56234ab.js"><link rel="prefetch" href="/blog/assets/js/page-linux软件安装.cc84e331.js"><link rel="prefetch" href="/blog/assets/js/page-linux高级文件系统管理.9e3c9bf6.js"><link rel="prefetch" href="/blog/assets/js/page-【MSG1500】刷机.c9407606.js"><link rel="prefetch" href="/blog/assets/js/page-【OpenWRT】固件编译.0ef4cd6f.js"><link rel="prefetch" href="/blog/assets/js/page-【Padavan】固件编译.d2a97584.js"><link rel="prefetch" href="/blog/assets/js/page-【RM2100】刷机救转.c6946098.js"><link rel="prefetch" href="/blog/assets/js/page-【VuePress】博客搭建.11c20d91.js"><link rel="prefetch" href="/blog/assets/js/page-【bootimg】解包打包.9ffb0b1e.js"><link rel="prefetch" href="/blog/assets/js/page-【openwrt】编译F大N1固件.49fa444e.js"><link rel="prefetch" href="/blog/assets/js/page-【squashfs】解包打包.58587e3c.js"><link rel="prefetch" href="/blog/assets/js/page-【小娱C1C5】刷机.4e341876.js"><link rel="prefetch" href="/blog/assets/js/page-【小娱C1C5】改造计划.ce3479e5.js"><link rel="prefetch" href="/blog/assets/js/page-【斐讯N1】Armbian.3bec83f3.js"><link rel="prefetch" href="/blog/assets/js/page-【斐讯N1】开机第一屏logo替换.57e2b6fa.js"><link rel="prefetch" href="/blog/assets/js/page-【贝壳云】改造计划.89b5027b.js"><link rel="prefetch" href="/blog/assets/js/page-【魔百合Q5】改造计划.510447e8.js"><link rel="prefetch" href="/blog/assets/js/page-个人信息.60959644.js"><link rel="prefetch" href="/blog/assets/js/page-主要功能与配置演示.90c45f63.js"><link rel="prefetch" href="/blog/assets/js/page-使用Dockerfile创建镜像.39abbd05.js"><link rel="prefetch" href="/blog/assets/js/page-使用Docker镜像.f46cc3e5.js"><link rel="prefetch" href="/blog/assets/js/page-初识Docker与容器.03017897.js"><link rel="prefetch" href="/blog/assets/js/page-博客主页.ee0b8fe8.js"><link rel="prefetch" href="/blog/assets/js/page-常用网站.40b6c65e.js"><link rel="prefetch" href="/blog/assets/js/page-幻灯片页.d2d94e64.js"><link rel="prefetch" href="/blog/assets/js/page-操作Docker容器.fca5b876.js"><link rel="prefetch" href="/blog/assets/js/page-核心概念与安装配置.bf9114e2.js"><link rel="prefetch" href="/blog/assets/js/page-瞎折腾.1dfcca6f.js"><link rel="prefetch" href="/blog/assets/js/page-端口映射与容器互联.44a4b5aa.js"><link rel="prefetch" href="/blog/assets/js/page-虚拟化的发展.7ac33b9a.js"><link rel="prefetch" href="/blog/assets/js/page-访问Docker仓库.71b3e000.js"><link rel="prefetch" href="/blog/assets/js/page-项目主页.24aa2c8e.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.eb5798cd.js"><link rel="prefetch" href="/blog/assets/js/vendors~mermaid.f1e52241.js"><link rel="prefetch" href="/blog/assets/js/vendors~photo-swipe.46d64c2d.js"><link rel="prefetch" href="/blog/assets/js/vendors~reveal.3f88bab1.js"><link rel="prefetch" href="/blog/assets/js/vendors~waline.8e39946b.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5649bb21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="KARIN" class="logo"> <!----> <span class="site-name can-hide">KARIN</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">主题色:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">主题模式:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  博客主页
</a></div><div class="nav-item"><a href="/blog/project/" class="nav-link router-link-active active"><i class="iconfont icon-folder"></i>
  项目总览
</a></div><div class="nav-item"><a href="/blog/IT/" class="nav-link"><i class="iconfont icon-blog"></i>
  知识要点
</a></div><div class="nav-item"><a href="/blog/operate/" class="nav-link"><i class="iconfont icon-operate"></i>
  捣鼓折腾
</a></div></nav> <!----> <a rel="noopener noreferrer" href="https://github.com/Ryukarin/blog" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="/blog/logo.png" class="avatar round"> <div property="name" class="name">karin</div> <meta property="url" content="/blog/intro/"></div> <div class="num-wrapper"><div><div class="num">106</div> <div>文章</div></div> <div><div class="num">14</div> <div>分类</div></div> <div><div class="num">18</div> <div>标签</div></div> <div><div class="num">105</div> <div>时间轴</div></div></div> <div class="media-links-wrapper"><a href="https://gitee.com/ryuukarin" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a><a href="https://github.com/Ryukarin" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  博客主页
</a></div><div class="nav-item"><a href="/blog/project/" class="nav-link router-link-active active"><i class="iconfont icon-folder"></i>
  项目总览
</a></div><div class="nav-item"><a href="/blog/IT/" class="nav-link"><i class="iconfont icon-blog"></i>
  知识要点
</a></div><div class="nav-item"><a href="/blog/operate/" class="nav-link"><i class="iconfont icon-operate"></i>
  捣鼓折腾
</a></div> <a rel="noopener noreferrer" href="https://github.com/Ryukarin/blog" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/blog/" aria-current="page" class="sidebar-link"><i class="iconfont icon-home"></i>博客主页</a></li><li><a href="/blog/project/" aria-current="page" class="sidebar-link"><i class="iconfont icon-folder"></i>项目主页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-blog"></i> <span class="title">知识要点</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-operate"></i> <span class="title">捣鼓折腾</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-linux"></i> <span class="title">Linux基础知识</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-linux"></i> <span class="title">Linux系统管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable open"><i class="iconfont icon-linux"></i> <span class="title">Linux大杂烩</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/project/Linux_mix/" aria-current="page" class="sidebar-link">linux大杂烩</a></li><li><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/" aria-current="page" class="active sidebar-link">linux三剑客</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#grep-命令" class="sidebar-link">grep 命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#基本用法" class="sidebar-link heading3">基本用法</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#egrep-或-grep-e" class="sidebar-link heading3">egrep 或 grep -E</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#fgrep-或-grep-f" class="sidebar-link heading3">fgrep 或 grep -F</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-命令" class="sidebar-link">sed 命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-脚本命令" class="sidebar-link heading3">sed 脚本命令</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-脚本命令的寻址方式" class="sidebar-link heading3">sed 脚本命令的寻址方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-命令" class="sidebar-link">awk 命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-基本用法" class="sidebar-link heading3">awk 基本用法</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-高级用法" class="sidebar-link heading3">awk 高级用法</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用数组" class="sidebar-link heading3">awk 使用数组</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用分支结构" class="sidebar-link heading3">awk 使用分支结构</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用循环结构" class="sidebar-link heading3">awk 使用循环结构</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-循环控制" class="sidebar-link heading3">awk 循环控制</a></li><li class="sidebar-sub-header"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用函数" class="sidebar-link heading3">awk 使用函数</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-shell"></i> <span class="title">Shell笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-geometry"></i> <span class="title">Docker笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-git"></i> <span class="title">Git笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-note"></i> <span class="title">Excel修炼秘籍</span> <span class="arrow right"></span></p> <!----></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav display="true" class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/blog/project/" property="item" typeof="WebPage" class="router-link-active"><i class="iconfont icon-folder"></i> <span property="name">项目主页</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/blog/project/Linux_mix/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">linux大杂烩</span></a> <meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">linux三剑客</span></a> <meta property="position" content="3"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">linux三剑客</span></h1> <div class="page-info"><!----> <span aria-label="作者🖊" data-balloon-pos="down" categoryPath="/category/$category/" tagPath="/tag/$tag/"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">karin</span></span><span aria-label="访问量🔢" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 0 0-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/blog/project/Linux_mix/Linux_sed_grep_awk/" data-flag-title="linux三剑客" class="leancloud_visitors waline-visitor-count"><span class="leancloud-visitors-count">...</span></span></span><span aria-label="写作日期📅" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-04-09 </span></span><!----><span aria-label="标签🏷" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">Linux</span></li></ul> <meta property="keywords" content="Linux"></span><span aria-label="阅读时间⌛" data-balloon-pos="down" defaultAuthor="karin" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>大约 43 分钟</span> <meta property="timeRequired" content="PT43M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#grep-命令" class="anchor-link heading2"><div>grep 命令</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#基本用法" class="anchor-link heading3"><div>基本用法</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#egrep-或-grep-e" class="anchor-link heading3"><div>egrep 或 grep -E</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#fgrep-或-grep-f" class="anchor-link heading3"><div>fgrep 或 grep -F</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-命令" class="anchor-link heading2"><div>sed 命令</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-脚本命令" class="anchor-link heading3"><div>sed 脚本命令</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#sed-脚本命令的寻址方式" class="anchor-link heading3"><div>sed 脚本命令的寻址方式</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-命令" class="anchor-link heading2"><div>awk 命令</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-基本用法" class="anchor-link heading3"><div>awk 基本用法</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-高级用法" class="anchor-link heading3"><div>awk 高级用法</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用数组" class="anchor-link heading3"><div>awk 使用数组</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用分支结构" class="anchor-link heading3"><div>awk 使用分支结构</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用循环结构" class="anchor-link heading3"><div>awk 使用循环结构</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-循环控制" class="anchor-link heading3"><div>awk 循环控制</div></a></li><li class="anchor"><a href="/blog/project/Linux_mix/Linux_sed_grep_awk/#awk-使用函数" class="anchor-link heading3"><div>awk 使用函数</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="grep-命令"><a href="#grep-命令" class="header-anchor">#</a> grep 命令</h2> <p>很多时候，我们并不需要列出文件的全部内容，而是从文件中找到包含指定信息的那些行，要实现这个目的，可以使用 <code>grep</code> 命令。</p> <p><code>grep</code> 命令作为 Linux 文本处理三剑客的一员，另外两个是 <code>sed</code> 和 <code>awk</code>。</p> <p><code>grep</code> 命令的由来可以追溯到 UNIX 诞生的早期，在 UNIX 系统中，<u>搜索的模式（patterns）被称为正则表达式（regular  expressions）</u>，为了要彻底搜索一个文件，有的用户在要搜索的字符串前加上前缀  global（全面的），一旦找到相匹配的内容，用户就像将其输出（print）到屏幕上，而将这一系列的操作整合到一起就是 global  regular expressions print，而这也就是 <code>grep</code> 命令的全称。</p> <p><code>grep</code>命令能够在一个或多个文件中，搜索某一特定的字符模式（也就是正则表达式），此模式可以是单一的字符、字符串、单词或句子。</p> <p>正则表达式是描述一组字符串的一个模式，正则表达式的构成模仿了数学表达式，通过使用操作符将较小的表达式组合成一个新的表达式。正则表达式可以是一些纯文本文字，也可以是用来产生模式的一些特殊字符。为了进一步定义一个搜索模式，<code>grep</code> 命令支持如表1 所示的这几种正则表达式的元字符（也就是通配符）。</p> <p><strong>表1	<u>正则表达式通配符</u></strong></p> <table><thead><tr><th>通配符</th> <th>功能</th></tr></thead> <tbody><tr><td>*</td> <td>匹配前面的子表达式 0 次或多次。</td></tr> <tr><td>?</td> <td>匹配前面的子表达式 0 次或 1 次。</td></tr> <tr><td>+</td> <td>匹配前面的子表达式 1 次或多次。</td></tr> <tr><td>.</td> <td>将匹配任何一个字符，且只能是一个字符。</td></tr> <tr><td>[a-z]</td> <td>匹配方括号中的任意一个字符。</td></tr> <tr><td>[^xyz]</td> <td>匹配除方括号中字符外的所有字符。</td></tr> <tr><td>|</td> <td>指明两项之间的一个选择。</td></tr> <tr><td>{n}</td> <td>n 是一个非负整数。匹配确定的 n 次。</td></tr> <tr><td>{n,}</td> <td>n 是一个非负整数。至少匹配 n 次。</td></tr> <tr><td>{n,m}</td> <td>m 和 n 均为非负整数，其中 n &lt;= m。最少匹配 n 次且最多匹配 m 次。</td></tr> <tr><td>^</td> <td>锁定行的开头。</td></tr> <tr><td>$</td> <td>锁定行的结尾。</td></tr> <tr><td>\</td> <td>转义字符。将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。</td></tr></tbody></table> <p>需要注意的是，在基本正则表达式中，如通配符 <strong>*、+、{、|、(</strong> 和 <strong>)</strong> 等，已经失去了它们原本的含义，而若要恢复它们原本的含义，则要在之前添加反斜杠 <strong>\</strong>，如 <strong>\*、\+、\{、\|、\(</strong> 和 <strong>\)</strong>。</p> <p><code>grep</code> 命令是用来在每一个文件中（或特定输出上）搜索特定的模式，当使用 <code>grep</code> 时，包含指定字符模式的每一行内容，都会被打印（显示）到屏幕上，但是使用 <code>grep</code> 命令并不改变文件中的内容。</p> <h3 id="基本用法"><a href="#基本用法" class="header-anchor">#</a> 基本用法</h3> <p><code>grep</code> 命令的基本格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep [选项] 模式 文件名</span>
选项：
	-c：仅列出文件中包含模式的行数
	-i：忽略模式中的字母大小写
	-l：列出带有匹配行的文件名
	-n：在每一行的最前面列出行号
	-v：列出没有匹配模式的行
	-w：把表达式当做一个完整的单字符来搜寻，忽略那些部分匹配的行

模式	：要么是字符（串），要么是正则表达式。

文件名	：即要搜索匹配的源文件或者标准输入，标准输入常用管道符 <span class="token operator">|</span> 连接 <span class="token function">grep</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">注意</p> <p>如果是搜索多个文件，<code>grep</code> 命令的搜索结果只显示文件中发现匹配模式的文件名；而如果搜索单个文件，<code>grep</code> 命令的结果将显示每一个包含匹配模式的行。</p></div> <p>例 1：假设有一份 <code>emp.data</code> 员工清单，现在要搜索此文件，找出职位为 CLERK 的所有员工，则执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 来自文件</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep CLERK emp.data</span>

<span class="token comment"># 来自标准输入</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat emp.data | grep CLERK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>而在此基础上，如果只想知道职位为 CLERK 的员工的人数，可以使用“-c”选项，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep -c CLERK emp.data</span>
<span class="token comment">#忽略输出内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>例 2：搜索 <code>emp.data</code> 文件，使用正则表达式找出以 78 开头的数据行，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep ^78 emp.data</span>
<span class="token comment">#忽略输出内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>grep</code> 命令的功能非常强大，通过利用它的不同选项以及变化万千的正则表达式，可以获取任何我们所需要的信息。本节所介绍的 grep  命令，只介绍了它的一部分基础知识，比如说，grep  命令可用的选项还有很多，且用法也五花八门，不过对于初学者来说，本节所介绍的内容已经足以应付多数 Linux 系统的日常工作了。</p> <p>例 3：将 <code>/etc/passwd</code> 文件中，没有出现 root 和 nologin 的行打印出来，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/passwd | grep -v root | grep -v nologin</span>
<span class="token comment">#忽略输出内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="egrep-或-grep-e"><a href="#egrep-或-grep-e" class="header-anchor">#</a> egrep 或 grep -E</h3> <p>使用 <code>egrep</code> 的主要好处是增加了额外的正则表达式元字符集。</p> <p>打印所有包含 NW 或 EA 的行。如果不是使用 <code>egrep</code>，而是 <code>grep</code>，将不会有结果查出。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># egrep 'NW|EA' testfile     </span>
northwest       NW      Charles Main        <span class="token number">3.0</span>     .98     <span class="token number">3</span>       <span class="token number">34</span>
eastern         EA      TB Savage           <span class="token number">4.4</span>     .84     <span class="token number">5</span>       <span class="token number">20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>对于标准 <code>grep</code>，如果在扩展元字符前面加 \，grep 会自动启用扩展选项 -E。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep 'NW\|EA' testfile</span>
northwest       NW      Charles Main        <span class="token number">3.0</span>     .98     <span class="token number">3</span>       <span class="token number">34</span>
eastern         EA      TB Savage           <span class="token number">4.4</span>     .84     <span class="token number">5</span>       <span class="token number">20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>搜索所有包含一个或多个 3 的行。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># egrep '3+' testfile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep -E '3+' testfile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep '3\+' testfile        </span>
<span class="token comment">#这3条命令将会</span>
northwest       NW      Charles Main          <span class="token number">3.0</span>     .98     <span class="token number">3</span>       <span class="token number">34</span>
western         WE      Sharon Gray           <span class="token number">5.3</span>     .97     <span class="token number">5</span>       <span class="token number">23</span>
northeast       NE      AM Main Jr.           <span class="token number">5.1</span>     .94     <span class="token number">3</span>       <span class="token number">13</span>
central         CT      Ann Stephens          <span class="token number">5.7</span>     .94     <span class="token number">5</span>       <span class="token number">13</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>搜索所有包含 0 个或 1 个小数点字符的行。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># egrep '2\.?[0-9]' testfile </span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep -E '2\.?[0-9]' testfile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep '2\.\?[0-9]' testfile </span>
<span class="token comment">#首先含有2字符，其后紧跟着0个或1个点，后面再是0和9之间的数字。</span>
western         WE      Sharon Gray           <span class="token number">5.3</span>     .97     <span class="token number">5</span>       <span class="token number">23</span>
southwest       SW      Lewis Dalsass         <span class="token number">2.7</span>     .8      <span class="token number">2</span>       <span class="token number">18</span>
eastern         EA      TB Savage             <span class="token number">4.4</span>     .84     <span class="token number">5</span>       <span class="token number">20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>搜索一个或者多个连续的 no 的行。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># egrep '(no)+' testfile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep -E '(no)+' testfile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep '\(no\)\+' testfile</span>
<span class="token comment">#3个命令返回相同结果，</span>
northwest       NW      Charles Main        <span class="token number">3.0</span>     .98     <span class="token number">3</span>       <span class="token number">34</span>
northeast       NE       AM Main Jr.        <span class="token number">5.1</span>     .94     <span class="token number">3</span>       <span class="token number">13</span>
north           NO      Margot Weber        <span class="token number">4.5</span>     .89     <span class="token number">5</span>       <span class="token number">9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="fgrep-或-grep-f"><a href="#fgrep-或-grep-f" class="header-anchor">#</a> fgrep 或 grep -F</h3> <p><code>fgrep</code> 查询速度比 <code>grep</code> 命令快，但是不够灵活；它只能找固定的文本，而不是规则表达式。</p> <p>如果你想在一个文件或者输出中找到包含星号字符的行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># fgrep '*' /etc/profile</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> /etc/profile.d/*.sh <span class="token punctuation">;</span> <span class="token keyword">do</span>

或
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep -F '*' /etc/profile</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> /etc/profile.d/*.sh <span class="token punctuation">;</span> <span class="token keyword">do</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="sed-命令"><a href="#sed-命令" class="header-anchor">#</a> sed 命令</h2> <p>我们知道，Vim 采用的是交互式文本编辑模式，你可以用键盘命令来交互性地插入、删除或替换数据中的文本。</p> <p><code>sed</code> 命令，它采用的是流编辑模式，最明显的特点是，在 <code>sed</code> 处理数据之前，需要预先提供一组规则，<code>sed</code> 会按照此规则来编辑数据。</p> <p><code>sed</code> 会根据脚本命令来处理文本文件中的数据，这些命令要么从命令行中输入，要么存储在一个文本文件中，此命令执行数据的顺序如下：</p> <ol><li>每次仅读取一行内容；</li> <li>根据提供的规则命令匹配并修改数据。注意，<code>sed</code> 默认不会直接修改源文件数据，而是会将数据复制到缓冲区中，修改也仅限于缓冲区中的数据；</li> <li>将执行结果输出。</li></ol> <p>当一行数据匹配完成后，它会继续读取下一行数据，并重复这个过程，直到将文件中所有数据处理完毕。</p> <p><code>sed</code> 命令的基本格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed [选项] '[脚本命令]' 文件名</span>
选项：
	-e 脚本命令		：该选项会将其后跟的脚本命令添加到已有的命令中
	-f 脚本命令文件	：该选项会将其后文件中的脚本命令添加到已有的命令中
	-n				：默认情况下，sed 会在所有的脚本指定执行完毕后，会自动输出处理后的内容，而该选项会屏蔽启动输出，需使用 print 命令来完成输出
	-i				：此选项会直接修改源文件，要慎用
	
脚本命令：
	s	：查找替换
	d	：删除定位行
	a<span class="token punctuation">\</span>	：在当前行下面插入文本
	i<span class="token punctuation">\</span>	：在当前行上面插入文本
	c<span class="token punctuation">\</span>	：用新文本替换定位文本
	y	：转换（表示把一个字符翻译为另外的字符）
	p	：打印（和-n选项一起合用，打印匹配行）
	w	：把文本写到一个文件，类似输出重定向 <span class="token operator">&gt;</span>
	r	：从另一个文件中读文本，类似输入重定向 <span class="token operator">&lt;</span>
	q	：第一个模式匹配完成后退出或立即退出
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>成功使用 <code>sed</code> 命令的关键在于掌握各式各样的脚本命令及格式，它能帮你定制编辑文件的规则。</p> <h3 id="sed-脚本命令"><a href="#sed-脚本命令" class="header-anchor">#</a> sed 脚本命令</h3> <h4 id="sed-s-替换脚本命令"><a href="#sed-s-替换脚本命令" class="header-anchor">#</a> sed s 替换脚本命令</h4> <p>此命令的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>s/pattern/replacement/flags

address：表示指定要操作的具体行
pattern：指的是需要替换的内容
replacement：指的是要替换的新内容
flags：
	n		：1~512 之间的数字，表示指定要替换的字符串出现第几次时才进行替换，例如，一行中有 <span class="token number">3</span> 个 A，但用户只想替换第二个 A，这是就用到这个标记
	g		：对数据中所有匹配到的内容进行替换，如果没有 g，则只会在第一次匹配成功时做替换操作。例如，一行数据中有 <span class="token number">3</span> 个 A，则只会替换第一个 A
	p		：会打印与替换命令中指定的模式匹配的行。此标记通常与 -n 选项一起使用
	w <span class="token function">file</span>	：将缓冲区中的内容写到指定的 <span class="token function">file</span> 文件中（相当于另存为）
	<span class="token operator">&amp;</span>		：用正则表达式匹配的内容进行替换
	<span class="token punctuation">\</span>n		：匹配第 n 个子串，该子串之前在 pattern 中用 <span class="token punctuation">\</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">)</span> 指定
	<span class="token punctuation">\</span>		：转义（转义替换部分包含：<span class="token operator">&amp;</span>、<span class="token punctuation">\</span> 等）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>比如，可以指定 <code>sed</code> 用新文本替换第几处模式匹配的地方：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data1.txt</span>
This is a <span class="token builtin class-name">test</span> of the <span class="token builtin class-name">test</span> script.
This is the second <span class="token builtin class-name">test</span> of the <span class="token builtin class-name">test</span> script.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 's/test/trial/2' data1.txt</span>
This is a <span class="token builtin class-name">test</span> of the trial script.
This is the second <span class="token builtin class-name">test</span> of the trial script.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>可以看到，使用数字 2 作为标记的结果就是，<code>sed</code> 编辑器只替换每行中第 2 次出现的匹配模式。</p> <p>如果要用新文件替换所有匹配的字符串，可以使用 g 标记：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 's/test/trial/g' data1.txt</span>
This is a trial of the trial script.
This is the second trial of the trial script.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们知道，-n 选项会禁止 <code>sed</code> 输出，但 p 标记会输出修改过的行，将二者匹配使用的效果就是只输出被替换命令修改过的行，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data2.txt</span>
This is a <span class="token builtin class-name">test</span> line.
This is a different line.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed -n 's/test/trial/p' data2.txt</span>
This is a trial line.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>w 标记会将匹配后的结果保存到指定文件中，比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 's/test/trial/w test.txt' data2.txt</span>
This is a trial line.
This is a different line.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">#cat test.txt</span>
This is a trial line.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在使用 s 脚本命令时，替换类似文件路径的字符串会比较麻烦，需要将路径中的正斜线进行转义，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 's/\/bin\/bash/\/bin\/csh/' /etc/passwd</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sed-d-替换脚本命令"><a href="#sed-d-替换脚本命令" class="header-anchor">#</a> sed d 替换脚本命令</h4> <p>此命令的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果需要删除文本中的特定行，可以用 d 脚本命令，它会删除指定行中的所有内容。但使用该命令时要特别小心，如果你忘记指定具体行的话，文件中的所有内容都会被删除，举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data3.txt</span>
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy dog
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 'd' data3.txt</span>
<span class="token comment">#什么也不输出，证明成了空文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>当和指定地址一起使用时，删除命令显然能发挥出大的功用。可以从数据流中删除特定的文本行。</p> <p>address 的具体写法后续会做详细介绍，这里只给大家举几个简单的例子：</p> <ul><li><p>通过行号指定，比如删除 data6.txt 文件内容中的第 3 行：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data4.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3d' data4.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>或者通过特定行区间指定，比如删除 data6.txt 文件内容中的第 2、3行：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '2,3d' data4.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>也可以使用两个文本模式来删除某个区间内的行，但这么做时要小心，你指定的第一个模式会“打开”行删除功能，第二个模式会“关闭”行删除功能，因此，<code>sed</code> 会删除两个指定行之间的所有行（包括指定的行），例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">#sed '/1/,/3/d' data4.txt</span>
<span class="token comment">#删除第 1~3 行的文本数据</span>
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>或者通过特殊的文件结尾字符，比如删除 data4.txt 文件内容中第 3 行开始的所有的内容：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3,$d' data4.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <p>在此强调，在默认情况下 <code>sed</code> 并不会修改原始文件，这里被删除的行只是从 <code>sed</code> 的输出中消失了，原始文件没做任何改变。</p> <h4 id="sed-a-和-i-脚本命令"><a href="#sed-a-和-i-脚本命令" class="header-anchor">#</a> sed a\ 和 i\ 脚本命令</h4> <p>a\ 命令表示在指定行的后面附加一行，i\ 命令表示在指定行的前面插入一行，这里之所以要同时介绍这 2 个脚本命令，因为它们的基本格式完全相同，如下所示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>a（或i）<span class="token punctuation">\</span>新文本内容
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面分别就这 2 个命令，举几个例子。比如说，将一个新行插入到数据流第三行前，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3i\</span>
<span class="token operator">&gt;</span> This is an inserted line.' data4.txt
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is an inserted line.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>再比如说，将一个新行附加到数据流中第三行后，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3a\</span>
<span class="token operator">&gt;</span> This is an appended line.' data4.txt
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is an appended line.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果你想将一个多行数据添加到数据流中，只需对要插入或附加的文本中的每一行末尾（除最后一行）添加反斜线即可，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '1i\</span>
<span class="token operator">&gt;</span> This is one line of new text.<span class="token punctuation">\</span>
<span class="token operator">&gt;</span> This is another line of new text.' data6.txt
This is one line of new text.
This is another line of new text.
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>可以看到，指定的两行都会被添加到数据流中。</p> <h4 id="sed-c-替换脚本命令"><a href="#sed-c-替换脚本命令" class="header-anchor">#</a> sed c\ 替换脚本命令</h4> <p>c\ 命令表示将指定行中的所有内容，替换成该选项后面的字符串。该命令的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>c<span class="token punctuation">\</span>用于替换的新文本
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3c\</span>
<span class="token operator">&gt;</span> This is a changed line of text.<span class="token string">' data4.txt
This is line number 1.
This is line number 2.
This is a changed line of text.
This is line number 4.
在这个例子中，sed 编辑器会修改第三行中的文本，其实，下面的写法也可以实现此目的：
[root@localhost ~]# sed '</span>/number <span class="token number">3</span>/c<span class="token punctuation">\</span>
<span class="token operator">&gt;</span> This is a changed line of text.' data4.txt
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is a changed line of text.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="sed-y-转换脚本命令"><a href="#sed-y-转换脚本命令" class="header-anchor">#</a> sed y 转换脚本命令</h4> <p>y 转换命令是唯一可以处理单个字符的 <code>sed</code> 脚本命令，其基本格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>y/inchars/outchars/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>转换命令会对 inchars 和 outchars 值进行一对一的映射，即 inchars 中的第一个字符会被转换为 outchars  中的第一个字符，第二个字符会被转换成 outchars 中的第二个字符...这个映射过程会一直持续到处理完指定字符。如果 inchars 和 outchars 的长度不同，则 sed 会产生一条错误消息。</p> <p>举个简单例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data5.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
This is line number <span class="token number">1</span> again.
This is yet another line.
This is the last line <span class="token keyword">in</span> the file.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed 'y/123/789/' data5.txt</span>
This is line number <span class="token number">7</span>.
This is line number <span class="token number">8</span>.
This is line number <span class="token number">9</span>.
This is line number <span class="token number">4</span>.
This is line number <span class="token number">7</span> again.
This is yet another line.
This is the last line <span class="token keyword">in</span> the file.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>可以看到，inchars 模式中指定字符的每个实例都会被替换成 outchars 模式中相同位置的那个字符。</p> <p>转换命令是一个全局命令，也就是说，它会在文本行中找到的所有指定字符自动进行转换，而不会考虑它们出现的位置，再打个比方：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># echo &quot;This 1 is a test of 1 try.&quot; | sed 'y/123/456/'</span>
This <span class="token number">4</span> is a <span class="token builtin class-name">test</span> of <span class="token number">4</span> try.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>sed</code> 转换了在文本行中匹配到的字符 1 的两个实例，我们无法限定只转换在特定地方出现的字符。</p> <h4 id="sed-p-打印脚本命令"><a href="#sed-p-打印脚本命令" class="header-anchor">#</a> sed p 打印脚本命令</h4> <p>p 命令表示搜索符号条件的行，并输出该行的内容，此命令的基本格式为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[address]p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>p 命令常见的用法是打印包含匹配文本模式的行，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data6.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed -n '/number 3/p' data6.txt</span>
This is line number <span class="token number">3</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>可以看到，用 -n 选项和 p 命令配合使用，我们可以禁止输出其他行，只打印包含匹配文本模式的行。</p> <p>如果需要在修改之前查看行，也可以使用打印命令，比如与替换或修改命令一起使用。可以创建一个脚本在修改行之前显示该行，如下所示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed -n '/3/{</span>
<span class="token operator">&gt;</span> p
<span class="token operator">&gt;</span> s/line/test/p
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>' data6.txt
This is line number <span class="token number">3</span>.
This is <span class="token builtin class-name">test</span> number <span class="token number">3</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>sed</code> 命令会查找包含数字 3 的行，然后执行两条命令。首先，脚本用 p 命令来打印出原始行；然后它用 s 命令替换文本，并用 p 标记打印出替换结果。输出同时显示了原来的行文本和新的行文本。</p> <h4 id="sed-w-脚本命令"><a href="#sed-w-脚本命令" class="header-anchor">#</a> sed w 脚本命令</h4> <p>w 命令用来将文本中指定行的内容写入文件中，此命令的基本格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>w filename
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里的 filename 表示文件名，可以使用相对路径或绝对路径，但不管是哪种，运行 <code>sed</code> 命令的用户都必须有文件的写权限。</p> <p>下面的例子是将数据流中的前两行打印到一个文本文件中：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '1,2w test.txt' data6.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat test.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当然，如果不想让行直接输出，可以用 -n 选项，再举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data7.txt</span>
Blum, R    Browncoat
McGuiness, A Alliance
Bresnahan, C Browncoat
Harken, C   Alliance
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed -n '/Browncoat/w Browncoats.txt' data7.txt</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat Browncoats.txt</span>
Blum, R    Browncoat
Bresnahan, C Browncoat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>可以看到，通过使用 w 脚本命令，<code>sed</code> 可以实现将包含文本模式的数据行写入目标文件。</p> <h4 id="sed-r-脚本命令"><a href="#sed-r-脚本命令" class="header-anchor">#</a> sed r 脚本命令</h4> <p>r 命令用于将一个独立文件的数据插入到当前数据流的指定位置，该命令的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>r filename
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>sed</code> 命令会将 filename 文件中的内容插入到 address 指定行的后面，比如说：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data8.txt</span>
This is an added line.
This is the second added line.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '3r data8.txt' data6.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is an added line.
This is the second added line.
This is line number <span class="token number">4</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果你想将指定文件中的数据插入到数据流的末尾，可以使用 $ 地址符，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '$r data8.txt' data6.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
This is line number <span class="token number">3</span>.
This is line number <span class="token number">4</span>.
This is an added line.
This is the second added line.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="sed-q-退出脚本命令"><a href="#sed-q-退出脚本命令" class="header-anchor">#</a> sed q 退出脚本命令</h4> <p>q 命令的作用是使 <code>sed</code> 命令在第一次匹配任务结束后，退出 <code>sed</code> 程序，不再进行对后续数据的处理。</p> <p>比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '2q' test.txt</span>
This is line number <span class="token number">1</span>.
This is line number <span class="token number">2</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以看到，<code>sed</code> 命令在打印输出第 2 行之后，就停止了，是 q 命令造成的，再比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '/number 1/{ s/number 1/number 0/;q; }' test.txt</span>
This is line number <span class="token number">0</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用 q 命令之后，<code>sed</code> 命令会在匹配到 number 1 时，将其替换成 number 0，然后直接退出。</p> <h3 id="sed-脚本命令的寻址方式"><a href="#sed-脚本命令的寻址方式" class="header-anchor">#</a> sed 脚本命令的寻址方式</h3> <p>前面在介绍各个脚本命令时，我们一直忽略了对 address 部分的介绍。对各个脚本命令来说，address 用来表明该脚本命令作用到文本中的具体行。</p> <p>默认情况下，<code>sed</code> 命令会作用于文本数据的所有行。如果只想将命令作用于特定行或某些行，则必须写明 address 部分，表示的方法有以下 2 种：</p> <ol><li>以数字形式指定行区间；</li> <li>用文本模式指定具体行区间。</li></ol> <p>以上两种形式都可以使用如下这 2 种格式，分别是：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>address<span class="token punctuation">]</span>脚本命令

 或者

 address <span class="token punctuation">{</span>
   多个脚本命令
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>以上两种形式在前面例子中都有具体实例，因此这里不再做过多赘述。</p> <h4 id="以数字形式指定行区间"><a href="#以数字形式指定行区间" class="header-anchor">#</a> 以数字形式指定行区间</h4> <p>当使用数字方式的行寻址时，可以用行在文本流中的行位置来引用。<code>sed</code> 会将文本流中的第一行编号为 1，然后继续按顺序为接下来的行分配行号。</p> <p>在脚本命令中，指定的地址可以是单个行号，或是用起始行号、逗号以及结尾行号指定的一定区间范围内的行。这里举一个 <code>sed</code> 命令作用到指定行号的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">#sed '2s/dog/cat/' data9.txt</span>
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy <span class="token function">cat</span>
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy dog
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以看到，<code>sed</code> 只修改地址指定的第二行的文本。下面的例子中使用了行地址区间：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '2,3s/dog/cat/' data9.txt</span>
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy <span class="token function">cat</span>
The quick brown fox jumps over the lazy <span class="token function">cat</span>
The quick brown fox jumps over the lazy dog
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在此基础上，如果想将命令作用到文本中从某行开始的所有行，可以用特殊地址---美元符（$）：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '2,$s/dog/cat/' data9.txt</span>
The quick brown fox jumps over the lazy dog
The quick brown fox jumps over the lazy <span class="token function">cat</span>
The quick brown fox jumps over the lazy <span class="token function">cat</span>
The quick brown fox jumps over the lazy <span class="token function">cat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="用文本模式指定行区间"><a href="#用文本模式指定行区间" class="header-anchor">#</a> 用文本模式指定行区间</h4> <p><code>sed</code> 允许指定文本模式来过滤出命令要作用的行，格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/pattern/command
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意，必须用正斜线将要指定的 pattern 封起来，<code>sed</code> 会将该命令作用到包含指定文本模式的行上。</p> <p>举个例子，如果你想只修改用户 demo 的默认 shell，可以使用 <code>sed</code> 命令，执行命令如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grep demo /etc/passwd</span>
demo:x:502:502::/home/Samantha:/bin/bash
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed '/demo/s/bash/csh/' /etc/passwd</span>
root:x:0:0:root:/root:/bin/bash
<span class="token punctuation">..</span>.
demo:x:502:502::/home/demo:/bin/csh
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>虽然使用固定文本模式能帮你过滤出特定的值，就跟上面这个用户名的例子一样，但其作用难免有限，因此，<code>sed</code> 允许在文本模式使用正则表达式指明作用的具体行。正则表达式允许创建高级文本模式匹配表达式来匹配各种数据。这些表达式结合了一系列通配符、特殊字符以及固定文本字符来生成能够匹配几乎任何形式文本的简练模式。</p> <p>示例：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat test.txt</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>First Wed<span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
h1Helloh1
h2Helloh2
h3Helloh3
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
<span class="token comment">#使用正则表示式给所有第一个的h1、h2、h3添加&lt;&gt;，给第二个h1、h2、h3添加&lt;/&gt;</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat sed.sh</span>
/h<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>/<span class="token punctuation">{</span>
    s//<span class="token punctuation">\</span><span class="token operator">&lt;&amp;</span><span class="token punctuation">\</span><span class="token operator">&gt;</span>/1
    s//<span class="token punctuation">\</span><span class="token operator">&lt;</span><span class="token punctuation">\</span>/<span class="token operator">&amp;</span><span class="token punctuation">\</span><span class="token operator">&gt;</span>/2
<span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sed -f sed.sh test.txt</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Hello<span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>Hello<span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>Hello<span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="awk-命令"><a href="#awk-命令" class="header-anchor">#</a> awk 命令</h2> <p>除了使用 <code>sed</code> 命令，Linux 系统中还有一个功能更加强大的文本数据处理工具，就是 <code>awk</code>。它诞生于 20 世纪 70 年代末期，这也许是它影响了众多 Linux 用户的原因之一。</p> <p>曾有人推测 <code>awk</code> 命令的名字来源于 awkward 这个单词。其实不然，此命令的设计者有 3 位，他们的姓分别是 Aho、Weingberger 和 Kernighan，awk 就取自这 3 为大师姓的首字母。</p> <p>和 <code>sed</code> 命令类似，<code>awk</code> 命令也是逐行扫描文件（从第 1 行到最后一行），寻找含有目标文本的行，如果匹配成功，则会在该行上执行用户想要的操作；反之，则不对行做任何处理。</p> <p><code>awk</code> 命令的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk [选项] '[脚本命令]' 文件名</span>
选项：
	-F fs		：指定以 fs 作为输入行的分隔符，awk 命令默认分隔符为空格或制表符
	-f <span class="token function">file</span>		：从脚本文件中读取 <span class="token function">awk</span> 脚本指令，以取代直接在命令行中输入指令
	-v <span class="token assign-left variable">var</span><span class="token operator">=</span>val	：在执行处理过程之前，设置一个变量 var，并给其设备初始值为 val
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>awk</code> 的强大之处在于脚本命令，它由 2 部分组成，分别为匹配规则和执行命令，如下所示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token string">'匹配规则{执行命令}'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里的匹配规则，和 <code>sed</code> 命令中的 address 部分作用相同，用来指定脚本命令可以作用到文本内容中的具体行，可以使用字符串（比如  /demo/，表示查看含有 demo 字符串的行）或者正则表达式指定。另外需要注意的是，<strong>整个脚本命令是用单引号 '  ' 括起，而其中的执行命令部分需要用大括号 {  } 括起来</strong>。</p> <p>在 <code>awk</code> 程序执行时，如果没有指定执行命令，则默认会把匹配的行输出；如果不指定匹配规则，则默认匹配文本中所有的行。</p> <p>举个简单的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '/^$/ {print &quot;Blank line&quot;}' test.txt</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在此命令中，<code>/^$/</code> 是一个正则表达式，功能是匹配文本中的空白行，同时可以看到，执行命令使用的是 print 命令，此命令经常会使用，它的作用很简单，就是将指定的文本进行输出。因此，整个命令的功能是，如果 test.txt 有 N 个空白行，那么执行此命令会输出 N 个 Blank line。</p> <h3 id="awk-基本用法"><a href="#awk-基本用法" class="header-anchor">#</a> awk 基本用法</h3> <h4 id="awk-对字段的提取-列"><a href="#awk-对字段的提取-列" class="header-anchor">#</a> awk 对字段的提取（列）</h4> <p><code>awk</code> 的主要特性之一是其处理文本文件中数据的能力，它会自动给一行中的每个数据元素分配一个变量。</p> <p>默认情况下，<code>awk</code> 会将如下变量分配给它在文本行中发现的数据字段：</p> <ul><li>$0 代表整个文本行；</li> <li>$1 代表文本行中的第 1 个数据字段；</li> <li>$2 代表文本行中的第 2 个数据字段；</li> <li>$N 代表文本行中的第 N 个数据字段；</li> <li>$NF 代表文本行中的最后一个数据字段。</li></ul> <p>前面说过，在 <code>awk</code> 中，默认的字段分隔符是任意的空白字符（例如空格或制表符）。 在文本行中，每个数据字段都是通过字段分隔符划分的。<code>awk</code> 在读取一行文本时，会用预定义的字段分隔符划分每个数据字段。</p> <p>所以在下面的例子中，<code>awk</code> 程序读取文本文件，只显示第 1 个数据字段的值：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data2.txt</span>
One line of <span class="token builtin class-name">test</span> text.
Two lines of <span class="token builtin class-name">test</span> text.
Three lines of <span class="token builtin class-name">test</span> text.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{print $1}' data2.txt</span>
One
Two
Three
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>该程序用 $1 字段变量来表示“仅显示每行文本的第 1 个数据字段”。当然，如果你要读取采用了其他字段分隔符的文件，可以用 -F 选项手动指定。</p> <h4 id="awk-对记录的提取-行"><a href="#awk-对记录的提取-行" class="header-anchor">#</a> awk 对记录的提取（行）</h4> <p>提取一个文本中的一行并打印输出，记录的提取方法有两种：</p> <ul><li>通过行号</li> <li>通过正则匹配</li></ul> <p>例如：提取test中的第三行（指定行号为3）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@linux ~ <span class="token punctuation">]</span><span class="token comment"># awk 'NR==3{print $0}' test</span>
<span class="token number">3</span> the quick brown fox jumps over the lazy cat.
<span class="token punctuation">[</span>root@linux ~ <span class="token punctuation">]</span><span class="token comment"># awk 'NR==1{print $1,$3,$5}' /etc/passwd</span>
root <span class="token number">0</span> root
<span class="token punctuation">[</span>root@linux ~ <span class="token punctuation">]</span><span class="token comment"># awk 'NR==1{print $1 &quot;-&quot; $3 &quot;-&quot; $5}' /etc/passwd</span>
root-0-root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="awk-脚本命令使用多个命令"><a href="#awk-脚本命令使用多个命令" class="header-anchor">#</a> awk 脚本命令使用多个命令</h4> <p><code>awk</code> 允许将多条命令组合成一个正常的程序。要在命令行上的程序脚本中使用多条命令，只要在命令之间放个分号即可，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># echo &quot;My name is Rich&quot; | awk '{$4=&quot;Christine&quot;; print $0}'</span>
My name is Christine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第一条命令会给字段变量 $4 赋值。第二条命令会打印整个数据字段。可以看到，<code>awk</code> 程序在输出中已经将原文本中的第四个数据字段替换成了新值。</p> <p>除此之外，也可以一次一行地输入程序脚本命令，比如说：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> <span class="token variable">$4</span><span class="token operator">=</span><span class="token string">&quot;Christine&quot;</span>
<span class="token operator">&gt;</span> print <span class="token variable">$0</span><span class="token punctuation">}</span>'
My name is Rich
My name is Christine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在你用了表示起始的单引号后，bash shell 会使用 <code>&gt;</code> 来提示输入更多数据，我们可以每次在每行加一条命令，直到输入了结尾的单引号。</p> <p>注意，此例中因为没有在命令行中指定文件名，<code>awk</code> 程序需要用户输入获得数据，因此当运行这个程序的时候，它会一直等着用户输入文本，此时如果要退出程序，只需按下 <kbd>Ctrl</kbd>+<kbd>D</kbd> 组合键即可。</p> <h4 id="awk-从文件中读取程序"><a href="#awk-从文件中读取程序" class="header-anchor">#</a> awk 从文件中读取程序</h4> <p>跟 <code>sed</code> 一样，<code>awk</code> 允许将脚本命令存储到文件中，然后再在命令行中引用，比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat awk.sh</span>
<span class="token punctuation">{</span>print <span class="token variable">$1</span> <span class="token string">&quot;'s home directory is &quot;</span> <span class="token variable">$6</span><span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -F: -f awk.sh /etc/passwd</span>
root<span class="token string">'s home directory is /root
bin'</span>s home directory is /bin
daemon<span class="token string">'s home directory is /sbin
adm'</span>s home directory is /var/adm
lp<span class="token string">'s home directory is /var/spool/lpd
...
Christine'</span>s home directory is /home/Christine
Samantha<span class="token string">'s home directory is /home/Samantha
Timothy'</span>s home directory is /home/Timothy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>awk.sh 脚本文件会使用 print 命令打印 <code>/etc/passwd</code> 文件的主目录数据字段（字段变量 $6），以及 userid 数据字段（字段变量 $1）。注意，在程序文件中，也可以指定多条命令，只要一条命令放一行即可，之间不需要用分号。</p> <h4 id="awk-begin关键字"><a href="#awk-begin关键字" class="header-anchor">#</a> awk BEGIN关键字</h4> <p><code>awk</code> 中还可以指定脚本命令的运行时机。默认情况下，<code>awk</code> 会从输入中读取一行文本，然后针对该行的数据执行程序脚本，但有时可能需要在处理数据前运行一些脚本命令，这就需要使用 BEGIN 关键字。</p> <p>BEGIN 会强制 <code>awk</code> 在读取数据前执行该关键字后指定的脚本命令，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data3.txt</span>
Line <span class="token number">1</span>
Line <span class="token number">2</span>
Line <span class="token number">3</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN {print &quot;The data3 File Contents:&quot;}</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>print <span class="token variable">$0</span><span class="token punctuation">}</span>' data3.txt
The data3 File Contents:
Line <span class="token number">1</span>
Line <span class="token number">2</span>
Line <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>可以看到，这里的脚本命令中分为 2 部分，BEGIN 部分的脚本指令会在 awk 命令处理数据前运行，而真正用来处理数据的是第二段脚本命令。</p> <h4 id="awk-end关键字"><a href="#awk-end关键字" class="header-anchor">#</a> awk END关键字</h4> <p>和 BEGIN 关键字相对应，END 关键字允许我们指定一些脚本命令，<code>awk</code> 会在读完数据后执行它们，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN {print &quot;The data3 File Contents:&quot;}</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>print <span class="token variable">$0</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> END <span class="token punctuation">{</span>print <span class="token string">&quot;End of File&quot;</span><span class="token punctuation">}</span>' data3.txt
The data3 File Contents:
Line <span class="token number">1</span>
Line <span class="token number">2</span>
Line <span class="token number">3</span>
End of File
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>可以看到，当 <code>awk</code> 程序打印完文件内容后，才会执行 END 中的脚本命令。</p> <p>上面介绍了 awk 程序的基本用法，下面继续介绍更高级的用法。</p> <h3 id="awk-高级用法"><a href="#awk-高级用法" class="header-anchor">#</a> awk 高级用法</h3> <p>其实在 <code>awk</code> 脚本程序中，还支持使用一些编程语言，比如变量、数组、分支结构（if-then-else）、循环结构（while）、函数等，下面一一给大家介绍。</p> <h4 id="awk-使用变量"><a href="#awk-使用变量" class="header-anchor">#</a> awk 使用变量</h4> <p>在 <code>awk</code> 的脚本程序中，支持使用变量来存取值。<code>awk</code> 支持两种不同类型的变量：</p> <ul><li>内建变量：<code>awk</code> 本身就创建好，用户可以直接拿来用的变量，这些变量用来存放处理数据文件中的某些字段和记录的信息。</li> <li>自定义变量：<code>awk</code> 支持用户自己创建变量。</li></ul> <h4 id="内建变量"><a href="#内建变量" class="header-anchor">#</a> 内建变量</h4> <p><code>awk</code> 程序使用内建变量来引用程序数据里的一些特殊功能。常见的一些内建变量，包括上面介绍的数据字段变量（$0、$1、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2...</mn></mrow><annotation encoding="application/x-tex">2...</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2...</span></span></span></span>n）以及表2、表3 中所示的这些变量。</p> <p><strong>表2	<u>字段和记录分隔符变量</u></strong></p> <table><thead><tr><th>变量</th> <th>功能</th></tr></thead> <tbody><tr><td>FIELDWIDTHS</td> <td>由空格分隔的一列数字，定义了每个数据字段的确切宽度。</td></tr> <tr><td>FNR</td> <td>当前输入文档的记录编号，常在有多个输入文档时使用。</td></tr> <tr><td>NR</td> <td>输入流的当前记录编号。</td></tr> <tr><td>FS</td> <td>输入字段分隔符，默认为空格。</td></tr> <tr><td>RS</td> <td>输入记录分隔符，默认为换行符 \n。</td></tr> <tr><td>OFS</td> <td>输出字段分隔符，默认为空格。</td></tr> <tr><td>ORS</td> <td>输出记录分隔符，默认为换行符 \n。</td></tr></tbody></table> <p>在表2 中，变量 FS 和 OFS 定义了 <code>awk</code> 如何处理数据流中的数据字段。我们已经知道了如何使用变量 FS 来定义记录中的字段分隔符，变量 OFS 具备相同的功能，只不过是用在 print 命令的输出上，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data1</span>
data11,data12,data13,data14,data15
data21,data22,data23,data24,data25
data31,data32,data33,data34,data35
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{FS=&quot;,&quot;; OFS=&quot;-&quot;} {print $1,$2,$3}' data1</span>
data11-data12-data13
data21-data22-data23
data31-data32-data33
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{FS=&quot;,&quot;; OFS=&quot;--&quot;} {print $1,$2,$3}' data1</span>
data11--data12--data13
data21--data22--data23
data31--data32--data33
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>可以看到，print 命令会自动将 OFS 变量的值放置在输出中的每个字段间。通过设置 OFS 变量，可以在输出中使用任意字符串来分隔字段。</p> <p>FIELDWIDTHS 变量允许用户不依靠字段分隔符来读取记录。在一些应用程序中，数据并没有使用字段分隔符，而是被放置在了记录中的特定列，这种情况下，必须设定 FIELDWIDTHS 变量来匹配数据在记录中的位置。</p> <p>一旦设置了 FIELDWIDTH 变量，<code>awk</code> 就会忽略 FS 变量，并根据提供的字段宽度来计算字段，下面是个采用字段宽度而非字段分隔符的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data2</span>
<span class="token number">1005.3247596</span>.37
<span class="token number">115</span>-2.349194.00
05810.1298100.1
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{FIELDWIDTHS=&quot;3 5 2 5&quot;}{print $1,$2,$3,$4}' data2</span>
<span class="token number">100</span> <span class="token number">5.324</span> <span class="token number">75</span> <span class="token number">96.37</span>
<span class="token number">115</span> -2.34 <span class="token number">91</span> <span class="token number">94.00</span>
058 <span class="token number">10.12</span> <span class="token number">98</span> <span class="token number">100.1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>注意，一旦设定了 FIELDWIDTHS 变量的值，就不能再改变了，因此，这种方法并不适用于变长的字段。</p> <p>变量 RS 和 ORS 定义了 <code>awk</code> 程序如何处理数据流中的字段，默认情况下，awk 将 RS 和 ORS 设为换行符。默认的 RS  值表明，输入数据流中的每行新文本就是一条新纪录。  有时，你会在数据流中碰到占据多行的字段。典型的例子是包含地址和电话号码的数据，其中地址和电话号码各占一行，例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Riley Mullen
123 Main Street
Chicago, IL 60601
(312)555-1234
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果你用默认的 FS 和 RS 变量值来读取这组数据，<code>awk</code> 就会把每行作为一条单独的记录来读取，并将记录中的空格当作字段分隔符，这并不是用户想要的。</p> <p>要解决这个问题，只需把 FS 变量设置成换行符，这就表明数据流中的每行都是一个单独的字段，每行上的所有数据都属于同一个字段；与此同时，把 RS 变量设置成空字符串，然后在数据记录间留一个空白行，<code>awk</code> 会把每个空白行当作一个记录分隔符。例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data3</span>
Riley Mullen
<span class="token number">123</span> Main Street
Chicago, IL <span class="token number">60601</span>
<span class="token punctuation">(</span><span class="token number">312</span><span class="token punctuation">)</span><span class="token number">555</span>-1234

Frank Williams
<span class="token number">456</span> Oak Street
Indianapolis, IN <span class="token number">46201</span>
<span class="token punctuation">(</span><span class="token number">317</span><span class="token punctuation">)</span><span class="token number">555</span>-9876

Haley Snell
<span class="token number">4231</span> Elm Street
Detroit, MI <span class="token number">48201</span>
<span class="token punctuation">(</span><span class="token number">313</span><span class="token punctuation">)</span><span class="token number">555</span>-4938
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{FS=&quot;\n&quot;; RS=&quot;&quot;} {print $1,$4}' data3</span>
Riley Mullen <span class="token punctuation">(</span><span class="token number">312</span><span class="token punctuation">)</span><span class="token number">555</span>-1234
Frank Williams <span class="token punctuation">(</span><span class="token number">317</span><span class="token punctuation">)</span><span class="token number">555</span>-9876
Haley Snell <span class="token punctuation">(</span><span class="token number">313</span><span class="token punctuation">)</span><span class="token number">555</span>-4938
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">了解</p> <p><strong>表3	<u>环境信息变量</u></strong></p> <table><thead><tr><th>变量名</th> <th>功能</th></tr></thead> <tbody><tr><td>ARGC</td> <td>命令行参数个数。</td></tr> <tr><td>ARGIND</td> <td>当前文件在 ARGC 中的位置。</td></tr> <tr><td>ARGV</td> <td>包含命令行参数的数组。</td></tr> <tr><td>CONVFMT</td> <td>数字的转换格式，默认值为 %.6g。</td></tr> <tr><td>ENVIRON</td> <td>当前 shell 环境变量及其值组成的关联数组。</td></tr> <tr><td>ERRNO</td> <td>当读取或关闭输入文件发生错误时的系统错误号。</td></tr> <tr><td>FILENAME</td> <td>当前输入文档的名称。</td></tr> <tr><td>FNR</td> <td>当前数据文件中的数据行数。</td></tr> <tr><td>IGNORECASE</td> <td>设成非 0 值时，忽略 awk 命令中出现的字符串的字符大小写。</td></tr> <tr><td>NF</td> <td>数据文件中的字段总数。</td></tr> <tr><td>NR</td> <td>已处理的输入记录数。</td></tr> <tr><td>OFMT</td> <td>数字的输出格式，默认值为 %.6g。</td></tr> <tr><td>RLENGTH</td> <td>由 match 函数所匹配的子字符串的长度。</td></tr> <tr><td>TSTART</td> <td>由 match 函数所匹配的子字符串的起始位置。</td></tr></tbody></table> <p>其中，FNR 和 NR 变量虽然类似，但又略有不同。FNR 变量含有当前数据文件中已处理过的记录数，NR 变量则含有已处理过的记录总数。举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data1</span>
data11,data12,data13,data14,data15
data21,data22,data23,data24,data25
data31,data32,data33,data34,data35
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '</span>
<span class="token operator">&gt;</span> BEGIN <span class="token punctuation">{</span>FS<span class="token operator">=</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>print <span class="token variable">$1</span>,<span class="token string">&quot;FNR=&quot;</span>FNR,<span class="token string">&quot;NR=&quot;</span>NR<span class="token punctuation">}</span>
<span class="token operator">&gt;</span> END<span class="token punctuation">{</span>print <span class="token string">&quot;There were&quot;</span>,NR,<span class="token string">&quot;records processed&quot;</span><span class="token punctuation">}</span>' data1 data1
data11 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">1</span>
data21 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">2</span>
data31 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">3</span>
data11 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">4</span>
data21 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">5</span>
data31 <span class="token assign-left variable">FNR</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">NR</span><span class="token operator">=</span><span class="token number">6</span>
There were <span class="token number">6</span> records processed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>由此可以看出，当只使用一个数据文件作为输入时，FNR 和 NR 的值是相同的；如果使用多个数据文件作为输入，FNR 的值会在处理每个数据文件时被重置，而 NR 的值则会继续计数直到处理完所有的数据文件。</p></div> <h4 id="自定义变量"><a href="#自定义变量" class="header-anchor">#</a> 自定义变量</h4> <p>和其他典型的编程语言一样，<code>awk</code> 允许用户定义自己的变量在脚本程序中使用。<code>awk</code> 自定义变量名可以是任意数目的字母、数字和下划线，但不能以数字开头。更重要的是，<code>awk</code> 变量名区分大小写。</p> <p>举个简单的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '</span>
<span class="token operator">&gt;</span> BEGIN<span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">testing</span><span class="token operator">=</span><span class="token string">&quot;This is a test&quot;</span>
<span class="token operator">&gt;</span> print testing
<span class="token operator">&gt;</span> <span class="token assign-left variable">testing</span><span class="token operator">=</span><span class="token number">45</span>
<span class="token operator">&gt;</span> print testing
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>'
This is a <span class="token builtin class-name">test</span>
<span class="token number">45</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>可以看到，print 语句的输出是 testing 变量的当前值。</p> <p>也可以用 <code>awk</code> 命令行来给程序中的变量赋值，这允许我们在正常的代码之外赋值，即时改变变量的值，比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat script1</span>
BEGIN<span class="token punctuation">{</span>FS<span class="token operator">=</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>print <span class="token variable">$n</span><span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -f script1 n=2 data1</span>
data12
data22
data32
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -f script1 n=3 data1</span>
data13
data23
data33
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>需要注意的是，使用命令行参数来定义变量值会有一个问题，即设置了变量后，这个值在代码的 BEGIN 部分不可用，如下所示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat script2</span>
BEGIN<span class="token punctuation">{</span>print <span class="token string">&quot;The starting value is&quot;</span>,n<span class="token punctuation">;</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>print <span class="token variable">$n</span><span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -f script2 n=3 data1</span>
The starting value is
data13
data23
data33
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>解决这个问题，可以用 -v 命令行参数，它可以实现在 BEGIN 代码之前设定变量。在命令行上，-v 命令行参数必须放在脚本代码之前，如下所示：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -v n=3 -f script2 data1</span>
The starting value is <span class="token number">3</span>
data13
data23
data33
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>注意，<code>awk</code> 脚本程序中输出函数还可以使用 C 语言中的 printf 函数。</p> <h3 id="awk-使用数组"><a href="#awk-使用数组" class="header-anchor">#</a> awk 使用数组</h3> <p>为了在单个变量中存储多个值，许多编程语言都提供数组，<code>awk</code> 使用关联数组提供数组功能。</p> <p>关联数组跟数字数组不同之处在于，它的索引值可以是任意文本字符串。用户不需要用连续的数字来标识数组中的数据元素；相反，关联数组用各种字符串来引用值。每个索引字符串都必须能够唯一地标识出赋给它的数据元素。</p> <p>如果你熟悉其他编程语言的话，其实关联数组和散列表、字典的用法类似。</p> <h4 id="关联数组的定义和使用"><a href="#关联数组的定义和使用" class="header-anchor">#</a> 关联数组的定义和使用</h4> <p>在 <code>awk</code> 脚本程序中，定义一个数组变量可以使用标准复制语句，其基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>var<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">=</span>element
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，var 是数组名，index 是关联数组的索引值，element 是数据元素值。例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>capital<span class="token punctuation">[</span><span class="token string">&quot;Illinois&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;[Spring](http://c.biancheng.net/spring/)field&quot;</span>
capital<span class="token punctuation">[</span><span class="token string">&quot;Indiana&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Indianapolis&quot;</span>
capital<span class="token punctuation">[</span><span class="token string">&quot;Ohio&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Columbus&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在引用数组变量时，必须用索引值（index）来提取相应的数据元素值，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{</span>
<span class="token operator">&gt;</span> capital<span class="token punctuation">[</span><span class="token string">&quot;Illinois&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Springfield&quot;</span>
<span class="token operator">&gt;</span> print capital<span class="token punctuation">[</span><span class="token string">&quot;Illinois&quot;</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>'
Springfield
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>数组变量也是变量，也可以使用其进行基本的算术运算，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">34</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>
<span class="token operator">&gt;</span> total <span class="token operator">=</span> var<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> + var<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> print total
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>'
<span class="token number">37</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="关联数组的遍历"><a href="#关联数组的遍历" class="header-anchor">#</a> 关联数组的遍历</h4> <p>在 <code>awk</code> 中遍历关联数组，可以用 for 语句的一种特殊形式：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">for</span> <span class="token punctuation">(</span>var <span class="token keyword">in</span> array<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
	statements
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这个 for 语句会在每次循环时将关联数组 array 的下一个索引值赋给变量 var，然后执行一遍 statements。</p> <p><strong>再次强调，整个遍历过程中，传给 var 的都是每个数组元素的索引值（也就是 index），不是数组元素的值。</strong></p> <p>举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;m&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span>
<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>test <span class="token keyword">in</span> var<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>  print <span class="token string">&quot;Index:&quot;</span>,test,<span class="token string">&quot; - Value:&quot;</span>,var<span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>'
Index: u - Value: <span class="token number">4</span>
Index: m - Value: <span class="token number">3</span>
Index: a - Value: <span class="token number">1</span>
Index: g - Value: <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>注意，索引值不会按任何特定顺序返回，但它们都能够指向对应的数据元素值。</p> <h4 id="删除数组变量"><a href="#删除数组变量" class="header-anchor">#</a> 删除数组变量</h4> <p><code>awk</code> 脚本程序还支持从关联数组中删除某个数组索引，使用 delete 命令就可以，此命令会从数组中删除指定的索引值及相关的数据元素的值。</p> <p>delete 命令的基本格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>delete array<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>举个例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk 'BEGIN{</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> var<span class="token punctuation">[</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>test <span class="token keyword">in</span> var<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>  print <span class="token string">&quot;Index:&quot;</span>,test,<span class="token string">&quot; - Value:&quot;</span>,var<span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> delete var<span class="token punctuation">[</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> print <span class="token string">&quot;---&quot;</span>
<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>test <span class="token keyword">in</span> var<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>  print <span class="token string">&quot;Index:&quot;</span>,test,<span class="token string">&quot; - Value:&quot;</span>,var<span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>'
Index: a - Value: <span class="token number">1</span>
Index: g - Value: <span class="token number">2</span>
---
Index: a - Value: <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>需要注意的是，一旦从关联数组中删除了索引值，就没法再用它来提取元素值。</p> <h3 id="awk-使用分支结构"><a href="#awk-使用分支结构" class="header-anchor">#</a> awk 使用分支结构</h3> <p><code>awk</code> 支持标准的 if-then-else 格式的 if 语句，其基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span>
	commands1；
 <span class="token keyword">else</span>
	commands2；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>也可以将它放在一行上，像这样：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> statement1<span class="token punctuation">;</span><span class="token keyword">else</span> statement2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>举个简单的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data4</span>
<span class="token number">10</span>
<span class="token number">5</span>
<span class="token number">13</span>
<span class="token number">50</span>
<span class="token number">34</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{if ($1 &gt; 20) print $1 * 2; else print $1 / 2}' data4</span>
<span class="token number">5</span>
<span class="token number">2.5</span>
<span class="token number">6.5</span>
<span class="token number">100</span>
<span class="token number">68</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="awk-使用循环结构"><a href="#awk-使用循环结构" class="header-anchor">#</a> awk 使用循环结构</h3> <p><code>awk</code> 脚本程序中，可以使用 while、do-while、for 这 3 种循环结构，它们各自的基本格式分别如表 3 所示。</p> <h4 id="while-循环"><a href="#while-循环" class="header-anchor">#</a> while 循环</h4> <p>基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	commands<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat data5</span>
<span class="token number">130</span> <span class="token number">120</span> <span class="token number">135</span>
<span class="token number">160</span> <span class="token number">113</span> <span class="token number">140</span>
<span class="token number">145</span> <span class="token number">170</span> <span class="token number">215</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> total <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>    total <span class="token operator">+=</span> <span class="token variable">$i</span>
<span class="token operator">&gt;</span>    i++
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> avg <span class="token operator">=</span> total / <span class="token number">3</span>
<span class="token operator">&gt;</span> print <span class="token string">&quot;Average:&quot;</span>,avg
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>' data5
Average: <span class="token number">128.333</span>
Average: <span class="token number">137.667</span>
Average: <span class="token number">176.667</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="do-while-循环"><a href="#do-while-循环" class="header-anchor">#</a> do-while 循环</h4> <p>基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">do</span> <span class="token punctuation">{</span>
	commmands<span class="token punctuation">;</span>
<span class="token punctuation">}</span>while <span class="token punctuation">(</span>条件<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> total <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> <span class="token keyword">do</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>    total <span class="token operator">+=</span> <span class="token variable">$i</span>
<span class="token operator">&gt;</span>    i++
<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>total <span class="token operator">&lt;</span> <span class="token number">150</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> print total <span class="token punctuation">}</span>' data5
<span class="token number">250</span>
<span class="token number">160</span>
<span class="token number">315</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="for-循环"><a href="#for-循环" class="header-anchor">#</a> for 循环</h4> <p>基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>for<span class="token punctuation">(</span>i<span class="token punctuation">;</span>condition<span class="token punctuation">;</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	commands<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> total <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>    total <span class="token operator">+=</span> <span class="token variable">$i</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> avg <span class="token operator">=</span> total / <span class="token number">3</span>
<span class="token operator">&gt;</span> print <span class="token string">&quot;Average:&quot;</span>,avg
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>' data5
Average: <span class="token number">128.333</span>
Average: <span class="token number">137.667</span>
Average: <span class="token number">176.667</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>可以看出，<code>awk</code> 支持使用的循环结构的用法和 C 语言完全一样，除此之外，<code>awk</code> 还支持使用 break（跳出循环）、continue（终止当前循环）关键字，其用法和 C 语言中也完全相同。</p> <h3 id="awk-循环控制"><a href="#awk-循环控制" class="header-anchor">#</a> awk 循环控制</h3> <h4 id="break-跳出循环"><a href="#break-跳出循环" class="header-anchor">#</a> break：跳出循环</h4> <p>跳出循环，继续执行循环外的后续语句</p> <p>例：累加每行数值，和大于150停止累加</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@linux ~ <span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">&gt;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">&gt;</span>	<span class="token assign-left variable">sum</span><span class="token operator">+=</span><span class="token variable">$i</span>
<span class="token operator">&gt;</span>	<span class="token keyword">if</span> <span class="token punctuation">(</span>sum<span class="token operator">&gt;</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">&gt;</span>		<span class="token builtin class-name">break</span>
<span class="token operator">&gt;</span>	<span class="token punctuation">}</span>
<span class="token operator">&gt;</span>	i++
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> print <span class="token function">sum</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>' data5
<span class="token number">250</span>
<span class="token number">160</span>
<span class="token number">315</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="continue-终止本次循环"><a href="#continue-终止本次循环" class="header-anchor">#</a> continue：终止本次循环</h4> <p>终止本次循环</p> <p>例：累加每行数值，和大于 400 的打印出来，小于等于 400 的则退出该次循环。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@linux ~ <span class="token punctuation">]</span><span class="token comment"># awk '{</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">&gt;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token assign-left variable">sum</span><span class="token operator">+=</span><span class="token variable">$i</span>
	i++
	<span class="token keyword">if</span> <span class="token punctuation">(</span>sum<span class="token operator">&gt;</span><span class="token number">400</span><span class="token punctuation">)</span>
		print <span class="token function">sum</span>
	<span class="token keyword">else</span>
		<span class="token builtin class-name">continue</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>' data5
<span class="token number">413</span>
<span class="token number">530</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="awk-使用函数"><a href="#awk-使用函数" class="header-anchor">#</a> awk 使用函数</h3> <h4 id="内建函数"><a href="#内建函数" class="header-anchor">#</a> 内建函数</h4> <p>和内建变量类似，<code>awk</code> 也提供了不少内建函数，可进行一些常见的数学、字符串以及时间函数运算，如表4 所示。</p> <p><strong>表4	<u>常见的内建函数</u></strong></p> <table><tr><td>函数分类</td> <td>函数原型</td> <td>函数功能 </td></tr> <tr><td rowspan="9">数学函数</td> <td>atan2(x,y)</td> <td>x/y 的反正切，x 和 y 以弧度为单位。</td></tr> <tr><td>cos(x)</td> <td>x 的余弦，x 以弧度为单位。</td></tr> <tr><td>exp(x)</td> <td>x 的指数函数。</td></tr> <tr><td>int(x)</td> <td>x 的整数部分，取靠近零一侧的值。</td></tr> <tr><td>log(x)</td> <td>x 的自然对数。</td></tr> <tr><td>srand(x)</td> <td>为计算随机数指定一个种子值。</td></tr> <tr><td>rand()</td> <td>比 0 大比 1 小的随机浮点值。</td></tr> <tr><td>sin(x)</td> <td>x 的正弦，x 以弧度为单位。</td></tr> <tr><td>sqrt(x)</td> <td>x 的平方根。</td></tr> <tr><td rowspan="6">位运算函数</td> <td>and(v1,v2)</td> <td>执行值 v1 和 v2 的按位与运算。</td></tr> <tr><td>compl(val)</td> <td>执行 val 的补运算。</td></tr> <tr><td>lshift(val,count)</td> <td>将值 val 左移 count 位。</td></tr> <tr><td>or(v1,v2) </td> <td>执行值 v1 和 v2 的按位或运算。</td></tr> <tr><td>rshift(val,count)</td> <td>将值 val 右移 count 位。</td></tr> <tr><td>xor(v1,v2)</td> <td>执行值 v1 和 v2 的按位异或运算。</td></tr> <tr><td rowspan="13">字符串函数</td> <td> asort(s [,d])</td> <td>将数组 s 按数据元素值排序。索引值会被替换成表示新的排序顺序的连续数字。<br>
另外，如果指定了 d，则排序后的数组会存储在数组 d 中。</td></tr> <tr><td>asorti(s [,d])</td> <td>将数组 s 按索引值排序。生成的数组会将索引值作为数据元素值，用连续数字索引来表明排序顺序。<br>
        另外如果指定了 d，排序后的数组会存储在数组 d 中。</td></tr> <tr><td>gensub(r,s,h [,t]</td> <td>查找变量 $0 或目标字符串 t（如果提供了的话）来匹配正则表达式 r。<br>如果 h 是一个以 g 或 G 开头的字符串，就用 s 替换掉匹配的文本。<br>如果 h 是一个数字，它表示要替换掉第 h 处 r 匹配的地方。</td></tr> <tr><td>gsub(r,s [,t])</td> <td>查找变量 $0 或目标字符串 t（如果提供了的话）来匹配正则表达式 r。<br>如果找到了，就全部替换成字符串 s。</td></tr> <tr><td>index(s,t)</td> <td>返回字符串 t 在字符串 s 中的索引值，如果没找到的话返回 0。</td></tr> <tr><td>length([s])</td> <td>返回字符串 s 的长度；如果没有指定的话，返回 $0 的长度。</td></tr> <tr><td>match(s,r [,a])</td> <td>返回字符串 s 中正则表达式 r 出现位置的索引。<br>如果指定了数组 a，它会存储 s 中匹配正则表达式的那部分。</td></tr> <tr><td>split(s,a [,r])</td> <td>将 s 用 FS 字符或正则表达式 r（如果指定了的话）分开放到数组 a 中，并返回字段的总数。</td></tr> <tr><td>sprintf(format,variables)</td> <td>用提供的 format 和 variables 返回一个类似于 printf 输出的字符串。</td></tr> <tr><td>sub(r,s [,t])</td> <td>在变量 $0 或目标字符串 t 中查找正则表达式 r 的匹配。如果找到了，就用字符串 s 替换掉第一处匹配。</td></tr> <tr><td>substr(s,i [,n])</td> <td>返回 s 中从索引值 i 开始的 n 个字符组成的子字符串。如果未提供 n，则返回 s 剩下的部分。</td></tr> <tr><td>tolower(s)</td> <td>将 s 中的所有字符转换成小写。</td></tr> <tr><td>toupper(s)</td> <td>将 s 中的所有字符转换成大写。</td></tr> <tr><td rowspan="3">时间函数</td> <td>mktime(datespec)</td> <td>将一个按 YYYY MM DD HH MM SS [DST] 格式指定的日期转换成时间戳值。</td></tr> <tr><td>strftime(format [,timestamp])</td> <td>将当前时间的时间戳或 timestamp（如果提供了的话）转化格式化日期（采用 shell 函数 date() 的格式）。</td></tr> <tr><td>systime()</td> <td>返回当前时间的时间戳。 </td></tr></table> <p>时间戳指的是格林威治时间，即从 1970年1月1日起到现在的总秒数。</p> <h4 id="自定义函数"><a href="#自定义函数" class="header-anchor">#</a> 自定义函数</h4> <p>除了<code>awk</code> 中的内建函数，还可以在 <code>awk</code> 脚本程序中自定义函数，创建自定义函数的基本格式为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">function</span> 函数名<span class="token punctuation">(</span>参数1，参数2，<span class="token punctuation">..</span>.<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	运行代码；
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意，自定义函数的函数名必须能够唯一标识此函数，换句话说，在同一个 <code>awk</code> 脚本程序中，多个函数的函数名不能相同。同时，函数的参数可以有多个（0 个、1 个或多个）。</p> <p>例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">function</span> <span class="token function-name function">printthird</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	print <span class="token variable">$3</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>此函数会打印记录中的第三个数据字段。</p> <p>函数还能用 return 语句返回值，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">function</span> myrand<span class="token punctuation">(</span>limit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token builtin class-name">return</span> int<span class="token punctuation">(</span>limit * rand<span class="token punctuation">(</span><span class="token punctuation">))</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>需要注意的是，在定义函数时，它必须出现在所有代码块之前（包括 BEGIN 和 END代码块）。</p> <h4 id="创建函数库"><a href="#创建函数库" class="header-anchor">#</a> 创建函数库</h4> <p><code>awk</code> 提供了一种途径来将多个函数放到一个库文件中，这样用户就能在所有的 <code>awk</code> 脚本程序中使用了。为了方便大家理解，下面给大家举个实例。</p> <p>首先，我们需要创建一个存储所有 <code>awk</code> 函数的文件：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat funclib</span>
<span class="token keyword">function</span> <span class="token function-name function">myprint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token builtin class-name">printf</span> <span class="token string">&quot;%-16s - %s<span class="token entity" title="\n">\n</span>&quot;</span>, <span class="token variable">$1</span>, <span class="token variable">$4</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> myrand<span class="token punctuation">(</span>limit<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token builtin class-name">return</span> int<span class="token punctuation">(</span>limit * rand<span class="token punctuation">(</span><span class="token punctuation">))</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function-name function">printthird</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	print <span class="token variable">$3</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>要想让 <code>awk</code> 成功读取 funclib 函数库文件，就需要使用 -f 选项，但此选项无法和 <code>awk</code> 脚本程序同时放到命令行中一起使用。因此，要使用库函数文件，只能再创建一个脚本程序文件，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat script4</span>
BEGIN<span class="token punctuation">{</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span><span class="token punctuation">;</span> <span class="token assign-left variable">RS</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>
	myprint<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># awk -f funclib -f script4 data2</span>
Riley Mullen   - <span class="token punctuation">(</span><span class="token number">312</span><span class="token punctuation">)</span><span class="token number">555</span>-1234
Frank Williams  - <span class="token punctuation">(</span><span class="token number">317</span><span class="token punctuation">)</span><span class="token number">555</span>-9876
Haley Snell   - <span class="token punctuation">(</span><span class="token number">313</span><span class="token punctuation">)</span><span class="token number">555</span>-4938
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/Ryukarin/blog/edit/main/project/Linux_mix/Linux_sed_grep_awk.md" target="_blank" rel="noopener noreferrer">编辑此页</a></div> <div class="meta-item update-time"><span class="label">上次编辑于:</span> <span class="info">2022年1月26日 14:11</span></div> <div class="meta-item contributors"><span class="label">贡献者: </span> <span class="info"><span title="email: ryuukaringo@gmail.com" class="contributor">
          ryuukarin
        </span> <!----></span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog/project/Linux_mix/" class="prev router-link-active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        linux大杂烩
      </a></span> <span class="next"><a href="/blog/project/Shell/">
        Shell脚本笔记
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <div class="comments-wrapper"><div class="waline-wrapper"><div id="waline-comment"></div></div></div> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://gitee.com/ryuukarin" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a><a href="https://github.com/Ryukarin" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div> <div class="footer">MIT Licensed</div> <div class="copyright">Copyright © 2022 karin</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="关闭" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">该应用可以安装在您的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。</p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>详情</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        安装 <span></span></button> <button class="cancel-button">
        取消
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="关闭" aria-label="关闭" class="pswp__button pswp__button--close"></button> <button title="分享" aria-label="分享" class="pswp__button pswp__button--share"></button> <button title="切换全屏" aria-label="切换全屏" class="pswp__button pswp__button--fs"></button> <button title="缩放" aria-label="缩放" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="上一个 (左箭头)" aria-label="上一个 (左箭头)" class="pswp__button pswp__button--arrow--left"></button> <button title="下一个 (右箭头)" aria-label="下一个 (右箭头)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/blog/assets/js/app.9f9c9b81.js" defer></script><script src="/blog/assets/js/vendors~layout-Layout.79b66223.js" defer></script><script src="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.efafecdd.js" defer></script><script src="/blog/assets/js/page-linux三剑客.e71431d8.js" defer></script>
  </body>
</html>
